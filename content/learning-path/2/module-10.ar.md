+++
style = "module"
weight = 10
title = "اكتشاف مصدر البرمجيات الضارة"
description = "لا تظهر البرمجيات الضارة بشكل تلقائي على جهاز الشخص المستهدف وإنما تأتي دائمًا من مكان ما"
+++

## حالة استخدام

لا تظهر البرمجيات الضارة بشكل تلقائي على جهاز الشخص المستهدف وإنما تأتي دائمًا من مكان ما. في بعض الأحيان، يكون ذلك المكان واضحًا حيث يدرك الشخص المستهدف أن الرابط الذي نقر عليه كان ضارًا وفي حالات أخرى، قد يكون ناقل الإصابة أقل وضوحًا. يمكن أن يكون تعلم مصدر الإصابة مهمًا لإدارة المخاطر المستقبلية. إذا كان مصدر الإصابة الأولي غير مستهدفًا، فقد تكون الضحية قد وقعت في أيدي عصابة إجرامية ليس لها أهداف سوى كسب المال. من ناحية أخرى، إذا جاءت الإصابة الأولية من هجوم انتحال بالهندسة الاجتماعية مستهدف ومتطور، فمن المرجح أن يواجهوا هجمات مستقبلية مستمرة من نفس ممثل التهديد.

## الأهداف 

بعد استكمال هذا الموضوع الفرعي، يجب أن يكون الممارسون قادرين على القيام بما يلي:

- فهم كيفية عمل الطوابع الزمنية على أجهزة سطح المكتب والأجهزة المحمولة
- انظر إلى البيانات الوصفية لنظام التشغيل لمعرفة من أين تم تنزيل الملفات الضارة
---
## العرض 
### الطوابع الزمنية للملفات

تمثل الخطوة الأولى في تتبع أصل الهجوم في تحديد وقت تثبيت البرمجية الضارة. وإذا كنت قد حددت ملف البرمجيات الضارة الذي تم تنزيله، فيمكنك استخدام الطوابع الزمنية الموجودة على الملف. هذا أصعب مما قد يتخيله المرء في البداية لأن الطوابع الزمنية لنظام الملفات معقدة. تُعدّ الإجابة المختصرة هي البدء بوقت إنشاء الملف للملف الأول الذي تم تنزيله. لاحظ أن الملفات المستخرجة من الأرشيف قد يكون لها أوقات إنشاء مختلفة ومن المهم أن تبدأ بالملف الفعلي الذي تم تنزيله.

#### ويندوز وماك أو إس ولينوكس

لمزيد من المعلومات حول الطوابع الزمنية لنظام ملفات سطح المكتب، راجع هذا المستند التقني من إس إيه إن إس حول ويندوز[this whitepaper from SANS on Windows](https://www.sans.org/white-papers/36842/)، وهذا الوصف للطوابع الزمنية شبه اللانهائية على ماك أو إس[this description of the near-infinite time stamps on MacOS](https://forensic4cast.com/2016/10/macos-timestamps-from-extended-attributes-and-spotlight/)، وهذا الوصف للطوابع الزمنية لنظام لينوكس [this description of linux timestamps](https://linuxhandbook.com/file-timestamps/)وطريقة عرض وقت إنشاء الملف على [a way of viewing file creation time on ext4](https://blog.roberthallam.org/2018/01/file-creation-time-on-ext4-linux/). 

#### آي أو إس وأندرويد

بالنسبة للأجهزة المحمولة، تُوفر موبايل فيريفيكيشن تولكيت بعض معلومات الطابع الزمني وبالنسبة لنظام التشغيل آي أو إس يرد وصف ذلك في الوثائق[described in the documentation](https://docs.mvt.re/en/latest/ios/records/)، أما بالنسبة لنظام أندرويد، تستخرج معلومات أقل وقد تضطر إلى إجراء فحوصات على الجهاز.


يعرض تطبيق غوغل فايلز [Google Files](https://play.google.com/store/apps/details?id=com.google.android.apps.nbu.files&hl=en_US&gl=US) الوقت المعدل لملف من قائمة النقاط الثلاث لكل ملف.

لاحظ أن البرمجيات الضارة للجهاز المحمول عادة ما تكون أقل وضوحًا من حيث ترك آثار يسهل الوصول إليها على نظام الملفات. تُعدّ الطرق الشائعة لإصابة الأجهزة المحمولة هي تطبيقات وهمية محملة جانبيًا أو تطبيقات ضارة في متجر تطبيقات غوغل/آبل أو عبر عمليات استغلال متطورة للمتصفح يمكنها التمتع بوصول عميق إلى الجهاز قبل تنزيل أي ملفات. في الحالات الأخيرة، قد لا تظهر الملفات الضارة في أدلة التنزيل الشائعة.

### الرسائل/التنزيلات المشبوهة

سواء وجدت ملفًا ضارًا أم لا، تتمثل الخطوة التالية هي العثور على مصدره ويوجد عدد من المعلومات التي يمكنك جمعها والبحث عنها.

في بعض أنظمة التشغيل، ترتبط التنزيلات بمصدرها وهذا يعني أن الملفات يمكن أن تحتوي على بيانات وصفية توضح الخادم الذي تم تنزيلها منه. يوضح هذا [الدليل](https://winaero.com/beware-chromium-based-browsers-save-download-origin-url-for-files/#:~:text=To%20Find%20Origin%20URL%20For%20File%20Downloaded%20with,the%20following%20command%3A%20Get-Content%20%22file%20name%22%20-Stream%20Zone.Identifier.) كيفية التحقق من هذه المعلومات على نظامي تشغيل ويندوز ولينوكس، في حين يوضح هذا  [الدليل](https://osxdaily.com/2010/10/12/find-out-where-a-file-was-downloaded-from/)الأمر ذاته لنظام التشغيل ماك أو إس. ستعرض لك هذه البيانات الوصفية الخادم الذي تم تنزيل الملف منه ولكن ليس ما تسبب في التنزيل. لاحظ أيضًا أن الرابط الذي نقر عليه الشخص المستهدف قد لا يكون عنوان الارتباط التشعبي للتنزيل بسبب عمليات إعادة التوجيه.

ابحث بعد ذلك عن رسائل البريد الإلكتروني والرسائل وما إلى ذلك التي قد تكون تسببت في التنزيل. يمكنك استخدام أي طابع زمني ومعلومات عنوان موقع الويب التي حددتها مسبقًا للمساعدة.

## اختبار مهارة

اكتل جميع الطوابع الزمنية لخمسة ملفات على الأقل في مجلد التنزيلات:

- التي تحتويها عليها وما يمكن أن تشير إليه
- إذا كان ذلك متاحًا، ابحث عن السمات الموسعة أو البيانات التعريفية التي تصف عنوان موقع الويب أو الخدمة التي تم تنزيلها منها (في اختبارنا، لم تحتوي جميع الملفات على معلومات حول عناوين موقع الويب في بياناتها التعريفية لذلك لا تقلق إذا لم تتمكن من العثور عليها)
  
اطلب من أحد النظراء أو مُرشِد التحقق مرة أخرى من عملك والتأكد من أنك قرأت جميع البيانات التعريفية بشكل صحيح.

على أندرويد، قم بتثبيت تطبيق (غير ضار) واستخدم مدير الملفات للعثور على خصائص التطبيق والاطلاع على ما يمكنك معرفته عن التطبيق. إذا كان بإمكانك الوصول إلى هاتف أندرويد مخصص للاختبار، فقم بتنزيل تطبيق من خارج متجر غوغل بلاي وافعل الشيء نفسه. اطلب من أحد النظراء أو مُرشِد التحقق مرة أخرى من عملك والتأكد من أنك قرأت جميع الخصائص بشكل صحيح.


## مصادر التعلّم

{{% resource title="الزمنية لنظام الملفات: ما سر عملها؟" description="نظرة عامة على ماهية الطوابع الزمنية ومدى إمكانية نقلها وكيفية عملها على المستوى الفني إلى حد ما. تُركز في الغالب على ويندوز" languages="اللغة الإنجليزية" cost="مجانًا" url="https://www.sans.org/white-papers/36842/" %}}

{{% resource title="الطوابع الزمنية لنظام ماك أو إس من السمات الموسعة وسبوتلايبت (spotlight)" description="دليل لاستخدام البيانات الوصفية المتقدمة للملفات في ماك أو إس للعثور على طوابع زمنية مختلفة للملفات وما تعنيه تلك الطوابع الزمنية" languages="اللغة الإنجليزية" cost="مجانًا" url="https://forensic4cast.com/2016/10/macos-timestamps-from-extended-attributes-and-spotlight/" %}}

{{% resource title="شرح الطوابع الزمنية للملف في لينوكس: atime وmtime وctime" description="يحتوي لينوكس على أنواع مختلفة من الطوابع الزمنية وتشرح هذه المقالة كيفية تفسيرها." languages="اللغة الإنجليزية" cost="مجانًا" url="https://linuxhandbook.com/file-timestamps/" %}}

{{% resource title="وقت إنشاء الملف على EXT4 على لينوكس" description="نظام الملفات الأكثر حداثة الذي يستخدمه نظام لينوكس يسمى EXT4. تبحث هذه المقالة في كيفية إدارة EXT4 للطوابع الزمنية وكيفية العثور على معلومات مفصلة حول إنشاء الملفات." languages="اللغة الإنجليزية" cost="مجانًا" url="https://blog.roberthallam.org/2018/01/file-creation-time-on-ext4-linux/" %}}

{{% resource title="السجلات المستخرجة بواسطة موبايل فيريفيكيشن تولكيت على نظام آي أو إس" description="بحث في الملفات التي تولدها موبايل فيريفيكيشن تولكيت عند تحليل مقالب آي أو إس وكيفية قراءتها" languages="اللغة الإنجليزية" cost="مجانًا" url="https://docs.mvt.re/en/latest/ios/records/" %}}

{{% resource title="تطبيق فايلز من غوغل" description="تطبيق أندرويد يتيح الوصول إلى البيانات الوصفية المتقدمة للملفات" languages="عدة" cost="مجانًا" url="https://play.google.com/store/apps/details?id=com.google.android.apps.nbu.files&hl=en_US&gl=US" %}}

{{% resource title="علامة الويب من منظور فريق محاكاة الهجوم" description="تعريف بعلامة الويب وهي علامة في ويندوز تشير إلى أنه تم تنزيل ملف من الويب ويتطلب احتياطات أمنية خاصة عند الفتح" languages="اللغة الإنجليزية" cost="مجانًا" url="https://outflank.nl/blog/2020/03/30/mark-of-the-web-from-a-red-teams-perspective/" %}}

{{% resource title="تحفظ المتصفحات المستندة إلى كروميوم عنوان موقع الويب الأصلي للملفات" description="نظرة إلى كيفية حفظ أنظمة ويندوز ولينوكس أحيانًا للبيانات الوصفية لعناوين موقع الويب التي تم تنزيل الملف منها" languages="اللغة الإنجليزية" cost="مجانًا" url="https://winaero.com/beware-chromium-based-browsers-save-download-origin-url-for-files/" %}}

{{% resource title="اكتشف من أين تم تنزيل ملف في نظام التشغيل في ماك أو إس إكس" description="عادةً ما تحتوي ملفات ماك أو إس التي تم تنزيلها من عنوان موقع ويب على عنوان موقع التنزيل من الويب مضمنًا في بيانات التعريف الخاصة بها وتوضح هذه المقالة كيفية استخراج العنوان المذكور" languages="اللغة الإنجليزية" cost="مجانًا" url="https://osxdaily.com/2010/10/12/find-out-where-a-file-was-downloaded-from/" %}}

## Notes

[^1]:
    On Windows, you will additionally see a number corresponding to a Zone ID. The Zones associated with downloaded files are as follows:

    - ZoneId=1: Local Intranet
    - ZoneId=2: Trusted sites
    - ZoneId=3: Internet
    - ZoneId=4: Restricted sites
