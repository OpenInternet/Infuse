!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jspdf")):"function"==typeof define&&define.amd?define(["exports","jspdf"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).svg2pdf={},e.jspdf)}(this,function(e,t){/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */"use strict";Ae="default"in t?t.default:t,te=function(e,t){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}te(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}D=function(){return(D=Object.assign||function(e){for(var t,s,n=1,o=arguments.length;n<o;n++)for(s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function o(e,t,n,s){return new(n||(n=Promise))(function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,c)}a((s=s.apply(e,t||[])).next())})}function i(e,t){var n,o,i,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],o=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}}var u=function(){function e(e){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,e){for(s in"#"==e.charAt(0)&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)e==s&&(e=this.simpleColors[s]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}];for(t=0;t<this.colorDefs.length;t++){var t,n,s,i=this.colorDefs[t].re,a=this.colorDefs[t].process,o=i.exec(e);o&&(n=a(o),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b}}return e.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},e.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},e.prototype.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n},e.prototype.getHelpXML=function(){for(n=[],t=0;t<this.colorDefs.length;t++)for(a=this.colorDefs[t].example,s=0;s<a.length;s++)n[n.length]=a[s];for(d in this.simpleColors)n[n.length]=d;o=document.createElement("ul"),o.setAttribute("id","rgbcolor-examples");for(t=0;t<n.length;t++)try{var t,n,s,o,a,l,d,r=document.createElement("li"),i=new e(n[t]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+i.toHex()+"; color:"+i.toHex(),c.appendChild(document.createTextNode("test")),l=document.createTextNode(" "+n[t]+" -> "+i.toRGB()+" -> "+i.toHex()),r.appendChild(c),r.appendChild(l),o.appendChild(r)}catch{}return o},e}(),c=function(){function e(e){this.color=e}return e.prototype.getFillData=function(){return o(this,void 0,void 0,function(){return i(this,function(){return[2,void 0]})})},e}(),Ie=function(){function e(){this.xmlSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null}return e.prototype.clone=function(){var t=new e;return t.xmlSpace=this.xmlSpace,t.fill=this.fill,t.fillOpacity=this.fillOpacity,t.fontFamily=this.fontFamily,t.fontSize=this.fontSize,t.fontStyle=this.fontStyle,t.fontWeight=this.fontWeight,t.opacity=this.opacity,t.stroke=this.stroke,t.strokeDasharray=this.strokeDasharray,t.strokeDashoffset=this.strokeDashoffset,t.strokeLinecap=this.strokeLinecap,t.strokeLinejoin=this.strokeLinejoin,t.strokeMiterlimit=this.strokeMiterlimit,t.strokeOpacity=this.strokeOpacity,t.strokeWidth=this.strokeWidth,t.textAnchor=this.textAnchor,t.alignmentBaseline=this.alignmentBaseline,t.visibility=this.visibility,t.color=this.color,t},e.default=function(){var t=new e;return t.xmlSpace="default",t.fill=new c(new u("rgb(0, 0, 0)")),t.fillOpacity=1,t.fontFamily="times",t.fontSize=16,t.fontStyle="normal",t.fontWeight="normal",t.opacity=1,t.stroke=null,t.strokeDasharray=null,t.strokeDashoffset=0,t.strokeLinecap="butt",t.strokeLinejoin="miter",t.strokeMiterlimit=4,t.strokeOpacity=1,t.strokeWidth=1,t.alignmentBaseline="baseline",t.textAnchor="start",t.visibility="visible",t.color=new u("rgb(0, 0, 0)"),t},e}(),y=function(){function e(e,t){var n,s,o;this.pdf=e,this.svg2pdfParameters=t.svg2pdfParameters,this.attributeState=t.attributeState?t.attributeState.clone():Ie.default(),this.viewport=t.viewport,this.refsHandler=t.refsHandler,this.styleSheets=t.styleSheets,this.textMeasure=t.textMeasure,this.transform=null!==(n=t.transform)&&void 0!==n?n:this.pdf.unitMatrix,this.withinClipPath=null!==(s=t.withinClipPath)&&void 0!==s&&s,this.withinUse=null!==(o=t.withinUse)&&void 0!==o&&o}return e.prototype.clone=function(t){var n,s,o,i;return void 0===t&&(t={}),new e(this.pdf,{svg2pdfParameters:this.svg2pdfParameters,attributeState:t.attributeState?t.attributeState.clone():this.attributeState.clone(),viewport:null!==(n=t.viewport)&&void 0!==n?n:this.viewport,refsHandler:this.refsHandler,styleSheets:this.styleSheets,textMeasure:this.textMeasure,transform:null!==(s=t.transform)&&void 0!==s?s:this.transform,withinClipPath:null!==(o=t.withinClipPath)&&void 0!==o?o:this.withinClipPath,withinUse:null!==(i=t.withinUse)&&void 0!==i?i:this.withinUse})},e}(),Ue={}.hasOwnProperty,Ze=/[ -,./:-@[-^`{-~]/,Ge=/[ -,./:-@[\]^`{-~]/,Xe=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,B=function e(t,n){"single"!=(n=function(e,t){if(!e)return t;var n,s={};for(n in t)s[n]=Ue.call(e,n)?e[n]:t[n];return s}(n,e.options)).quotes&&"double"!=n.quotes&&(n.quotes="single");for(var d,r="double"==n.quotes?'"':"'",c=n.isIdentifier,u=t.charAt(0),o="",a=0,h=t.length;a<h;){var s=t.charAt(a++),i=s.charCodeAt(),l=void 0;i<32||i>126?(i>=55296&&i<=56319&&a<h&&(d=t.charCodeAt(a++),56320==(64512&d)?i=((1023&i)<<10)+(1023&d)+65536:a--),l="\\"+i.toString(16).toUpperCase()+" "):l=n.escapeEverything?Ze.test(s)?"\\"+s:"\\"+i.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(s)?"\\"+i.toString(16).toUpperCase()+" ":"\\"==s||!c&&('"'==s&&r==s||"'"==s&&r==s)||c&&Ge.test(s)?"\\"+s:s,o+=l}return c&&(/^-[-\d]/.test(o)?o="\\-"+o.slice(1):/\d/.test(u)&&(o="\\3"+u+" "+o.slice(1))),o=o.replace(Xe,function(e,t,n){return t&&t.length%2?e:(t||"")+n}),!c&&n.wrap?r+o+r:o};B.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},B.version="3.0.0",Z=B,q=function(){function e(t){this.renderedElements={},this.idMap=t,this.idPrefix=String(e.instanceCounter++)}return e.prototype.getRendered=function(e,t,n){return o(this,void 0,void 0,function(){var s,o;return i(this,function(i){switch(i.label){case 0:return o=this.generateKey(e,t),this.renderedElements.hasOwnProperty(o)?[2,this.renderedElements[e]]:(s=this.get(e),this.renderedElements[o]=s,[4,n(s)]);case 1:return i.sent(),[2,s]}})})},e.prototype.get=function(e){return this.idMap[Z(e,{isIdentifier:!0})]},e.prototype.generateKey=function(e,t){return this.idPrefix+"|"+e+"|"+(t||new u("rgb(0,0,0)")).toRGBA()},e.instanceCounter=0,e}();function ce(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])}function be(e,t){return[2/3*(t[0]-e[0])+e[0],2/3*(t[1]-e[1])+e[1]]}function E(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function O(e,t){return E([t[0]-e[0],t[1]-e[1]])}function T(e,t){return[e[0]+t[0],e[1]+t[1]]}function ee(e,t){var n=e[0],s=e[1];return[t.a*n+t.c*s+t.e,t.b*n+t.d*s+t.f]}var C=function(){function e(){this.segments=[]}return e.prototype.moveTo=function(e,t){return this.segments.push(new r(e,t)),this},e.prototype.lineTo=function(e,t){return this.segments.push(new _(e,t)),this},e.prototype.curveTo=function(e,t,n,s,o,i){return this.segments.push(new h(e,t,n,s,o,i)),this},e.prototype.close=function(){return this.segments.push(new X),this},e.prototype.transform=function(e){this.segments.forEach(function(t){if((t instanceof r||t instanceof _||t instanceof h)&&(n=ee([t.x,t.y],e),t.x=n[0],t.y=n[1]),t instanceof h){var n,s=ee([t.x1,t.y1],e),o=ee([t.x2,t.y2],e);t.x1=s[0],t.y1=s[1],t.x2=o[0],t.y2=o[1]}})},e.prototype.draw=function(e){var t=e.pdf;this.segments.forEach(function(e){e instanceof r?t.moveTo(e.x,e.y):e instanceof _?t.lineTo(e.x,e.y):e instanceof h?t.curveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y):t.close()})},e}(),r=function(e,t){this.x=e,this.y=t},_=function(e,t){this.x=e,this.y=t},h=function(e,t,n,s,o,i){this.x1=e,this.y1=t,this.x2=n,this.y2=s,this.x=o,this.y=i},X=function(){};function j(e,t){return t.split(",").indexOf((e.nodeName||e.tagName).toLowerCase())>=0}function n(e,t,n,s){void 0===s&&(s=n);var o,a,i=null===(o=e.style)||void 0===o?void 0:o.getPropertyValue(s);return i||(a=t.getPropertyValue(e,s),a||e.hasAttribute(n)&&e.getAttribute(n)||void 0)}function f(e,t,s){if("none"===n(e.element,s.styleSheets,"display"))return!1;var o=t,i=n(e.element,s.styleSheets,"visibility");return i&&(o="hidden"!==i),o}function v(e,t,n){var s=f(e,t,n);return 0!==e.element.childNodes.length&&(e.children.forEach(function(e){e.isVisible(s,n)&&(s=!0)}),s)}var Be=function(){function e(){this.markers=[]}return e.prototype.addMarker=function(e){this.markers.push(e)},e.prototype.draw=function(e){return o(this,void 0,void 0,function(){var t,n,s,o,a,r,c;return i(this,function(i){switch(i.label){case 0:s=0,i.label=1;case 1:return s<this.markers.length?(n=this.markers[s],t=void 0,o=n.angle,a=n.anchor,r=Math.cos(o),c=Math.sin(o),t=e.pdf.Matrix(r,c,-c,r,a[0],a[1]),t=e.pdf.matrixMult(e.pdf.Matrix(e.attributeState.strokeWidth,0,0,e.attributeState.strokeWidth,0,0),t),t=e.pdf.matrixMult(t,e.transform),e.pdf.saveGraphicsState(),[4,e.refsHandler.getRendered(n.id,null,function(t){return t.apply(e)})]):[3,4];case 2:i.sent(),e.pdf.doFormObject(n.id,t),e.pdf.restoreGraphicsState(),i.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},e}(),b=function(e,t,n){this.id=e,this.anchor=t,this.angle=n},W=/url\(["']?#([^"']+)["']?\)/,Ne={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"};function p(e,t){var n;return(n=e&&e.toString().match(/^([-0-9.]+)em$/))?parseFloat(n[1])*t:(n=e&&e.toString().match(/^([-0-9.]+)(px|)$/))?parseFloat(n[1]):0}function Me(e){return Ne[e]||"alphabetic"}function l(e){for(var t,n=[],s=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;t=s.exec(e);)n.push(parseFloat(t[0]));return n}function x(e,t){if("transparent"===e)return n=new u("rgb(0,0,0)"),n.a=0,n;if("currentcolor"===e.toLowerCase())return t||new u("rgb(0,0,0)");if(s=/\s*rgba\(((?:[^,)]*,){3}[^,)]*)\)\s*/.exec(e),s){var n,s,o=l(s[1]),i=new u("rgb("+o.slice(0,3).join(",")+")");return i.a=o[3],i}return new u(e)}var K,V=/[a-z0-9_-]/i,I=/[\s\t]/,Te=function(e){for(var t,a,i=!0,n=0,s="",r=0,o=[];;){if(t=e[r],0===n){if(!t&&i)break;if(!t&&!i)throw new Error("Parse error");if('"'===t||"'"===t)a=t,n=1,i=!1;else if(I.test(t));else{if(!V.test(t))throw new Error("Parse error");n=3,i=!1,r--}}else if(1===n){if(!t)throw new Error("Parse Error");"\\"===t?n=2:t===a?(o.push(s),s="",n=4):s+=t}else if(2===n){if(t!==a&&"\\"!==t)throw new Error("Parse error");s+=t,n=1}else if(3===n){if(!t){o.push(s);break}if(V.test(t))s+=t;else if(","===t)o.push(s),s="",n=0;else{if(!I.test(t))throw new Error("Parse error");n=5}}else if(5===n){{if(!t){o.push(s);break}if(V.test(t))s+=" "+t,n=3;else if(","===t)o.push(s),s="",n=0;else if(!I.test(t))throw new Error("Parse error")}}else if(4===n){if(!t)break;if(","===t)n=0;else if(!I.test(t))throw new Error("Parse error")}r++}return o},g={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"},st=(K=Ae.version.split("."),2===parseFloat(K[0])&&3===parseFloat(K[1]));function pe(e,t){return st?400==t?"italic"==e?"italic":"normal":700==t&&"italic"!==e?"bold":e+""+t:400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"}function G(e,t){if("none"===n(t.element,e.styleSheets,"display"))return[0,0,0,0];var s=[0,0,0,0];return t.children.forEach(function(t){var n=t.getBoundingBox(e);s=[Math.min(s[0],n[0]),Math.min(s[1],n[1]),Math.max(s[0]+s[2],n[0]+n[2])-Math.min(s[0],n[0]),Math.max(s[1]+s[3],n[1]+n[3])-Math.min(s[1],n[1])]}),s}function S(e,t){var s=parseFloat,o=s(e.getAttribute("x1"))||s(n(e,t.styleSheets,"x"))||s(n(e,t.styleSheets,"cx"))-s(n(e,t.styleSheets,"r"))||0,a=s(e.getAttribute("x2"))||o+s(n(e,t.styleSheets,"width"))||s(n(e,t.styleSheets,"cx"))+s(n(e,t.styleSheets,"r"))||0,i=s(e.getAttribute("y1"))||s(n(e,t.styleSheets,"y"))||s(n(e,t.styleSheets,"cy"))-s(n(e,t.styleSheets,"r"))||0,r=s(e.getAttribute("y2"))||i+s(n(e,t.styleSheets,"height"))||s(n(e,t.styleSheets,"cy"))+s(n(e,t.styleSheets,"r"))||0;return[Math.min(o,a),Math.min(i,r),Math.max(o,a)-Math.min(o,a),Math.max(i,r)-Math.min(i,r)]}function z(e,t,n,s,o,i,a,r){void 0===r&&(r=!1);var d,u,h,m,f,b,j,_=t[0],y=t[1],p=t[2],g=t[3],c=o/p,l=i/g,v=e.getAttribute("preserveAspectRatio");return v?(u=v.split(" "),"defer"===u[0]&&(u=u.slice(1)),d=u[0],h=u[1]||"meet"):(d="xMidYMid",h="meet"),"none"!==d&&("meet"===h?c=l=Math.min(c,l):"slice"===h&&(c=l=Math.max(c,l))),r?a.pdf.Matrix(c,0,0,l,0,0):(m=n-_*c,f=s-y*l,d.indexOf("xMid")>=0?m+=(o-p*c)/2:d.indexOf("xMax")>=0&&(m+=o-p*c),d.indexOf("YMid")>=0?f+=(i-g*l)/2:d.indexOf("YMax")>=0&&(f+=i-g*l),b=a.pdf.Matrix(1,0,0,1,m,f),j=a.pdf.Matrix(c,0,0,l,0,0),a.pdf.matrixMult(j,b))}function N(e,t){if(!e||"none"===e)return t.pdf.unitMatrix;for(var n,s,i,a,r,c,p=/^[\s,]*matrix\(([^)]+)\)\s*/,d=/^[\s,]*translate\(([^)]+)\)\s*/,f=/^[\s,]*rotate\(([^)]+)\)\s*/,m=/^[\s,]*scale\(([^)]+)\)\s*/,h=/^[\s,]*skewX\(([^)]+)\)\s*/,u=/^[\s,]*skewY\(([^)]+)\)\s*/,o=t.pdf.unitMatrix;e.length>0&&e.length!==a;)a=e.length,s=p.exec(e),(s&&(n=l(s[1]),o=t.pdf.matrixMult(t.pdf.Matrix(n[0],n[1],n[2],n[3],n[4],n[5]),o),e=e.substr(s[0].length)),s=f.exec(e))&&(n=l(s[1]),i=Math.PI*n[0]/180,(o=t.pdf.matrixMult(t.pdf.Matrix(Math.cos(i),Math.sin(i),-Math.sin(i),Math.cos(i),0,0),o),n[1]||n[2])&&(c=t.pdf.Matrix(1,0,0,1,n[1],n[2]),r=t.pdf.Matrix(1,0,0,1,-n[1],-n[2]),o=t.pdf.matrixMult(r,t.pdf.matrixMult(o,c))),e=e.substr(s[0].length)),(s=d.exec(e))&&(n=l(s[1]),o=t.pdf.matrixMult(t.pdf.Matrix(1,0,0,1,n[0],n[1]||0),o),e=e.substr(s[0].length)),(s=m.exec(e))&&((n=l(s[1]))[1]||(n[1]=n[0]),o=t.pdf.matrixMult(t.pdf.Matrix(n[0],0,0,n[1],0,0),o),e=e.substr(s[0].length)),(s=h.exec(e))&&(n=parseFloat(s[1]),n*=Math.PI/180,o=t.pdf.matrixMult(t.pdf.Matrix(1,0,Math.tan(n),1,0,0),o),e=e.substr(s[0].length)),(s=u.exec(e))&&(n=parseFloat(s[1]),n*=Math.PI/180,o=t.pdf.matrixMult(t.pdf.Matrix(1,Math.tan(n),0,1,0,0),o),e=e.substr(s[0].length));return o}var J=function(){function e(e,t){this.element=e,this.children=t,this.parent=null}return e.prototype.setParent=function(e){this.parent=e},e.prototype.getParent=function(){return this.parent},e.prototype.getBoundingBox=function(e){return"none"===n(this.element,e.styleSheets,"display")?[0,0,0,0]:this.getBoundingBoxCore(e)},e.prototype.computeNodeTransform=function(e){var t=this.computeNodeTransformCore(e),s=n(this.element,e.styleSheets,"transform");return s?e.pdf.matrixMult(t,N(s,e)):t},e}(),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){return Promise.resolve()},t.prototype.getBoundingBoxCore=function(){return[]},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t}(J),fe=function(e){function a(t,n,s){var o=e.call(this,n,s)||this;return o.pdfGradientType=t,o.contextColor=void 0,o}return s(a,e),a.prototype.apply=function(e){return o(this,void 0,void 0,function(){var n,s,o,a,r,c;return i(this,function(){return(a=this.element.getAttribute("id"))?(n=this.getStops(e.styleSheets),s=0,o=!1,n.forEach(function(e){var t=e.opacity;t&&1!==t&&(s+=t,o=!0)}),o&&(r=new t.GState({opacity:s/n.length})),c=new t.ShadingPattern(this.pdfGradientType,this.getCoordinates(),n,r),e.pdf.addShadingPattern(a,c),[2]):[2]})})},a.prototype.getStops=function(e){var t,s,o,i=this;if(this.stops)return this.stops;if(void 0===this.contextColor){this.contextColor=null;for(t=this;t;){if(s=n(t.element,e,"color"),s){this.contextColor=x(s,null);break}t=t.getParent()}}return o=[],this.children.forEach(function(t){if("stop"===t.element.tagName.toLowerCase()){var r=n(t.element,e,"color"),s=x(n(t.element,e,"stop-color")||"",r?x(r,null):i.contextColor),c=parseFloat(n(t.element,e,"stop-opacity")||"1");o.push({offset:a.parseGradientOffset(t.element.getAttribute("offset")||"0"),color:[s.r,s.g,s.b],opacity:c})}}),this.stops=o},a.prototype.getBoundingBoxCore=function(e){return S(this.element,e)},a.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},a.prototype.isVisible=function(e,t){return v(this,e,t)},a.parseGradientOffset=function(e){var t=parseFloat(e);return!isNaN(t)&&e.indexOf("%")>=0?t/100:t},a}(k),me=function(e){function t(t,n){return e.call(this,"axial",t,n)||this}return s(t,e),t.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]},t}(fe),le=function(e){function t(t,n){return e.call(this,"radial",t,n)||this}return s(t,e),t.prototype.getCoordinates=function(){var e=this.element.getAttribute("cx"),t=this.element.getAttribute("cy"),n=this.element.getAttribute("fx"),s=this.element.getAttribute("fy");return[parseFloat(n||e||"0.5"),parseFloat(s||t||"0.5"),0,parseFloat(e||"0.5"),parseFloat(t||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]},t}(fe),mt=function(){function e(e,t){this.key=e,this.gradient=t}return e.prototype.getFillData=function(e,t){return o(this,void 0,void 0,function(){var s,o,a;return i(this,function(i){switch(i.label){case 0:return[4,t.refsHandler.getRendered(this.key,null,function(e){return e.apply(new y(t.pdf,{refsHandler:t.refsHandler,textMeasure:t.textMeasure,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters}))})];case 1:return i.sent(),this.gradient.element.hasAttribute("gradientUnits")&&"objectboundingbox"!==this.gradient.element.getAttribute("gradientUnits").toLowerCase()?o=t.pdf.unitMatrix:(s=e.getBoundingBox(t),o=t.pdf.Matrix(s[2],0,0,s[3],s[0],s[1])),a=N(n(this.gradient.element,t.styleSheets,"gradientTransform","transform"),t),[2,{key:this.key,matrix:t.pdf.matrixMult(a,o)}]}})})},e}(),ie=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return s(n,e),n.prototype.apply=function(e){return o(this,void 0,void 0,function(){var n,s,o,a,r;return i(this,function(i){switch(i.label){case 0:if(!(r=this.element.getAttribute("id")))return[2];n=this.getBoundingBox(e),o=new t.TilingPattern([n[0],n[1],n[0]+n[2],n[1]+n[3]],n[2],n[3]),e.pdf.beginTilingPattern(o),s=0,a=this.children,i.label=1;case 1:return s<a.length?[4,a[s].render(new y(e.pdf,{attributeState:e.attributeState,refsHandler:e.refsHandler,styleSheets:e.styleSheets,viewport:e.viewport,svg2pdfParameters:e.svg2pdfParameters,textMeasure:e.textMeasure}))]:[3,4];case 2:i.sent(),i.label=3;case 3:return s++,[3,1];case 4:return e.pdf.endTilingPattern(r,o),[2]}})})},n.prototype.getBoundingBoxCore=function(e){return S(this.element,e)},n.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},n.prototype.isVisible=function(e,t){return v(this,e,t)},n}(k),vt=function(){function e(e,t){this.key=e,this.pattern=t}return e.prototype.getFillData=function(e,t){return o(this,void 0,void 0,function(){var s,o,a,r,c,l,d,u,h,m,f,p;return i(this,function(i){switch(i.label){case 0:return[4,t.refsHandler.getRendered(this.key,null,function(e){return e.apply(new y(t.pdf,{refsHandler:t.refsHandler,textMeasure:t.textMeasure,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters}))})];case 1:return i.sent(),o={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},h=t.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&"objectboundingbox"!==this.pattern.element.getAttribute("patternUnits").toLowerCase()||(s=e.getBoundingBox(t),h=t.pdf.Matrix(1,0,0,1,s[0],s[1]),a=this.pattern.getBoundingBox(t),c=a[0]*s[0]||0,l=a[1]*s[1]||0,d=a[2]*s[2]||0,u=a[3]*s[3]||0,o.boundingBox=[c,l,c+d,l+u],o.xStep=d,o.yStep=u),m=t.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&"objectboundingbox"===this.pattern.element.getAttribute("patternContentUnits").toLowerCase()&&(s||(s=e.getBoundingBox(t)),m=t.pdf.Matrix(s[2],0,0,s[3],0,0),a=o.boundingBox||this.pattern.getBoundingBox(t),c=a[0]/s[0]||0,l=a[1]/s[1]||0,d=a[2]/s[2]||0,u=a[3]/s[3]||0,o.boundingBox=[c,l,c+d,l+u],o.xStep=d,o.yStep=u),f=t.pdf.unitMatrix,(p=n(this.pattern.element,t.styleSheets,"patternTransform","transform"))&&(f=N(p,t)),r=m,r=t.pdf.matrixMult(r,h),r=t.pdf.matrixMult(r,f),r=t.pdf.matrixMult(r,t.transform),o.matrix=r,[2,o]}})})},e}();function ft(e,t){if(s=W.exec(e),s){var s,i,o=s[1],n=t.refsHandler.get(o);return n&&(n instanceof me||n instanceof le)?function(e,t,n){if(o=t.getStops(n.styleSheets),0===o.length)return null;if(1===o.length){var o,i=o[0].color,s=new u;return s.ok=!0,s.r=i[0],s.g=i[1],s.b=i[2],s.a=o[0].opacity,new c(s)}return new mt(e,t)}(o,n,t):n&&n instanceof ie?new vt(o,n):new c(new u("rgb(0, 0, 0)"))}return i=x(e,t.attributeState.color),i.ok?new c(i):null}function Q(e,t,s){var i,a,r,d,h,m,f,v,b,j,y,_,w,O,C,E,k,A,S,M,F,z,D,N,o=s||t.element,T=n(o,e.styleSheets,"color");T&&(_=x(T,e.attributeState.color),_.ok?e.attributeState.color=_:e.attributeState.color=new u("rgb(0,0,0)")),b=n(o,e.styleSheets,"visibility"),b&&(e.attributeState.visibility=b),v=n(o,e.styleSheets,"fill"),v&&(e.attributeState.fill=ft(v,e)),C=n(o,e.styleSheets,"fill-opacity"),C&&(e.attributeState.fillOpacity=parseFloat(C)),m=n(o,e.styleSheets,"stroke-opacity"),m&&(e.attributeState.strokeOpacity=parseFloat(m)),f=n(o,e.styleSheets,"opacity"),f&&(e.attributeState.opacity=parseFloat(f)),i=n(o,e.styleSheets,"stroke-width"),void 0!==i&&""!==i&&(e.attributeState.strokeWidth=Math.abs(parseFloat(i))),r=n(o,e.styleSheets,"stroke"),r&&("none"===r?e.attributeState.stroke=null:(j=x(r,e.attributeState.color),j.ok&&(e.attributeState.stroke=new c(j)))),y=n(o,e.styleSheets,"stroke-linecap"),y&&(e.attributeState.strokeLinecap=y),d=n(o,e.styleSheets,"stroke-linejoin"),d&&(e.attributeState.strokeLinejoin=d),h=n(o,e.styleSheets,"stroke-dasharray"),h&&(N=parseInt(n(o,e.styleSheets,"stroke-dashoffset")||"0"),e.attributeState.strokeDasharray=l(h),e.attributeState.strokeDashoffset=N),a=n(o,e.styleSheets,"stroke-miterlimit"),void 0!==a&&""!==a&&(e.attributeState.strokeMiterlimit=parseFloat(a)),E=o.getAttribute("xml:space"),E&&(e.attributeState.xmlSpace=E),k=n(o,e.styleSheets,"font-weight"),k&&(e.attributeState.fontWeight=k),A=n(o,e.styleSheets,"font-style"),A&&(e.attributeState.fontStyle=A),S=n(o,e.styleSheets,"font-family"),S&&(D=Te(S),e.attributeState.fontFamily=function(e,t,n){var o=pe(e.fontStyle,e.fontWeight),i=n.pdf.getFontList(),s="";return t.some(function(e){var t=i[e];return t&&t.indexOf(o)>=0?(s=e,!0):(e=e.toLowerCase(),!!g.hasOwnProperty(e)&&(s=e,!0))})||(s="times"),s}(e.attributeState,D,e)),F=n(o,e.styleSheets,"font-size"),F&&(z=e.pdf.getFontSize(),e.attributeState.fontSize=p(F,z)),w=n(o,e.styleSheets,"vertical-align")||n(o,e.styleSheets,"alignment-baseline"),w&&(M=w.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/),M&&(e.attributeState.alignmentBaseline=M[0])),O=n(o,e.styleSheets,"text-anchor"),O&&(e.attributeState.textAnchor=O)}function se(e,n,s){var a,r,l,d,u,h,o=1,i=1;o*=e.attributeState.fillOpacity,o*=e.attributeState.opacity,e.attributeState.fill instanceof c&&void 0!==e.attributeState.fill.color.a&&(o*=e.attributeState.fill.color.a),i*=e.attributeState.strokeOpacity,i*=e.attributeState.opacity,e.attributeState.stroke instanceof c&&void 0!==e.attributeState.stroke.color.a&&(i*=e.attributeState.stroke.color.a),a=o<1,r=i<1,(j(s,"use")?(a=!0,r=!0,o*=e.attributeState.fill?1:0,i*=e.attributeState.stroke?1:0):e.withinUse&&(e.attributeState.fill!==n.attributeState.fill?(a=!0,o*=e.attributeState.fill?1:0):a&&!e.attributeState.fill&&(o=0),e.attributeState.stroke!==n.attributeState.stroke?(r=!0,i*=e.attributeState.stroke?1:0):r&&!e.attributeState.stroke&&(i=0)),a||r)&&(d={},a&&(d.opacity=o),r&&(d["stroke-opacity"]=i),e.pdf.setGState(new t.GState(d))),(e.attributeState.fill&&e.attributeState.fill!==n.attributeState.fill&&e.attributeState.fill instanceof c&&e.attributeState.fill.color.ok&&!j(s,"text")&&e.pdf.setFillColor(e.attributeState.fill.color.r,e.attributeState.fill.color.g,e.attributeState.fill.color.b),e.attributeState.strokeWidth!==n.attributeState.strokeWidth&&e.pdf.setLineWidth(e.attributeState.strokeWidth),e.attributeState.stroke!==n.attributeState.stroke&&e.attributeState.stroke instanceof c&&e.pdf.setDrawColor(e.attributeState.stroke.color.r,e.attributeState.stroke.color.g,e.attributeState.stroke.color.b),e.attributeState.strokeLinecap!==n.attributeState.strokeLinecap&&e.pdf.setLineCap(e.attributeState.strokeLinecap),e.attributeState.strokeLinejoin!==n.attributeState.strokeLinejoin&&e.pdf.setLineJoin(e.attributeState.strokeLinejoin),e.attributeState.strokeDasharray===n.attributeState.strokeDasharray&&e.attributeState.strokeDashoffset===n.attributeState.strokeDashoffset||!e.attributeState.strokeDasharray||e.pdf.setLineDashPattern(e.attributeState.strokeDasharray,e.attributeState.strokeDashoffset),e.attributeState.strokeMiterlimit!==n.attributeState.strokeMiterlimit&&e.pdf.setLineMiterLimit(e.attributeState.strokeMiterlimit),e.attributeState.fontFamily!==n.attributeState.fontFamily&&(l=g.hasOwnProperty(e.attributeState.fontFamily)?g[e.attributeState.fontFamily]:e.attributeState.fontFamily),e.attributeState.fill&&e.attributeState.fill!==n.attributeState.fill&&e.attributeState.fill instanceof c&&e.attributeState.fill.color.ok)&&(u=e.attributeState.fill.color,e.pdf.setTextColor(u.r,u.g,u.b)),e.attributeState.fontWeight===n.attributeState.fontWeight&&e.attributeState.fontStyle===n.attributeState.fontStyle||(h=pe(e.attributeState.fontStyle,e.attributeState.fontWeight)),void 0===l&&void 0===h||(void 0===l&&(l=g.hasOwnProperty(e.attributeState.fontFamily)?g[e.attributeState.fontFamily]:e.attributeState.fontFamily),e.pdf.setFont(l,h)),e.attributeState.fontSize!==n.attributeState.fontSize&&e.pdf.setFontSize(e.attributeState.fontSize*e.pdf.internal.scaleFactor)}function de(e,t,n){var o,s=W.exec(e);if(s)return o=s[1],n.refsHandler.get(o)||void 0}function ue(e,t,n){return o(this,void 0,void 0,function(){var s,o;return i(this,function(i){switch(i.label){case 0:return o=n.clone(),t.element.hasAttribute("clipPathUnits")&&"objectboundingbox"===t.element.getAttribute("clipPathUnits").toLowerCase()&&(s=e.getBoundingBox(n),o.transform=n.pdf.matrixMult(n.pdf.Matrix(s[2],0,0,s[3],s[0],s[1]),n.transform)),[4,t.apply(o)];case 1:return i.sent(),[2]}})})}var he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(e){return o(this,void 0,void 0,function(){var t,s,o,a;return i(this,function(i){switch(i.label){case 0:return this.isVisible("hidden"!==e.attributeState.visibility,e)?((t=e.clone()).transform=t.pdf.matrixMult(this.computeNodeTransform(t),e.transform),Q(t,this),s=n(this.element,t.styleSheets,"clip-path"),(o=s&&"none"!==s)?(a=de(s,0,t))?a.isVisible(!0,t)?(t.pdf.saveGraphicsState(),[4,ue(this,a,t)]):[3,2]:[3,4]:[3,5]):[2];case 1:return i.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:o=!1,i.label=5;case 5:return t.withinClipPath||t.pdf.saveGraphicsState(),se(t,e,this.element),[4,this.renderCore(t)];case 6:return i.sent(),t.withinClipPath||t.pdf.restoreGraphicsState(),o&&t.pdf.restoreGraphicsState(),[2]}})})},t}(J),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t}(he),M=function(e){function t(t,n,s){var o=e.call(this,n,s)||this;return o.cachedPath=null,o.hasMarkers=t,o}return s(t,e),t.prototype.renderCore=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return null===(t=this.getCachedPath(e))||0===t.segments.length?[2]:(e.withinClipPath?t.transform(e.transform):e.pdf.setCurrentTransformationMatrix(e.transform),t.draw(e),[4,this.fillOrStroke(e)]);case 1:return n.sent(),this.hasMarkers?[4,this.drawMarkers(e,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.getCachedPath=function(e){return this.cachedPath||(this.cachedPath=this.getPath(e))},t.prototype.drawMarkers=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,this.getMarkers(t,e).draw(e.clone({transform:e.pdf.unitMatrix}))];case 1:return n.sent(),[2]}})})},t.prototype.fillOrStroke=function(e){return o(this,void 0,void 0,function(){var t,s,o,a,r;return i(this,function(i){switch(i.label){case 0:return e.withinClipPath?[2]:(t=e.attributeState.fill,o=e.attributeState.stroke&&0!==e.attributeState.strokeWidth,t?[4,t.getFillData(this,e)]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=void 0,i.label=3;case 3:return s=a,r="evenodd"===n(this.element,e.styleSheets,"fill-rule"),t&&o||e.withinUse?r?e.pdf.fillStrokeEvenOdd(s):e.pdf.fillStroke(s):t?r?e.pdf.fillEvenOdd(s):e.pdf.fill(s):o?e.pdf.stroke():e.pdf.discardPath(),[2]}})})},t.prototype.getBoundingBoxCore=function(e){if(o=this.getCachedPath(e),!o||!o.segments.length)return[0,0,0,0];for(var t,o,n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=0,l=0,d=0;d<o.segments.length;d++)t=o.segments[d],(t instanceof r||t instanceof _||t instanceof h)&&(c=t.x,l=t.y),t instanceof h?(n=Math.min(n,c,t.x1,t.x2,t.x),i=Math.max(i,c,t.x1,t.x2,t.x),s=Math.min(s,l,t.y1,t.y2,t.y),a=Math.max(a,l,t.y1,t.y2,t.y)):(n=Math.min(n,c),i=Math.max(i,c),s=Math.min(s,l),a=Math.max(a,l));return[n,s,i-n,a-s]},t.prototype.getMarkers=function(e,t){var d=n(this.element,t.styleSheets,"marker-start"),a=n(this.element,t.styleSheets,"marker-mid"),c=n(this.element,t.styleSheets,"marker-end"),i=new Be;if(d||a||c){c&&(c=Y(c)),d&&(d=Y(d)),a&&(a=Y(a));for(var o=e.segments,u=[1,0],s=void 0,m=!1,p=[1,0],l=!1,g=function(e){t=o[e],v=d&&(1===e||!(o[e]instanceof r)&&o[e-1]instanceof r),v&&o.forEach(function(t,n){if(!l&&t instanceof X&&n>e){var s=o[n-1];l=(s instanceof r||s instanceof _||s instanceof h)&&s}});var t,f,g,v,j=c&&(e===o.length-1||!(o[e]instanceof r)&&o[e+1]instanceof r),y=a&&e>0&&!(1===e&&o[e-1]instanceof r),n=o[e-1]||null;n instanceof r||n instanceof _||n instanceof h?t instanceof h?(v&&i.addMarker(new b(d,[n.x,n.y],ce(l?[l.x,l.y]:[n.x,n.y],[t.x1,t.y1]))),j&&i.addMarker(new b(c,[t.x,t.y],ce([t.x2,t.y2],[t.x,t.y]))),y&&(s=O([n.x,n.y],[t.x1,t.y1]),s=n instanceof r?s:E(T(u,s)),i.addMarker(new b(a,[n.x,n.y],Math.atan2(s[1],s[0])))),u=O([t.x2,t.y2],[t.x,t.y])):t instanceof r||t instanceof _?((s=O([n.x,n.y],[t.x,t.y]),v)&&(f=l?O([l.x,l.y],[t.x,t.y]):s,i.addMarker(new b(d,[n.x,n.y],Math.atan2(f[1],f[0])))),(j&&i.addMarker(new b(c,[t.x,t.y],Math.atan2(s[1],s[0]))),y)&&(f=t instanceof r?u:n instanceof r?s:E(T(u,s)),i.addMarker(new b(a,[n.x,n.y],Math.atan2(f[1],f[0])))),u=s):t instanceof X&&((s=O([n.x,n.y],[m.x,m.y]),y)&&(f=n instanceof r?s:E(T(u,s)),i.addMarker(new b(a,[n.x,n.y],Math.atan2(f[1],f[0])))),j&&(f=E(T(s,p)),i.addMarker(new b(c,[m.x,m.y],Math.atan2(f[1],f[0])))),u=s):(m=t instanceof r&&t,g=o[e+1],(g instanceof r||g instanceof _||g instanceof h)&&(p=O([m.x,m.y],[g.x,g.y])))},f=0;f<o.length;f++)g(f)}return i},t}(P);function Y(e){var t=W.exec(e);return t&&t[1]||void 0}var lt=function(e){function t(t,n){return e.call(this,!0,t,n)||this}return s(t,e),t.prototype.getPath=function(e){if(e.withinClipPath||null===e.attributeState.stroke)return null;var t=parseFloat(this.element.getAttribute("x1")||"0"),n=parseFloat(this.element.getAttribute("y1")||"0"),s=parseFloat(this.element.getAttribute("x2")||"0"),o=parseFloat(this.element.getAttribute("y2")||"0");return t||s||n||o?(new C).moveTo(t,n).lineTo(s,o):null},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.prototype.isVisible=function(e,t){return f(this,e,t)},t.prototype.fillOrStroke=function(t){return o(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return t.attributeState.fill=null,[4,e.prototype.fillOrStroke.call(this,t)];case 1:return n.sent(),[2]}})})},t}(M),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.apply=function(e){return o(this,void 0,void 0,function(){var t,s,o,a,r;return i(this,function(i){switch(i.label){case 0:return this.isVisible("hidden"!==e.attributeState.visibility,e)?((t=e.clone()).transform=t.pdf.unitMatrix,Q(t,this),s=n(this.element,t.styleSheets,"clip-path"),s&&"none"!==s&&(a=de(s,0,t))?a.isVisible(!0,t)?[4,ue(this,a,t)]:[3,2]:[3,3]):[2];case 1:return i.sent(),[3,3];case 2:return[2];case 3:se(t,e,this.element),o=0,r=this.children,i.label=4;case 4:return o<r.length?[4,r[o].render(t)]:[3,7];case 5:i.sent(),i.label=6;case 6:return o++,[3,4];case 7:return[2]}})})},t.prototype.getBoundingBoxCore=function(e){return G(e,this)},t.prototype.isVisible=function(e,t){return v(this,e,t)},t.prototype.computeNodeTransformCore=function(e){var s=parseFloat(n(this.element,e.styleSheets,"x")||"0"),o=parseFloat(n(this.element,e.styleSheets,"y")||"0"),t=this.element.getAttribute("viewBox");if(t){var i=l(t),a=parseFloat(n(this.element,e.styleSheets,"width")||n(this.element.ownerSVGElement,e.styleSheets,"width")||t[2]),r=parseFloat(n(this.element,e.styleSheets,"height")||n(this.element.ownerSVGElement,e.styleSheets,"height")||t[3]);return z(this.element,i,s,o,a,r,e)}return e.pdf.Matrix(1,0,0,1,s,o)},t}(k),L=function(e,t){this.width=e,this.height=t},Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.renderCore=function(e){return o(this,void 0,void 0,function(){var s,o,a,r,c,d,u,h,m,f,p,g,v;return i(this,function(i){switch(i.label){case 0:return o=parseFloat,(p=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(r=p.substring(1),s=e.refsHandler.get(r),h=j(s.element,"symbol,svg")&&s.element.hasAttribute("viewBox"),c=o(n(this.element,e.styleSheets,"x")||"0"),a=o(n(this.element,e.styleSheets,"y")||"0"),d=void 0,u=void 0,h?(d=o(n(this.element,e.styleSheets,"width")||n(s.element,e.styleSheets,"width")||"0"),u=o(n(this.element,e.styleSheets,"height")||n(s.element,e.styleSheets,"height")||"0"),c+=o(n(s.element,e.styleSheets,"x")||"0"),a+=o(n(s.element,e.styleSheets,"y")||"0"),g=l(s.element.getAttribute("viewBox")),f=z(s.element,g,c,a,d,u,e)):f=e.pdf.Matrix(1,0,0,1,c,a),v=new y(e.pdf,{refsHandler:e.refsHandler,styleSheets:e.styleSheets,withinUse:!0,viewport:h?new L(d,u):e.viewport,svg2pdfParameters:e.svg2pdfParameters,textMeasure:e.textMeasure}),m=e.attributeState.color,[4,e.refsHandler.getRendered(r,m,function(e){return t.renderReferencedNode(e,r,m,v)})]):[2];case 1:return i.sent(),e.pdf.saveGraphicsState(),e.pdf.setCurrentTransformationMatrix(e.transform),h&&"visible"!==n(s.element,e.styleSheets,"overflow")&&(e.pdf.rect(c,a,d,u),e.pdf.clip().discardPath()),e.pdf.doFormObject(e.refsHandler.generateKey(r,m),f),e.pdf.restoreGraphicsState(),[2]}})})},t.renderReferencedNode=function(e,t,n,s){return o(this,void 0,void 0,function(){var o;return i(this,function(i){switch(i.label){case 0:return o=[(o=e.getBoundingBox(s))[0]-.5*o[2],o[1]-.5*o[3],2*o[2],2*o[3]],s.attributeState.color=n,s.pdf.beginFormObject(o[0],o[1],o[2],o[3],s.pdf.unitMatrix),e instanceof oe?[4,e.apply(s)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,e.render(s)];case 3:i.sent(),i.label=4;case 4:return s.pdf.endFormObject(s.refsHandler.generateKey(t,n)),[2]}})})},t.prototype.getBoundingBoxCore=function(e){return S(this.element,e)},t.prototype.isVisible=function(e,t){return f(this,e,t)},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t}(P),Ye=function(e){function t(t,n){return e.call(this,!1,t,n)||this}return s(t,e),t.prototype.getPath=function(e){if(a=parseFloat(n(this.element,e.styleSheets,"width")||"0"),r=parseFloat(n(this.element,e.styleSheets,"height")||"0"),!isFinite(a)||a<=0||!isFinite(r)||r<=0)return null;var a,r,l=n(this.element,e.styleSheets,"rx"),d=n(this.element,e.styleSheets,"ry"),o=Math.min(parseFloat(l||d||"0"),.5*a),i=Math.min(parseFloat(d||l||"0"),.5*r),t=parseFloat(n(this.element,e.styleSheets,"x")||"0"),s=parseFloat(n(this.element,e.styleSheets,"y")||"0"),c=4/3*(Math.SQRT2-1);return 0===o&&0===i?(new C).moveTo(t,s).lineTo(t+a,s).lineTo(t+a,s+r).lineTo(t,s+r).close():(new C).moveTo(t+=o,s).lineTo(t+=a-2*o,s).curveTo(t+o*c,s,t+o,s+(i-i*c),t+=o,s+=i).lineTo(t,s+=r-2*i).curveTo(t,s+i*c,t-o*c,s+i,t-=o,s+=i).lineTo(t+=2*o-a,s).curveTo(t-o*c,s,t-o,s-i*c,t-=o,s-=i).lineTo(t,s+=2*i-r).curveTo(t,s-i*c,t+o*c,s-i,t+=o,s-=i).close()},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.prototype.isVisible=function(e,t){return f(this,e,t)},t}(M),_e=function(e){function t(t,n){return e.call(this,!1,t,n)||this}return s(t,e),t.prototype.getPath=function(e){if(i=this.getRx(e),o=this.getRy(e),!isFinite(i)||o<=0||!isFinite(o)||o<=0)return null;var o,i,t=parseFloat(n(this.element,e.styleSheets,"cx")||"0"),s=parseFloat(n(this.element,e.styleSheets,"cy")||"0"),a=4/3*(Math.SQRT2-1)*i,r=4/3*(Math.SQRT2-1)*o;return(new C).moveTo(t+i,s).curveTo(t+i,s-r,t+a,s-o,t,s-o).curveTo(t-a,s-o,t-i,s-r,t-i,s).curveTo(t-i,s+r,t-a,s+o,t,s+o).curveTo(t+a,s+o,t+i,s+r,t+i,s)},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.prototype.isVisible=function(e,t){return f(this,e,t)},t}(M),Ke=function(e){function t(t,n){return e.call(this,t,n)||this}return s(t,e),t.prototype.getRx=function(e){return parseFloat(n(this.element,e.styleSheets,"rx")||"0")},t.prototype.getRy=function(e){return parseFloat(n(this.element,e.styleSheets,"ry")||"0")},t}(_e);function Oe(e){var t="invisible",n=e.stroke&&0!==e.strokeWidth,s=e.fill;return s&&n?t="fillThenStroke":s?t="fill":n&&(t="stroke"),t}function xe(e){return e.replace(/[\n\r]/g,"")}function Ce(e){return e.replace(/[\t]/g," ")}function Ee(e){return e.replace(/ +/g," ")}function ke(e,t,s){switch(n(e,s.styleSheets,"text-transform")){case"uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();default:return t}}var $=function(){function e(e,t,n,s){this.textNode=e,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=t,this.originX=n,this.originY=s,this.textMeasures=[]}return e.prototype.setX=function(e){this.originX=e},e.prototype.setY=function(e){this.originY=e},e.prototype.add=function(e,t,n){this.texts.push(t),this.textNodes.push(e),this.contexts.push(n)},e.prototype.rightTrimText=function(){for(var e=this.texts.length-1;e>=0;e--)if("default"===this.contexts[e].attributeState.xmlSpace&&(this.texts[e]=this.texts[e].replace(/\s+$/,"")),this.texts[e].match(/[^\s]/))return!1;return!0},e.prototype.measureText=function(e){for(var t=0;t<this.texts.length;t++)this.textMeasures.push({width:e.textMeasure.measureTextWidth(this.texts[t],this.contexts[t].attributeState),length:this.texts[t].length})},e.prototype.put=function(t,n){var s,o,i,r,c,d,m,f,g,v,_,y=[],j=[],b=[],a=this.originX,h=this.originY,l=a,u=a;for(s=0;s<this.textNodes.length;s++)o=this.textNodes[s],i=this.contexts[s],g=this.textMeasures[s]||{width:t.textMeasure.measureTextWidth(this.texts[s],this.contexts[s].attributeState),length:this.texts[s].length},c=a,d=h,"#text"!==o.nodeName&&!y.includes(o)&&(y.push(o),m=e.resolveRelativePositionAttribute(o,"dx"),null!==m&&(c+=p(m,i.attributeState.fontSize)),f=e.resolveRelativePositionAttribute(o,"dy"),null!==f&&(d+=p(f,i.attributeState.fontSize))),j[s]=c,b[s]=d,a=c+g.width+g.length*n,h=d,l=Math.min(l,c),u=Math.max(u,a);switch(r=0,this.textAnchor){case"start":r=0;break;case"middle":r=(u-l)/2;break;case"end":r=u-l}for(s=0;s<this.textNodes.length;s++)(o=this.textNodes[s],i=this.contexts[s],"#text"===o.nodeName||"hidden"!==i.attributeState.visibility)&&(t.pdf.saveGraphicsState(),se(i,t,o),_=i.attributeState.alignmentBaseline,v=Oe(i.attributeState),t.pdf.text(this.texts[s],j[s]-r,b[s],{baseline:Me(_),angle:t.transform,renderingMode:"fill"===v?void 0:v,charSpace:0===n?void 0:n}),t.pdf.restoreGraphicsState());return[a,h]},e.resolveRelativePositionAttribute=function(e,t){for(var s,n=e;n&&j(n,"tspan");){if(n.hasAttribute(t))return n.getAttribute(t);if((null===(s=e.parentElement)||void 0===s?void 0:s.firstChild)!==e)break;n=n.parentElement}return null},e}(),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.processTSpans=function(e,t,s,o,i,a){for(var r,c,l,d,h,m,f,y,_,w,v=s.pdf.getFontSize(),O=s.attributeState.xmlSpace,b=!0,g=!1,u=0;u<t.childNodes.length;u++)c=t.childNodes[u],c.textContent&&(d=c.textContent,"#text"===c.nodeName?(r=xe(d),r=Ce(r),"default"===O&&(r=Ee(r),b&&r.match(/^\s/)&&(g=!0),r.match(/[^\s]/)&&(b=!1),a.prevText.match(/\s$/)&&(r=r.replace(/^\s+/,""))),y=ke(t,r,s),i.add(t,y,s),a.prevText=d,a.prevContext=s):j(c,"title")||j(c,"tspan")&&(l=c,h=l.getAttribute("x"),null!==h&&(_=p(h,v),i=new $(this,n(l,s.styleSheets,"text-anchor")||s.attributeState.textAnchor,_,0),o.push({type:"y",chunk:i})),m=l.getAttribute("y"),null!==m&&(w=p(m,v),i=new $(this,n(l,s.styleSheets,"text-anchor")||s.attributeState.textAnchor,0,w),o.push({type:"x",chunk:i})),f=s.clone(),Q(f,e,l),this.processTSpans(e,l,f,o,i,a)));return g},t.prototype.renderCore=function(e){return o(this,void 0,void 0,function(){var t,n,s,o,a,r,c,l,d,u,h,m,f,g,v,b,j,y,_,w,O,x,C;return i(this,function(){if(e.pdf.saveGraphicsState(),h=0,n=0,o=1,a=e.pdf.getFontSize(),v=p(this.element.getAttribute("x"),a),j=p(this.element.getAttribute("y"),a),f=p(this.element.getAttribute("dx"),a),m=p(this.element.getAttribute("dy"),a),s=parseFloat(this.element.getAttribute("textLength")||"0"),C=e.attributeState.visibility,0===this.element.childElementCount)l=this.element.textContent||"",_=function(e,t){return e=Ce(e=xe(e)),"default"===t.xmlSpace&&(e=Ee(e=e.trim())),e}(l,e.attributeState),r=ke(this.element,_,e),h=e.textMeasure.getTextOffset(r,e.attributeState),s>0&&(x=e.textMeasure.measureTextWidth(r,e.attributeState),"default"===e.attributeState.xmlSpace&&l.match(/^\s/)&&(o=0),n=(s-x)/(r.length-o)||0),"visible"===C&&(O=e.attributeState.alignmentBaseline,b=Oe(e.attributeState),e.pdf.text(r,v+f-h,j+m,{baseline:Me(O),angle:e.transform,renderingMode:"fill"===b?void 0:b,charSpace:0===n?void 0:n}));else{for(t=[],y=new $(this,e.attributeState.textAnchor,v+f,j+m),t.push({type:"",chunk:y}),w=this.processTSpans(this,this.element,e,t,y,{prevText:" ",prevContext:e}),o=w?0:1,d=!0,c=t.length-1;c>=0;c--)d&&(d=t[c].chunk.rightTrimText());s>0&&(g=0,u=0,t.forEach(function(t){var n=t.chunk;n.measureText(e),n.textMeasures.forEach(function(e){var t=e.width,n=e.length;g+=t,u+=n})}),n=(s-g)/(u-o)),t.reduce(function(t,s){var i=s.type,o=s.chunk;return"x"===i?o.setX(t[0]):"y"===i&&o.setY(t[1]),o.put(e,n)},[0,0])}return e.pdf.restoreGraphicsState(),[2]})})},t.prototype.isVisible=function(e,t){return v(this,e,t)},t.prototype.getBoundingBoxCore=function(e){return S(this.element,e)},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t}(P),H={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},Le=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function w(e){return e>=48&&e<=57}function ze(e){return e>=48&&e<=57||43===e||45===e||46===e}function De(e){this.index=0,this.path=e,this.max=e.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function R(e){for(var t;e.index<e.max&&(10===(t=e.path.charCodeAt(e.index))||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&Le.indexOf(t)>=0);)e.index++}function Fe(e){var t=e.path.charCodeAt(e.index);return 48===t?(e.param=0,void e.index++):49===t?(e.param=1,void e.index++):void(e.err="SvgPath: arc flag can be 0 or 1 only (at pos "+e.index+")")}function Re(e){var n,o=e.index,t=o,s=e.max,i=!1,a=!1,r=!1,c=!1;if(t>=s)e.err="SvgPath: missed param (at pos "+t+")";else if(43!==(n=e.path.charCodeAt(t))&&45!==n||(n=++t<s?e.path.charCodeAt(t):0),w(n)||46===n){if(46!==n){if(i=48===n,n=++t<s?e.path.charCodeAt(t):0,i&&t<s&&n&&w(n))return void(e.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+o+")");for(;t<s&&w(e.path.charCodeAt(t));)t++,a=!0;n=t<s?e.path.charCodeAt(t):0}if(46===n){for(c=!0,t++;w(e.path.charCodeAt(t));)t++,r=!0;n=t<s?e.path.charCodeAt(t):0}if(101===n||69===n){if(c&&!a&&!r)return void(e.err="SvgPath: invalid float exponent (at pos "+t+")");if(43!==(n=++t<s?e.path.charCodeAt(t):0)&&45!==n||t++,!(t<s&&w(e.path.charCodeAt(t))))return void(e.err="SvgPath: invalid float exponent (at pos "+t+")");for(;t<s&&w(e.path.charCodeAt(t));)t++}e.index=t,e.param=parseFloat(e.path.slice(o,t))+0}else e.err="SvgPath: param should start with 0..9 or `.` (at pos "+t+")"}function Se(e){var n,s=(n=e.path[e.segmentStart]).toLowerCase(),t=e.data;if("m"===s&&t.length>2&&(e.result.push([n,t[0],t[1]]),t=t.slice(2),s="l",n="m"===n?"l":"L"),"r"===s)e.result.push([n].concat(t));else for(;t.length>=H[s]&&(e.result.push([n].concat(t.splice(0,H[s]))),H[s]););}function He(e){var t,n,s,o,i,a=e.max;if(e.segmentStart=e.index,s=e.path.charCodeAt(e.index),i=97==(32|s),function(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(s))if(o=H[e.path[e.index].toLowerCase()],e.index++,R(e),e.data=[],o){for(n=!1;;){for(t=o;t>0;t--){if(!i||3!==t&&4!==t?Re(e):Fe(e),e.err.length)return;e.data.push(e.param),R(e),n=!1,e.index<a&&44===e.path.charCodeAt(e.index)&&(e.index++,R(e),n=!0)}if(!n){if(e.index>=e.max)break;if(!ze(e.path.charCodeAt(e.index)))break}}Se(e)}else Se(e);else e.err="SvgPath: bad command "+e.path[e.index]+" (at pos "+e.index+")"}function d(){if(!(this instanceof d))return new d;this.queue=[],this.cache=null}d.prototype.matrix=function(e){return 1===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&0===e[4]&&0===e[5]||(this.cache=null,this.queue.push(e)),this},d.prototype.translate=function(e,t){return 0===e&&0===t||(this.cache=null,this.queue.push([1,0,0,1,e,t])),this},d.prototype.scale=function(e,t){return 1===e&&1===t||(this.cache=null,this.queue.push([e,0,0,t,0,0])),this},d.prototype.rotate=function(e,t,n){var s,o,i;return 0!==e&&(this.translate(t,n),s=e*Math.PI/180,o=Math.cos(s),i=Math.sin(s),this.queue.push([o,i,-i,o,0,0]),this.cache=null,this.translate(-t,-n)),this},d.prototype.skewX=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,0,Math.tan(e*Math.PI/180),1,0,0])),this},d.prototype.skewY=function(e){return 0!==e&&(this.cache=null,this.queue.push([1,Math.tan(e*Math.PI/180),0,1,0,0])),this},d.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var e,t,n=1;n<this.queue.length;n++)this.cache=(e=this.cache,t=this.queue[n],[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]);return this.cache},d.prototype.calc=function(e,t,n){var s;return this.queue.length?(this.cache||(this.cache=this.toArray()),[e*(s=this.cache)[0]+t*s[2]+(n?0:s[4]),e*s[1]+t*s[3]+(n?0:s[5])]):[e,t]};var m=d,Ve={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},$e=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,We=/[\s,]+/,A=2*Math.PI;function we(e,t,n,s){var o=e*n+t*s;return o>1&&(o=1),o<-1&&(o=-1),(e*s-t*n<0?-1:1)*Math.acos(o)}function qe(e,t){var n=4/3*Math.tan(t/4),s=Math.cos(e),o=Math.sin(e),i=Math.cos(e+t),a=Math.sin(e+t);return[s,o,s-o*n,o+s*n,i+a*n,a-i*n,i,a]}ye=function(e,t,n,s,o,i,a,r,c){var l=Math.sin(c*A/360),d=Math.cos(c*A/360),f=d*(e-n)/2+l*(t-s)/2,p=-l*(e-n)/2+d*(t-s)/2;if(0===f&&0===p)return[];if(0===a||0===r)return[];a=Math.abs(a),r=Math.abs(r),u=f*f/(a*a)+p*p/(r*r),u>1&&(a*=Math.sqrt(u),r*=Math.sqrt(u));var u,g,h=function(e,t,n,s,o,i,a,r,c,l){var h=l*(e-n)/2+c*(t-s)/2,u=-c*(e-n)/2+l*(t-s)/2,g=a*a,v=r*r,b=h*h,_=u*u,d=g*v-g*_-v*b;d<0&&(d=0),d/=g*_+v*b;var p=(d=Math.sqrt(d)*(o===i?-1:1))*a/r*u,f=d*-r/a*h,w=l*p-c*f+(e+n)/2,O=c*p+l*f+(t+s)/2,j=(h-p)/a,y=(u-f)/r,x=(-h-p)/a,C=(-u-f)/r,E=we(1,0,j,y),m=we(j,y,x,C);return 0===i&&m>0&&(m-=A),1===i&&m<0&&(m+=A),[w,O,E,m]}(e,t,n,s,o,i,a,r,l,d),v=[],b=h[2],m=h[3],j=Math.max(Math.ceil(Math.abs(m)/(A/4)),1);m/=j;for(g=0;g<j;g++)v.push(qe(b,m)),b+=m;return v.map(function(e){for(t=0;t<e.length;t+=2){var t,n=e[t+0],s=e[t+1],o=d*(n*=a)-l*(s*=r),i=l*n+d*s;e[t+0]=o+h[0],e[t+1]=i+h[1]}return e})},U=Math.PI/180;function F(e,t,n){if(!(this instanceof F))return new F(e,t,n);this.rx=e,this.ry=t,this.ax=n}F.prototype.transform=function(e){var s=Math.cos(this.ax*U),o=Math.sin(this.ax*U),t=[this.rx*(e[0]*s+e[2]*o),this.rx*(e[1]*s+e[3]*o),this.ry*(-e[0]*o+e[2]*s),this.ry*(-e[1]*o+e[3]*s)],l=t[0]*t[0]+t[2]*t[2],i=t[1]*t[1]+t[3]*t[3],a=((t[0]-t[3])*(t[0]-t[3])+(t[2]+t[1])*(t[2]+t[1]))*((t[0]+t[3])*(t[0]+t[3])+(t[2]-t[1])*(t[2]-t[1])),r=(l+i)/2;if(a<1e-10*r)return this.rx=this.ry=Math.sqrt(r),this.ax=0,this;var c=t[0]*t[1]+t[2]*t[3],n=r+(a=Math.sqrt(a))/2,d=r-a/2;return this.ax=Math.abs(c)<1e-10&&Math.abs(n-i)<1e-10?90:180*Math.atan(Math.abs(c)>Math.abs(n-i)?(n-l)/c:c/(n-i))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(n),this.ry=Math.sqrt(d)):(this.ax+=90,this.rx=Math.sqrt(d),this.ry=Math.sqrt(n)),this},F.prototype.isDegenerate=function(){return this.rx<1e-10*this.ry||this.ry<1e-10*this.rx},je=F;function a(e){if(!(this instanceof a))return new a(e);var t=function(e){var t=new De(e),n=t.max;for(R(t);t.index<n&&!t.err.length;)He(t);return t.err.length?t.result=[]:t.result.length&&("mM".indexOf(t.result[0][0])<0?(t.err="SvgPath: string should start with `M` or `m`",t.result=[]):t.result[0][0]="M"),{err:t.err,segments:t.result}}(e);this.segments=t.segments,this.err=t.err,this.__stack=[]}a.from=function(e){if("string"==typeof e)return new a(e);if(e instanceof a){var t=new a("");return t.err=e.err,t.segments=e.segments.map(function(e){return e.slice()}),t.__stack=e.__stack.map(function(e){return m().matrix(e.toArray())}),t}throw new Error("SvgPath.from: invalid param type "+e)},a.prototype.__matrix=function(e){var t,n=this;e.queue.length&&this.iterate(function(s,o,i,a){switch(s[0]){case"v":c=0===(r=e.calc(0,s[1],!0))[0]?["v",r[1]]:["l",r[0],r[1]];break;case"V":c=(r=e.calc(i,s[1],!1))[0]===e.calc(i,a,!1)[0]?["V",r[1]]:["L",r[0],r[1]];break;case"h":c=0===(r=e.calc(s[1],0,!0))[1]?["h",r[0]]:["l",r[0],r[1]];break;case"H":c=(r=e.calc(s[1],a,!1))[1]===e.calc(i,a,!1)[1]?["H",r[0]]:["L",r[0],r[1]];break;case"a":case"A":var r,c,d,h,l=e.toArray(),u=je(s[1],s[2],s[3]).transform(l);if(l[0]*l[3]-l[1]*l[2]<0&&(s[5]=s[5]?"0":"1"),r=e.calc(s[6],s[7],"a"===s[0]),"A"===s[0]&&s[6]===i&&s[7]===a||"a"===s[0]&&0===s[6]&&0===s[7]){c=["a"===s[0]?"l":"L",r[0],r[1]];break}c=u.isDegenerate()?["a"===s[0]?"l":"L",r[0],r[1]]:[s[0],u.rx,u.ry,u.ax,s[4],s[5],r[0],r[1]];break;case"m":d=o>0,c=["m",(r=e.calc(s[1],s[2],d))[0],r[1]];break;default:for(c=[h=s[0]],d=h.toLowerCase()===h,t=1;t<s.length;t+=2)r=e.calc(s[t],s[t+1],d),c.push(r[0],r[1])}n.segments[o]=c},!0)},a.prototype.__evaluateStack=function(){var e,t;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(e=m(),t=this.__stack.length;--t>=0;)e.matrix(this.__stack[t].toArray());this.__matrix(e),this.__stack=[]}},a.prototype.toString=function(){var e,n,s,o,i,c,t="",a="",r=!1;this.__evaluateStack();for(s=0,c=this.segments.length;s<c;s++){o=this.segments[s],e=o[0],e!==a||"m"===e||"M"===e?("m"===e&&"z"===a&&(t+=" "),t+=e,r=!1):r=!0;for(n=1;n<o.length;n++)i=o[n],1===n?r&&i>=0&&(t+=" "):i>=0&&(t+=" "),t+=i;a=e}return t},a.prototype.translate=function(e,t){return this.__stack.push(m().translate(e,t||0)),this},a.prototype.scale=function(e,t){return this.__stack.push(m().scale(e,t||0===t?t:e)),this},a.prototype.rotate=function(e,t,n){return this.__stack.push(m().rotate(e,t||0,n||0)),this},a.prototype.skewX=function(e){return this.__stack.push(m().skewX(e)),this},a.prototype.skewY=function(e){return this.__stack.push(m().skewY(e)),this},a.prototype.matrix=function(e){return this.__stack.push(m().matrix(e)),this},a.prototype.transform=function(e){return e.trim()?(this.__stack.push(function(e){var t,s,n=new m;return e.split($e).forEach(function(e){if(e.length)if(void 0===Ve[e])switch(t=e.split(We).map(function(e){return+e||0}),s){case"matrix":return void(6===t.length&&n.matrix(t));case"scale":return void(1===t.length?n.scale(t[0],t[0]):2===t.length&&n.scale(t[0],t[1]));case"rotate":return void(1===t.length?n.rotate(t[0],0,0):3===t.length&&n.rotate(t[0],t[1],t[2]));case"translate":return void(1===t.length?n.translate(t[0],0):2===t.length&&n.translate(t[0],t[1]));case"skewX":return void(1===t.length&&n.skewX(t[0]));case"skewY":return void(1===t.length&&n.skewY(t[0]))}else s=e}),n}(e)),this):this},a.prototype.round=function(e){var s,o=0,i=0,t=0,n=0;return e=e||0,this.__evaluateStack(),this.segments.forEach(function(a){var r=a[0].toLowerCase()===a[0];switch(a[0]){case"H":case"h":return r&&(a[1]+=t),t=a[1]-a[1].toFixed(e),void(a[1]=+a[1].toFixed(e));case"V":case"v":return r&&(a[1]+=n),n=a[1]-a[1].toFixed(e),void(a[1]=+a[1].toFixed(e));case"Z":case"z":return t=o,void(n=i);case"M":case"m":return r&&(a[1]+=t,a[2]+=n),t=a[1]-a[1].toFixed(e),n=a[2]-a[2].toFixed(e),o=t,i=n,a[1]=+a[1].toFixed(e),void(a[2]=+a[2].toFixed(e));case"A":case"a":return r&&(a[6]+=t,a[7]+=n),t=a[6]-a[6].toFixed(e),n=a[7]-a[7].toFixed(e),a[1]=+a[1].toFixed(e),a[2]=+a[2].toFixed(e),a[3]=+a[3].toFixed(e+2),a[6]=+a[6].toFixed(e),void(a[7]=+a[7].toFixed(e));default:return s=a.length,r&&(a[s-2]+=t,a[s-1]+=n),t=a[s-2]-a[s-2].toFixed(e),n=a[s-1]-a[s-1].toFixed(e),void a.forEach(function(t,n){n&&(a[n]=+a[n].toFixed(e))})}}),this},a.prototype.iterate=function(e,t){var o,i,a,c=this.segments,r={},l=!1,n=0,s=0,d=0,u=0;if(t||this.__evaluateStack(),c.forEach(function(t,o){var i,a=e(t,o,n,s);switch(Array.isArray(a)&&(r[o]=a,l=!0),i=t[0]===t[0].toLowerCase(),t[0]){case"m":case"M":return n=t[1]+(i?n:0),s=t[2]+(i?s:0),d=n,void(u=s);case"h":case"H":return void(n=t[1]+(i?n:0));case"v":case"V":return void(s=t[1]+(i?s:0));case"z":case"Z":return n=d,void(s=u);default:n=t[t.length-2]+(i?n:0),s=t[t.length-1]+(i?s:0)}}),!l)return this;for(a=[],o=0;o<c.length;o++)if(void 0!==r[o])for(i=0;i<r[o].length;i++)a.push(r[o][i]);else a.push(c[o]);return this.segments=a,this},a.prototype.abs=function(){return this.iterate(function(e,t,n,s){var o,i=e[0],a=i.toUpperCase();if(i!==a)switch(e[0]=a,i){case"v":return void(e[1]+=s);case"a":return e[6]+=n,void(e[7]+=s);default:for(o=1;o<e.length;o++)e[o]+=o%2?n:s}},!0),this},a.prototype.rel=function(){return this.iterate(function(e,t,n,s){var o,i=e[0],a=i.toLowerCase();if(i!==a&&(0!==t||"M"!==i))switch(e[0]=a,i){case"V":return void(e[1]-=s);case"A":return e[6]-=n,void(e[7]-=s);default:for(o=1;o<e.length;o++)e[o]-=o%2?n:s}},!0),this},a.prototype.unarc=function(){return this.iterate(function(e,t,n,s){var o,i,r,c=[],a=e[0];return"A"!==a&&"a"!==a?null:("a"===a?(o=n+e[6],i=s+e[7]):(o=e[6],i=e[7]),0===(r=ye(n,s,o,i,e[4],e[5],e[1],e[2],e[3])).length?[["a"===e[0]?"l":"L",e[6],e[7]]]:(r.forEach(function(e){c.push(["C",e[2],e[3],e[4],e[5],e[6],e[7]])}),c))}),this},a.prototype.unshort=function(){var e,t,n,s,o,i=this.segments;return this.iterate(function(a,r,c,l){var d,u=a[0],h=u.toUpperCase();r&&("T"===h?(d="t"===u,"Q"===(e=i[r-1])[0]?(t=e[1]-c,n=e[2]-l):"q"===e[0]?(t=e[1]-e[3],n=e[2]-e[4]):(t=0,n=0),s=-t,o=-n,d||(s+=c,o+=l),i[r]=[d?"q":"Q",s,o,a[1],a[2]]):"S"===h&&(d="s"===u,"C"===(e=i[r-1])[0]?(t=e[3]-c,n=e[4]-l):"c"===e[0]?(t=e[3]-e[5],n=e[4]-e[6]):(t=0,n=0),s=-t,o=-n,d||(s+=c,o+=l),i[r]=[d?"c":"C",s,o,a[1],a[2],a[3],a[4]]))}),this};var Ae,te,D,K,q,Z,ye,U,je,Je=a,et=function(e){function t(t,n){return e.call(this,!0,t,n)||this}return s(t,e),t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.prototype.isVisible=function(e,t){return f(this,e,t)},t.prototype.getPath=function(e){var s,o,i=new Je(n(this.element,e.styleSheets,"d")||"").unshort().unarc().abs(),t=new C;return i.iterate(function(e){switch(e[0]){case"M":t.moveTo(e[1],e[2]);break;case"L":t.lineTo(e[1],e[2]);break;case"H":t.lineTo(e[1],o);break;case"V":t.lineTo(s,e[1]);break;case"C":t.curveTo(e[1],e[2],e[3],e[4],e[5],e[6]);break;case"Q":var n=be([s,o],[e[1],e[2]]),i=be([e[3],e[4]],[e[1],e[2]]);t.curveTo(n[0],n[1],i[0],i[1],e[3],e[4]);break;case"Z":t.close()}switch(e[0]){case"M":case"L":s=e[1],o=e[2];break;case"H":s=e[1];break;case"V":o=e[1];break;case"C":s=e[5],o=e[6];break;case"Q":s=e[3],o=e[4]}}),t},t}(M),tt=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,((?:.|\s)*)$/i,nt=function(e){function t(n,s){var o=e.call(this,n,s)||this;return o.imageLoadingPromise=null,o.imageUrl=o.element.getAttribute("xlink:href")||o.element.getAttribute("href"),o.imageUrl&&(o.imageLoadingPromise=t.fetchImageData(o.imageUrl)),o}return s(t,e),t.prototype.renderCore=function(e){return o(this,void 0,void 0,function(){var t,s,o,a,r,c,l,d,u,h,m,f;return i(this,function(i){switch(i.label){case 0:return this.imageLoadingPromise?(e.pdf.setCurrentTransformationMatrix(e.transform),s=parseFloat(n(this.element,e.styleSheets,"width")||"0"),o=parseFloat(n(this.element,e.styleSheets,"height")||"0"),a=parseFloat(n(this.element,e.styleSheets,"x")||"0"),r=parseFloat(n(this.element,e.styleSheets,"y")||"0"),!isFinite(s)||s<=0||!isFinite(o)||o<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return c=i.sent(),l=c.data,0!==(u=c.format).indexOf("svg")?[3,3]:(h=new DOMParser,t=h.parseFromString(l,"image/svg+xml").firstElementChild,(!(d=this.element.getAttribute("preserveAspectRatio"))||d.indexOf("defer")<0||!t.getAttribute("preserveAspectRatio"))&&t.setAttribute("preserveAspectRatio",d||""),t.setAttribute("x",String(a)),t.setAttribute("y",String(r)),t.setAttribute("width",String(s)),t.setAttribute("height",String(o)),[4,ne(t,m={}).render(new y(e.pdf,{refsHandler:new q(m),styleSheets:e.styleSheets,viewport:new L(s,o),svg2pdfParameters:e.svg2pdfParameters,textMeasure:e.textMeasure}))]);case 2:return i.sent(),[2];case 3:f="data:image/"+u+";base64,"+btoa(l);try{e.pdf.addImage(f,"",a,r,s,o)}catch(e){"object"==typeof console&&console.warn&&console.warn("Could not load image "+this.imageUrl+`. 
`+e)}i.label=4;case 4:return[2]}})})},t.prototype.getBoundingBoxCore=function(e){return S(this.element,e)},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.prototype.isVisible=function(e,t){return f(this,e,t)},t.fetchImageData=function(e){return o(this,void 0,void 0,function(){var n,s,o,a,r;return i(this,function(i){switch(i.label){case 0:if(!(s=e.match(tt)))return[3,1];if(a=s[2],"image"!==(r=a.split("/"))[0])throw new Error("Unsupported image URL: "+e);return o=r[1],n=s[5],"base64"===s[4]?(n=n.replace(/\s/g,""),n=atob(n)):n=decodeURIComponent(n),[3,3];case 1:return[4,t.fetchImage(e)];case 2:n=i.sent(),o=e.substring(e.lastIndexOf(".")+1),i.label=3;case 3:return[2,{data:n,format:o}]}})})},t.fetchImage=function(e){return new Promise(function(t,n){var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=function(){if(200!==s.status)throw new Error("Error "+s.status+": Failed to load image '"+e+"'");for(var o=new Uint8Array(s.response),i="",n=0;n<o.length;n++)i+=String.fromCharCode(o[n]);t(i)},s.onerror=n,s.onabort=n,s.send(null)})},t.getMimeType=function(e){switch(e=e.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/"+e}},t}(P),ve=function(e){function t(t,n,s){var o=e.call(this,!0,n,s)||this;return o.closed=t,o}return s(t,e),t.prototype.getPath=function(){if(!this.element.hasAttribute("points")||""===this.element.getAttribute("points"))return null;var o,n=t.parsePointsString(this.element.getAttribute("points")),s=new C;if(n.length<1)return s;s.moveTo(n[0][0],n[0][1]);for(o=1;o<n.length;o++)s.lineTo(n[o][0],n[o][1]);return this.closed&&s.close(),s},t.prototype.isVisible=function(e,t){return f(this,e,t)},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.parsePointsString=function(e){for(var o,i,n=l(e),s=[],t=0;t<n.length-1;t+=2)o=n[t],i=n[t+1],s.push([o,i]);return s},t}(M),ot=function(e){function t(t,n){return e.call(this,!0,t,n)||this}return s(t,e),t}(ve),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){return Promise.resolve()},t.prototype.getBoundingBoxCore=function(){return[0,0,0,0]},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t.prototype.isVisible=function(e,t){return f(this,e,t)},t}(J),at=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return s(n,e),n.prototype.apply=function(e){return o(this,void 0,void 0,function(){var n,s,o,a,r;return i(this,function(i){switch(i.label){case 0:a=this.computeNodeTransform(e),n=this.getBoundingBox(e),e.pdf.beginFormObject(n[0],n[1],n[2],n[3],a),function(e){var o,i,l,d,n=e.attributeState,s=e.pdf,a=1,r=1;a*=n.fillOpacity,a*=n.opacity,n.fill instanceof c&&void 0!==n.fill.color.a&&(a*=n.fill.color.a),r*=n.strokeOpacity,r*=n.opacity,n.stroke instanceof c&&void 0!==n.stroke.color.a&&(r*=n.stroke.color.a),l={},l.opacity=a,l["stroke-opacity"]=r,s.setGState(new t.GState(l)),n.fill&&n.fill instanceof c&&n.fill.color.ok?s.setFillColor(n.fill.color.r,n.fill.color.g,n.fill.color.b):s.setFillColor(0,0,0),s.setLineWidth(n.strokeWidth),n.stroke instanceof c?s.setDrawColor(n.stroke.color.r,n.stroke.color.g,n.stroke.color.b):s.setDrawColor(0,0,0),s.setLineCap(n.strokeLinecap),s.setLineJoin(n.strokeLinejoin),n.strokeDasharray?s.setLineDashPattern(n.strokeDasharray,n.strokeDashoffset):s.setLineDashPattern([],0),s.setLineMiterLimit(n.strokeMiterlimit),i=g.hasOwnProperty(n.fontFamily)?g[n.fontFamily]:n.fontFamily,n.fill&&n.fill instanceof c&&n.fill.color.ok?(d=n.fill.color,s.setTextColor(d.r,d.g,d.b)):s.setTextColor(0,0,0),o="","bold"===n.fontWeight&&(o="bold"),"italic"===n.fontStyle&&(o+="italic"),""===o&&(o="normal"),void 0!==i||void 0!==o?(void 0===i&&(i=g.hasOwnProperty(n.fontFamily)?g[n.fontFamily]:n.fontFamily),s.setFont(i,o)):s.setFont("helvetica",o),s.setFontSize(n.fontSize*s.internal.scaleFactor)}(r=new y(e.pdf,{refsHandler:e.refsHandler,styleSheets:e.styleSheets,viewport:e.viewport,svg2pdfParameters:e.svg2pdfParameters,textMeasure:e.textMeasure})),s=0,o=this.children,i.label=1;case 1:return s<o.length?[4,o[s].render(r)]:[3,4];case 2:i.sent(),i.label=3;case 3:return s++,[3,1];case 4:return e.pdf.endFormObject(this.element.getAttribute("id")),[2]}})})},n.prototype.getBoundingBoxCore=function(){var t,n=this.element.getAttribute("viewBox");return n&&(t=l(n)),[t&&t[0]||0,t&&t[1]||0,t&&t[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),t&&t[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},n.prototype.computeNodeTransformCore=function(e){var t,i,n=parseFloat(this.element.getAttribute("refX")||"0"),s=parseFloat(this.element.getAttribute("refY")||"0"),o=this.element.getAttribute("viewBox");return o?(i=l(o),t=z(this.element,i,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),e,!0),t=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,-n,-s),t)):t=e.pdf.Matrix(1,0,0,1,-n,-s),t},n.prototype.isVisible=function(e,t){return v(this,e,t)},n}(k),rt=function(e){function t(t,n){return e.call(this,t,n)||this}return s(t,e),t.prototype.getR=function(e){var t;return null!==(t=this.r)&&void 0!==t?t:this.r=parseFloat(n(this.element,e.styleSheets,"r")||"0")},t.prototype.getRx=function(e){return this.getR(e)},t.prototype.getRy=function(e){return this.getR(e)},t}(_e),ct=function(e){function t(t,n){return e.call(this,!1,t,n)||this}return s(t,e),t}(ve),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.renderCore=function(e){return o(this,void 0,void 0,function(){var t,n;return i(this,function(s){switch(s.label){case 0:t=0,n=this.children,s.label=1;case 1:return t<n.length?[4,n[t].render(e)]:[3,4];case 2:s.sent(),s.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},t.prototype.getBoundingBoxCore=function(e){return G(e,this)},t}(he),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.isVisible=function(e,t){return v(this,e,t)},t.prototype.render=function(t){return o(this,void 0,void 0,function(){var s,o,a,r,c;return i(this,function(i){switch(i.label){case 0:return this.isVisible("hidden"!==t.attributeState.visibility,t)?(r=this.getX(t),c=this.getY(t),o=this.getWidth(t),a=this.getHeight(t),t.pdf.saveGraphicsState(),s=t.transform,this.element.hasAttribute("transform")&&(s=t.pdf.matrixMult(N(this.element.getAttribute("transform"),t),s)),t.pdf.setCurrentTransformationMatrix(s),t.withinUse||"visible"===n(this.element,t.styleSheets,"overflow")||t.pdf.rect(r,c,o,a).clip().discardPath(),[4,e.prototype.render.call(this,t.clone({transform:t.pdf.unitMatrix,viewport:t.withinUse?t.viewport:new L(o,a)}))]):[2];case 1:return i.sent(),t.pdf.restoreGraphicsState(),[2]}})})},t.prototype.computeNodeTransform=function(e){return this.computeNodeTransformCore(e)},t.prototype.computeNodeTransformCore=function(e){if(e.withinUse)return e.pdf.unitMatrix;var t,i,a,n=this.getX(e),s=this.getY(e),o=this.getViewBox();return o?(i=this.getWidth(e),a=this.getHeight(e),t=z(this.element,o,n,s,i,a,e)):t=e.pdf.Matrix(1,0,0,1,n,s),t},t.prototype.getWidth=function(e){if(void 0!==this.width)return this.width;var t,s,o,a,i=e.svg2pdfParameters;return this.isOutermostSvg(e)?null!=i.width?t=i.width:(s=n(this.element,e.styleSheets,"width"))?t=parseFloat(s):(o=this.getViewBox(),o&&(null!=i.height||n(this.element,e.styleSheets,"height"))?(a=o[2]/o[3],t=this.getHeight(e)*a):t=Math.min(300,e.viewport.width,2*e.viewport.height)):t=(s=n(this.element,e.styleSheets,"width"))?parseFloat(s):e.viewport.width,this.width=t},t.prototype.getHeight=function(e){if(void 0!==this.height)return this.height;var t,s,o,a,i=e.svg2pdfParameters;return this.isOutermostSvg(e)?null!=i.height?t=i.height:(s=n(this.element,e.styleSheets,"height"))?t=parseFloat(s):(o=this.getViewBox(),o?(a=o[2]/o[3],t=this.getWidth(e)/a):t=Math.min(150,e.viewport.width/2,e.viewport.height)):t=(s=n(this.element,e.styleSheets,"height"))?parseFloat(s):e.viewport.height,this.height=t},t.prototype.getX=function(e){if(void 0!==this.x)return this.x;if(this.isOutermostSvg(e))return this.x=0;var t=n(this.element,e.styleSheets,"x");return this.x=t?parseFloat(t):0},t.prototype.getY=function(e){if(void 0!==this.y)return this.y;if(this.isOutermostSvg(e))return this.y=0;var t=n(this.element,e.styleSheets,"y");return this.y=t?parseFloat(t):0},t.prototype.getViewBox=function(){if(void 0!==this.viewBox)return this.viewBox;var e=this.element.getAttribute("viewBox");return this.viewBox=e?l(e):void 0},t.prototype.isOutermostSvg=function(e){return e.svg2pdfParameters.element===this.element},t}(ge),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.isVisible=function(e,t){return v(this,e,t)},t.prototype.computeNodeTransformCore=function(e){return e.pdf.unitMatrix},t}(ge),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.apply=function(e){return o(this,void 0,void 0,function(){var t,n,s;return i(this,function(o){switch(o.label){case 0:if(!this.isVisible(!0,e))return[2];n=e.pdf.matrixMult(this.computeNodeTransform(e),e.transform),e.pdf.setCurrentTransformationMatrix(n),t=0,s=this.children,o.label=1;case 1:return t<s.length?[4,s[t].render(new y(e.pdf,{refsHandler:e.refsHandler,styleSheets:e.styleSheets,viewport:e.viewport,withinClipPath:!0,svg2pdfParameters:e.svg2pdfParameters,textMeasure:e.textMeasure}))]:[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return e.pdf.clip().discardPath(),e.pdf.setCurrentTransformationMatrix(n.inversed()),[2]}})})},t.prototype.getBoundingBoxCore=function(e){return G(e,this)},t.prototype.isVisible=function(e,t){return v(this,e,t)},t}(k);function ne(e,t){var n,o,s=[];switch(function(e,t){for(var o,s=[],n=0;n<e.childNodes.length;n++)o=e.childNodes[n],"#"!==o.nodeName.charAt(0)&&s.push(o);for(n=0;n<s.length;n++)t(n,s[n])}(e,function(e,n){return s.push(ne(n,t))}),e.tagName.toLowerCase()){case"a":case"g":n=new ut(e,s);break;case"circle":n=new rt(e,s);break;case"clippath":n=new ht(e,s);break;case"ellipse":n=new Ke(e,s);break;case"lineargradient":n=new me(e,s);break;case"image":n=new nt(e,s);break;case"line":n=new lt(e,s);break;case"marker":n=new at(e,s);break;case"path":n=new et(e,s);break;case"pattern":n=new ie(e,s);break;case"polygon":n=new ot(e,s);break;case"polyline":n=new ct(e,s);break;case"radialgradient":n=new le(e,s);break;case"rect":n=new Ye(e,s);break;case"svg":n=new dt(e,s);break;case"symbol":n=new oe(e,s);break;case"text":n=new Pe(e,s);break;case"use":n=new Qe(e,s);break;default:n=new it(e,s)}return t!=null&&n.element.hasAttribute("id")&&(o=Z(n.element.id,{isIdentifier:!0}),t[o]=t[o]||n),n.children.forEach(function(e){return e.setParent(n)}),n}var re=function(e){var n,o,t=e,s={a:0,b:0,c:0},i=[];return n=function(n,o){var a,r,c,l,d,u;if(n.test(t))for(a=0,u=(d=t.match(n)).length;a<u;a+=1)s[o]+=1,r=d[a],l=t.indexOf(r),c=r.length,i.push({selector:e.substr(l,c),type:o,index:l,length:c}),t=t.replace(r,Array(c+1).join(" "))},(o=function(e){var n,s,o,i;if(e.test(t))for(n=0,i=(o=t.match(e)).length;n<i;n+=1)s=o[n],t=t.replace(s,Array(s.length+1).join("A"))})(/\\[0-9A-Fa-f]{6}\s?/g),o(/\\[0-9A-Fa-f]{1,5}\s/g),o(/\\./g),function(){var e,n,s,o,i=/{[^]*/gm;if(i.test(t))for(e=0,o=(s=t.match(i)).length;e<o;e+=1)n=s[e],t=t.replace(n,Array(n.length+1).join(" "))}(),n(/(\[[^\]]+\])/g,"b"),n(/(#[^#\s+>~.[:)]+)/g,"a"),n(/(\.[^\s+>~.[:)]+)/g,"b"),n(/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,"c"),n(/(:(?!not|global|local)[\w-]+\([^)]*\))/gi,"b"),n(/(:(?!not|global|local)[^\s+>~.[:]+)/g,"b"),t=(t=(t=(t=(t=(t=t.replace(/[*\s+>~]/g," ")).replace(/[#.]/g," ")).replace(/:not/g,"    ")).replace(/:local/g,"      ")).replace(/:global/g,"       ")).replace(/[()]/g," "),n(/([^\s+>~.[:]+)/g,"c"),i.sort(function(e,t){return e.index-t.index}),{selector:e,specificity:"0,"+s.a.toString()+","+s.b.toString()+","+s.c.toString(),specificityArray:[0,s.a,s.b,s.c],parts:i}},pt=function(){function e(e,t){this.rootSvg=e,this.loadExternalSheets=t,this.styleSheets=[]}return e.prototype.load=function(){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=t.sent(),this.parseCssSheets(e),[2]}})})},e.prototype.collectStyleSheetTexts=function(){return o(this,void 0,void 0,function(){var t,n,s,o,a;return i(this,function(i){switch(i.label){case 0:if(s=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(t=0;t<this.rootSvg.ownerDocument.childNodes.length;t++)"xml-stylesheet"===(o=this.rootSvg.ownerDocument.childNodes[t]).nodeName&&"string"==typeof o.data&&s.push(e.loadSheet(o.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(a=this.rootSvg.querySelectorAll("style,link"),t=0;t<a.length;t++)j(n=a[t],"style")?s.push(n.textContent):this.loadExternalSheets&&j(n,"link")&&"stylesheet"===n.getAttribute("rel")&&n.hasAttribute("href")&&s.push(e.loadSheet(n.getAttribute("href")));return[4,Promise.all(s)];case 1:return[2,i.sent().filter(function(e){return null!==e})]}})})},e.prototype.parseCssSheets=function(t){for(var n,s,o,i,c,u,l=document.implementation.createHTMLDocument(""),r=0,d=t;r<d.length;r++)if(u=d[r],i=l.createElement("style"),i.textContent=u,l.body.appendChild(i),n=i.sheet,n instanceof CSSStyleSheet){for(s=n.cssRules.length-1;s>=0;s--)if(c=n.cssRules[s],c instanceof CSSStyleRule){if(o=c,o.selectorText.indexOf(",")>=0){n.deleteRule(s);for(var m=o.cssText.substring(o.selectorText.length),h=e.splitSelectorAtCommas(o.selectorText),a=0;a<h.length;a++)n.insertRule(h[a]+m,s+a)}}else n.deleteRule(s);this.styleSheets.push(n)}},e.splitSelectorAtCommas=function(e){for(var s,n=/,|["']/g,c=/[^\\]["]/g,l=/[^\\][']/g,i=[],a="initial",r=-1,o=c,t=0;t<e.length;)switch(a){case"initial":n.lastIndex=t,(s=n.exec(e))?(","===s[0]?(i.push(e.substring(r+1,n.lastIndex-1).trim()),r=n.lastIndex-1):(a="withinQuotes",o='"'===s[0]?c:l),t=n.lastIndex):(i.push(e.substring(r+1).trim()),t=e.length);break;case"withinQuotes":o.lastIndex=t,(s=o.exec(e))&&(t=o.lastIndex,a="initial")}return i},e.loadSheet=function(e){return new Promise(function(t,n){var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="text",s.onload=function(){200!==s.status&&n(new Error("Error "+s.status+": Failed to load '"+e+"'")),t(s.responseText)},s.onerror=n,s.onabort=n,s.send(null)}).catch(function(){return null})},e.prototype.getPropertyValue=function(e,t){for(var n,s,a,c,o=[],i=0,r=this.styleSheets;i<r.length;i++)for(a=r[i],n=0;n<a.cssRules.length;n++)s=a.cssRules[n],s.style.getPropertyValue(t)&&e.matches(s.selectorText)&&o.push(s);if(0!==o.length)return c=function(e,n){var s=e.style.getPropertyPriority(t);return s!==n.style.getPropertyPriority(t)?"important"===s?1:-1:function(e,t){var n,s,o;if("string"==typeof e){if(-1!==e.indexOf(","))throw"Invalid CSS selector";s=re(e).specificityArray}else{if(!Array.isArray(e))throw"Invalid CSS selector or specificity array";if(4!==e.filter(function(e){return"number"==typeof e}).length)throw"Invalid specificity array";s=e}if("string"==typeof t){if(-1!==t.indexOf(","))throw"Invalid CSS selector";o=re(t).specificityArray}else{if(!Array.isArray(t))throw"Invalid CSS selector or specificity array";if(4!==t.filter(function(e){return"number"==typeof e}).length)throw"Invalid specificity array";o=t}for(n=0;n<4;n+=1){if(s[n]<o[n])return-1;if(s[n]>o[n])return 1}return 0}(e.selectorText,n.selectorText)},o.reduce(function(e,t){return 1===c(e,t)?e:t}).style.getPropertyValue(t)||void 0},e}(),gt=function(){function e(){this.measureMethods={}}return e.prototype.getTextOffset=function(e,t){if(n=t.textAnchor,"start"===n)return 0;var n,o=this.measureTextWidth(e,t),s=0;switch(n){case"end":s=o;break;case"middle":s=o/2}return s},e.prototype.measureTextWidth=function(e,t){if(0===e.length)return 0;var n=t.fontFamily;return this.getMeasureFunction(n).call(this,e,t.fontFamily,t.fontSize+"px",t.fontStyle,t.fontWeight)},e.prototype.getMeasurementTextNode=function(){if(!this.textMeasuringTextElement){this.textMeasuringTextElement=document.createElementNS("http://www.w3.org/2000/svg","text");var e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.appendChild(this.textMeasuringTextElement),e.style.setProperty("position","absolute"),e.style.setProperty("visibility","hidden"),document.body.appendChild(e)}return this.textMeasuringTextElement},e.prototype.canvasTextMeasure=function(e,t,n,s,o){var i=document.createElement("canvas").getContext("2d");return i!=null?(i.font=[s,o,n,t].join(" "),i.measureText(e).width):0},e.prototype.svgTextMeasure=function(e,t,n,s,o,i){void 0===i&&(i=this.getMeasurementTextNode());var a=i;return a.setAttribute("font-family",t),a.setAttribute("font-size",n),a.setAttribute("font-style",s),a.setAttribute("font-weight",o),a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),a.textContent=e,a.getBBox().width},e.prototype.getMeasureFunction=function(t){if(n=this.measureMethods[t],!n){var n,s=this.canvasTextMeasure(e.testString,t,"16px","normal","normal"),o=this.svgTextMeasure(e.testString,t,"16px","normal","normal");n=Math.abs(s-o)<e.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[t]=n}return n},e.prototype.cleanupTextMeasuring=function(){if(this.textMeasuringTextElement){var e=this.textMeasuringTextElement.parentNode;e&&document.body.removeChild(e),this.textMeasuringTextElement=void 0}},e.testString=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!"$%&/()=?'\\+*-_.:,;^}][{#~|<>`,e.epsilon=.1,e}();function ae(e,t,n){var s,a,r;return void 0===n&&(n={}),o(this,void 0,void 0,function(){var o,c,l,d,u,h,m,f,p,g,v;return i(this,function(i){switch(i.label){case 0:return l=null!==(s=n.x)&&void 0!==s?s:0,d=null!==(a=n.y)&&void 0!==a?a:0,u=null!==(r=n.loadExternalStyleSheets)&&void 0!==r&&r,m=new q(h={}),[4,(f=new pt(e,u)).load()];case 1:return i.sent(),p=new L(t.internal.pageSize.getWidth(),t.internal.pageSize.getHeight()),g=D(D({},n),{element:e}),v=new gt,o=new y(t,{refsHandler:m,styleSheets:f,viewport:p,svg2pdfParameters:g,textMeasure:v}),t.advancedAPI(),t.saveGraphicsState(),t.setCurrentTransformationMatrix(t.Matrix(1,0,0,1,l,d)),t.setLineWidth(o.attributeState.strokeWidth),c=o.attributeState.fill.color,t.setFillColor(c.r,c.g,c.b),t.setFont(o.attributeState.fontFamily),t.setFontSize(o.attributeState.fontSize*t.internal.scaleFactor),[4,ne(e,h).render(o)];case 2:return i.sent(),t.restoreGraphicsState(),t.compatAPI(),o.textMeasure.cleanupTextMeasuring(),[2,t]}})})}t.jsPDF.API.svg=function(e,t){return void 0===t&&(t={}),ae(e,this,t)},e.svg2pdf=ae,Object.defineProperty(e,"__esModule",{value:!0})})