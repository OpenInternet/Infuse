<!doctype html><html class="h-full bg-gray-50" lang=ar dir=rtl itemscope itemtype=http://schema.org/WebPage><head><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta name=author content><meta name=description content="Infuse is a community-developed framework helping digital protectors advance their knowledge and skill sets in areas of specialized technical expertise (STE)"><meta name=keywords content="NGO,cybersecurity,digital security,malware,phishing,web security,OWASP"><meta name=robots content="noodp"><meta name=theme-color content="#16B364"><link rel=canonical href=https://infusedev.safetag.org/ar/learning-path/4/module-2/><link rel=alternate hreflang=en href=https://infusedev.safetag.org/en/learning-path/4/module-2/ title=English><link rel=alternate hreflang=fr href=https://infusedev.safetag.org/fr/learning-path/4/module-2/ title=French><link rel=alternate hreflang=es href=https://infusedev.safetag.org/es/learning-path/4/module-2/ title=Spanish><title>Data Validation :: Infuse
</title><link rel=stylesheet href=https://infusedev.safetag.org/style.082e831396da89abe1c9bee47835482c4e198211eac4f5c27d08d2203e5b083a.css><link rel=apple-touch-icon href=https://infusedev.safetag.org/favicons/apple-touch-icon.png><link rel=mask-icon href=https://infusedev.safetag.org/favicons/safari-pinned-tab.svg color=#194E80><link rel=icon href=https://infusedev.safetag.org/favicons/favicon.svg><meta itemprop=name content="Data Validation"><meta itemprop=description content="We look at a very common class of vulnerabilities, in which a website parses maliciously crafted data submitted by a user"><meta itemprop=dateModified content="2024-11-27T19:09:49+01:00"><meta itemprop=wordCount content="3769"><meta itemprop=image content="https://infusedev.safetag.org/media/images/thumbnail.png"><meta property="og:url" content="https://infusedev.safetag.org/ar/learning-path/4/module-2/"><meta property="og:site_name" content="Infuse"><meta property="og:title" content="Data Validation"><meta property="og:description" content="We look at a very common class of vulnerabilities, in which a website parses maliciously crafted data submitted by a user"><meta property="og:locale" content="ar"><meta property="og:type" content="article"><meta property="article:section" content="learning-path"><meta property="article:modified_time" content="2024-11-27T19:09:49+01:00"><meta property="og:image" content="https://infusedev.safetag.org/media/images/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://infusedev.safetag.org/media/images/thumbnail.png"><meta name=twitter:title content="Data Validation"><meta name=twitter:description content="We look at a very common class of vulnerabilities, in which a website parses maliciously crafted data submitted by a user"></head><body class="flex flex-col"><a class="sr-only focus:not-sr-only" href=#content>التخطي إلى المحتوى</a><header><nav aria-label=Global><div class="mx-auto max-w-7xl px-6 lg:px-8" x-data="{ open: false }"><div class="relative flex h-16 items-center justify-between"><div class="flex items-center lg:hidden"><button type=button :aria-expanded=open.toString() @click="open = !open" class="relative inline-flex items-center justify-center rounded-md p-2 text-gray-600 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-gray-600" aria-controls=mobile-menu aria-expanded=false>
<span class="absolute -inset-0.5"></span>
<span class=sr-only>Open main menu</span><svg x-show="!open" class="block size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/></svg><svg x-show="open" class="block size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class="flex flex-1 lg:justify-start justify-center items-center gap-x-12"><a href=https://infusedev.safetag.org/ar/ class="-m-1.5 p-1.5"><span class=sr-only>Infuse</span>
<img class="h-8 w-auto" src=https://infusedev.safetag.org/media/images/infuse-logo.svg alt="Infuse logo"></a><div class="hidden lg:flex lg:gap-x-12"><div class="hidden lg:flex lg:gap-x-6"><a href=https://infusedev.safetag.org/ar/about/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>حول Infuse</a>
<a href=https://infusedev.safetag.org/ar/how/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>كيف يعمل</a>
<a href=https://infusedev.safetag.org/ar/contribute/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>المساهمة</a>
<a href=https://infusedev.safetag.org/ar/community/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>Community</a>
<a href=https://infusedev.safetag.org/ar/badge-descriptions/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false></a></div></div></div><div class="flex items-center justify-end px-2 lg:ms-6"><div class=lg:max-w-56><a aria-label=بحث href=https://infusedev.safetag.org/ar/search class="block w-full rounded-full border-2 border-transparent p-2 text-gray-900 hover:border-green-700 focus:ring-2 focus:ring-inset focus:ring-green-700"><svg class="h-5 w-5 text-gray-500 hover:text-gray-700" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path stroke-width="1" stroke="currentcolor" fill-rule="evenodd" d="M9 3.5a5.5 5.5.0 100 11 5.5 5.5.0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75.0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"/></svg></a></div></div><div id=languageSwitcher aria-label="Language switcher" class="ms-1 flex justify-end lg:flex-grow-0"><div class=relative x-data="{ dropdown: false }"><button type=button class="-m-1.5 flex items-center p-1.5" id=language-switcher-button aria-expanded=false aria-haspopup=true x-on:click="dropdown = true">
<span class=sr-only>فتح قائمة اللغات</span>
<span class="flex items-center"><svg xmsns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="ms-2 h-5 w-5 text-gray-500" fill="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004.0 008.716-6.747M12 21a9.004 9.004.0 01-8.716-6.747M12 21c2.485.0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485.0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997.0 017.843 4.582M12 3A8.997 8.997.0 004.157 7.582m15.686.0A11.953 11.953.0 0112 10.5c-2.998.0-5.74-1.1-7.843-2.918m15.686.0A8.959 8.959.0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919.0 0112 16.5c-3.162.0-6.133-.815-8.716-2.247m0 0A9.015 9.015.0 013 12c0-1.605.42-3.113 1.157-4.418"/></svg>
<span class="ms-2 hidden text-sm font-semibold leading-6 text-gray-900 lg:block" aria-hidden=true>Arabic (coming soon)</span></svg></span></button><div x-show="dropdown === true" @click.outside="dropdown = false" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="absolute right-0 z-10 mt-2.5 w-max origin-top-center rounded-md bg-white py-2 shadow-lg ring-1 ring-gray-900/5 focus:outline-none" role=menu aria-orientation=vertical aria-labelledby=user-menu-button tabindex=-1><a title=English href=https://infusedev.safetag.org/en/learning-path/4/module-2/ class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1>English</a>
<a title=French href=https://infusedev.safetag.org/fr/learning-path/4/module-2/ class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1>French</a>
<a title=Spanish href=https://infusedev.safetag.org/es/learning-path/4/module-2/ class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1>Spanish</a></div></div></div><div id=userProfile class="ms-8 hidden"><div class=relative x-data="{ dropdown: false }"><button type=button class="-m-1.5 flex items-center p-1.5" id=user-menu-button aria-expanded=false aria-haspopup=true x-on:click="dropdown = true">
<span class=sr-only>فتح قائمة المستخدم</span>
<img id=avatarImage class="h-7 w-7 rounded-full object-cover" src=https://infusedev.safetag.org/media/images/user-pfp.svg alt="User profile photo">
<span class="hidden lg:flex lg:items-center"><span id=userLabel class="ms-2 text-sm font-semibold leading-6 text-gray-900" aria-hidden=true>تسجيل الدخول</span><svg class="ms-2 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></button><div x-show="dropdown === true" @click.outside="dropdown = false" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="absolute right-0 z-10 mt-2.5 w-max origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-gray-900/5 focus:outline-none" role=menu aria-orientation=vertical aria-labelledby=user-menu-button tabindex=-1><a href=https://infusedev.safetag.org/ar/profile class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1 id=user-menu-item-0>ملفك الشخصي</a>
<a href=https://infusedev.safetag.org/ar/badges class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1 id=user-menu-item-0>شارات</a>
<a id=logoutButton href=# class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1 id=user-menu-item-1>تسجيل الخروج</a></div></div></div><div id=signupButtonCTA class="ms-8 hidden"><a href=https://infusedev.safetag.org/ar/signup class="rounded-md bg-green-700 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-green-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-700">الاشتراك</a></div><div id=loginButtonCTA class="ms-2 hidden"><a id=signupButtonCTA href=https://infusedev.safetag.org/ar/login class="hidden rounded-md bg-white px-5 py-2.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 lg:block">تسجيل الدخول</a></div></div><div class=lg:hidden id=mobile-menu x-show=open x-cloak><div class="space-y-1 pb-3 pt-2"><a href=https://infusedev.safetag.org/ar/about/ class="block rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-800" aria-current=false>حول Infuse</a>
<a href=https://infusedev.safetag.org/ar/how/ class="block rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-800" aria-current=false>كيف يعمل</a>
<a href=https://infusedev.safetag.org/ar/contribute/ class="block rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-800" aria-current=false>المساهمة</a>
<a href=https://infusedev.safetag.org/ar/community/ class="block rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-800" aria-current=false>Community</a>
<a href=https://infusedev.safetag.org/ar/badge-descriptions/ class="block rounded-md px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-800" aria-current=false></a></div></div></div></nav></header><main id=content class="content mb-auto"><section id=breadcrumb class="mx-auto max-w-7xl px-8 pt-8 lg:px-8 lg:pt-16"><nav class="mb-5 flex justify-start" aria-label=Breadcrumb><ol role=list class="flex items-center" itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://infusedev.safetag.org/ar/ class="text-gray-500 hover:text-gray-700"><span itemprop=name><svg class="me-4 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="none" aria-hidden="true"><path d="M6.66667 14.1668H13.3333M9.18141 2.30345 3.52949 6.69939C3.15168 6.99324 2.96278 7.14017 2.82669 7.32417 2.70614 7.48716 2.61633 7.67078 2.56169 7.866 2.5 8.08639 2.5 8.3257 2.5 8.80433V14.8334c0 .9335.0 1.4002.18166 1.7567C2.84144 16.9037 3.09641 17.1587 3.41002 17.3185c.35652.1816.82323.1816 1.75665.1816H14.8333c.9335.0 1.4002.0 1.7567-.1816C16.9036 17.1587 17.1586 16.9037 17.3183 16.5901 17.5 16.2336 17.5 15.7669 17.5 14.8334V8.80433C17.5 8.3257 17.5 8.08639 17.4383 7.866 17.3837 7.67078 17.2939 7.48716 17.1733 7.32417 17.0372 7.14017 16.8483 6.99324 16.4705 6.69939L10.8186 2.30345c-.2928-.22771-.4392-.34156-.6008-.38533C10.0752 1.87951 9.92484 1.87951 9.78221 1.91812 9.62057 1.96189 9.47418 2.07574 9.18141 2.30345z" stroke="#667085" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/></svg>
<span class=sr-only>الرئيسية</span>
</span></a><meta itemprop=position content='1'></li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><div class="flex items-center"><svg class="h-5 w-5 flex-shrink-0 text-gray-500 lg:flex" fill="currentcolor" viewBox="0 0 20 20" aria-hidden="true"><path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z"/></svg>
<a class="me-2 ms-3 text-sm font-medium text-gray-500 underline hover:text-gray-700 hover:no-underline" aria-current=page itemprop=item href=https://infusedev.safetag.org/ar/learning-path/><span itemprop=name>Learning Paths</span>
</a><meta itemprop=position content='2'></div></li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><div class="flex items-center"><svg class="h-5 w-5 flex-shrink-0 text-gray-500 lg:flex" fill="currentcolor" viewBox="0 0 20 20" aria-hidden="true"><path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z"/></svg>
<a class="me-2 ms-3 text-sm font-medium text-gray-500 underline hover:text-gray-700 hover:no-underline" aria-current=page itemprop=item href=https://infusedev.safetag.org/ar/learning-path/4/><span itemprop=name>Web Application Security Fundamentals</span>
</a><meta itemprop=position content='3'></div></li><li class="hidden lg:flex" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><div class="flex items-center"><svg class="h-5 w-5 flex-shrink-0 text-gray-500 underline" fill="currentcolor" viewBox="0 0 20 20" aria-hidden="true"><path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z"/></svg>
<a class="text-sm font-medium text-gray-500 underline hover:text-gray-700 hover:no-underline sm:ms-2" aria-current=page itemprop=item href=https://infusedev.safetag.org/ar/learning-path/4/module-2/><span itemprop=name>Data Validation</span>
</a><meta itemprop=position content='4'></div></li></ol></nav></section><div class="relative flex flex-col justify-center py-6 sm:px-6 lg:px-8 lg:py-12"><section class="prose prose-stone mx-auto w-full max-w-3xl flex-col px-8 prose-hr:w-full lg:flex lg:items-center lg:justify-between lg:px-8"><article class="flex w-full flex-col items-start justify-between border-b border-gray-300"><p class="mb-1 text-sm text-gray-500">وحدة 2</p><h1 class="mb-0 text-3xl font-semibold text-gray-900">Data Validation</h1><div class="w-full items-center justify-between lg:flex"><p class="me-2 inline-flex text-sm font-semibold text-green-900">آخر تحديث في: 27 نوفمبر 2024</p><a id=githubEdit href=https://github.com/OpenInternet/Infusedev/blob/main/content/learning-path/4/module-2.ar.md target=_blank rel="noopener noreferrer" class="mb-5 me-6 inline-flex items-center text-sm font-semibold text-green-800 underline hover:text-green-900 hover:no-underline sm:mb-0 lg:mb-0 lg:me-0"><svg class="me-2 h-5 w-5" role="img" viewBox="0 0 24 24"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" fill="currentcolor"/></svg> تعديل هذه الصفحة على GitHub
</a><button id=printButton class="mb-5 inline-flex items-center text-sm font-semibold text-green-800 underline hover:text-green-900 hover:no-underline sm:mb-0 lg:mb-0">
<svg class="me-2 h-5 w-5" role="img" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke="currentcolor"><title>Print</title><path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415.0 0110.56.0m-10.56.0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125.0 01-1.12 1.227H7.231c-.662.0-1.18-.568-1.12-1.227L6.34 18m11.318.0h1.091A2.25 2.25.0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055.0 00-1.913-.247M6.34 18H5.25A2.25 2.25.0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041.0 011.913-.247m10.5.0a48.536 48.536.0 00-10.5.0m10.5.0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621.0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"/></svg> الطباعة بصيغة PDF</button></div></article><article class="relative flex w-full flex-col items-start justify-between"><div class="w-full visited:prose-a:text-purple-800"><h2 id=حالة-استخدام>حالة استخدام <a aria-label=#حالة-استخدام href=#حالة-استخدام class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>تتعلق فئة شائعة من الثغرات في تطبيقات الويب بالطريقة التي يعالج بها التطبيق البيانات التي يقدمها مستخدمو الموقع، ويكثر استخدام فئة الثغرات الأمنية هذه من قبل المهاجمين للتحكم بالكامل بمواقع الويب المستهدفة، وغالبًا ما يمكن اكتشافها عبر التقنيات الآلية. يُعدّ فهم آليات ثغرات التحقق من صحة البيانات مفيدًا للغاية أيضًا لتوضيح مواضيع الأمان المعقدة.</p><h2 id=الأهداف>الأهداف <a aria-label=#الأهداف href=#الأهداف class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>بعد استكمال هذا الموضوع الفرعي، يجب أن يكون الممارسون قادرين على القيام بما يلي:
فهم الأنواع الشائعة من ثغرات التحقق من صحة البيانات
فهم الآثار المحتملة لهذه الأنواع من الثغرات
فهم آليات عمل هذه الثغرات
فهم كيفية منع ثغرات هذه بشكل عام</p><hr><h2 id=العرض>العرض <a aria-label=#العرض href=#العرض class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>تشمل الفئة الأولى من الثغرات الأمنية الخاصة بتطبيقات الويب تلك المتعلقة بالتحقق من صحة البيانات، وهناك العديد من الأنواع المختلفة من ثغرات التحقق من صحة البيانات ويمكن أن تحدث في أي نظام يعالج الإدخال. بشكل عام تحدث هذه الثغرات عندما يفترض التطبيق ضمنًا أمورًا حول طول و/أو محتوى البيانات التي يتم إرسالها، وعند استلام المدخلات و/أو معالجتها &ldquo;تُفلت&rdquo; البيانات من سياقها المقصود وتصبح رمزًا في سياقها الجديد. وسنتحدث عن كيفية نجاح ذلك وعواقبه وكيفية إصلاح الثغرة الأمنية لكل نوع محدد، وتأكد من أن تقرأ بالترتيب لأن جميع الأقسام مرتبطة بالأقسام التي تسبقها.</p><h3 id=البرمجة-النصية-عبر-المواقع-cross-site-scripting-أو-xss>البرمجة النصية عبر المواقع (Cross site scripting أو XSS) <a aria-label=#البرمجة-النصية-عبر-المواقع-cross-site-scripting-أو-xss href=#البرمجة-النصية-عبر-المواقع-cross-site-scripting-أو-xss class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>يأتي اسم &ldquo;البرمجة النصية عبر المواقع&rdquo; من طريقة عمل العمليات السابقة لاستغلال ثغرات البرمجة النصية عبر المواقع، ومن المرجح أن اسم &ldquo;حقن جافا سكريبت&rdquo; أفضل لوصفها ولكن الاسم القديم يبقى لأسباب تاريخية. تحدث البرمجة النصية عبر المواقع عندما يفسر المتصفح إدخال المستخدم على أنه جافا سكريبت، ويسمح هذا للمهاجم إلى حد ما بالتحكم في متصفح الويب الخاص بالشخص المستهدف في سياق موقع الويب المستهدف. يمكن للمهاجم سرقة ملفات تعريف الارتباط الخاصة بالشخص المستهدف مما يسمح للمهاجم بانتحال شخصيته على الموقع. بالإضافة إلى ذلك، يمكن للمهاجم استخراج أي من بيانات الشخص المستهدف تلقائيًا من موقع الويب المستهدف ويمكنه بالمثل تنفيذ إجراءات على الموقع المستهدف مثل المستخدم. وأخيرًا يمكن للمهاجم تغيير مظهر موقع الويب للشخص المستهدف على سبيل المثال عرض صفحة إعادة مصادقة مزيفة ترسل بيانات اعتماد المستخدم إلى المهاجم أو تطلب منهم تنزيل برمجيات ضارة يُزعم أنها تأتي من موقع موثوق به.</p><p>في حين أن هذا الهجوم قوي إلاّ أن هناك حدودًا، ويقتصر المهاجم على التحكم في محتوى موقع الويب المستهدف في سياق متصفح المستخدم، ولا يمكن للمهاجم التفاعل مع مواقع الويب الأخرى وتقتصر إجراءاته على ميزات أمان المتصفح.</p><p>يعمل هذا الهجوم من الناحية الميكانيكية من خلال تطبيق ويب يتلقى بيانات المستخدم ثم يدمج بيانات المستخدم هذه مباشرة في صفحة ويب.</p><p>فكر في حالة موقع منتدى مناقشة يسمح للمستخدمين باختيار الاسم المعروض:</p><p><img src=https://infusedev.safetag.org/media/uploads/web_fundamentals_empty_box.png alt="An empty text box on a website where the user can enter text input, with a clickable button labeled &ldquo;Submit&rdquo; underneath"></p><p>تحتوي صفحة الويب غير الفاخرة هذه على رمز لغة تمييز النص التشعبي التالي:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;&lt;<span style=color:#f92672>body</span>&gt;&lt;<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>  Name: &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;disp_name&#34;</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>عندما يتلقى اسمًا من المستخدم فإنه يعرضه في النموذج:</p><p><img src=https://infusedev.safetag.org/media/uploads/web_fundamentals_Alice_box.png alt="The same text box, but now it has the text &ldquo;Alice&rdquo; in it"></p><p>باستخدام لغة تمييز النص التشعبي التالية:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;&lt;<span style=color:#f92672>body</span>&gt;&lt;<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>  Name: &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;disp_name&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Alice&#34;</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>تبدو الأمور على خير حتى الآن، ولكن ماذا سيحدث إذا أدخل المستخدم بعض المدخلات الأكثر صعوبة، مثل:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>Alice&#34;&gt;&lt;<span style=color:#f92672>script</span>&gt;<span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;Owned by Alice&#34;</span>)&lt;/<span style=color:#f92672>script</span>&gt;&lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>q</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span></span></span></code></pre></div></p><p>عند إنشاء صفحة الويب ستبدو مختلفة بعض الشيء:
<img src=https://infusedev.safetag.org/media/uploads/web_fundamentals_owned_by_Alice_alert.png alt="An alert on a webpage that says &ldquo;owned by Alice&rdquo;"></p><p>كيف حصل ذلك؟
لنستخدم بعض الألوان لتسليط الضوء على ما يحدث، وتذكر أن تطبيق الويب يتعامل فقط مع مدخلات المستخدم كنص وليس لديه أي فكرة عن الألوان.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>Alice&#34;&gt;&lt;<span style=color:#f92672>script</span>&gt;<span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;Owned by Alice&#34;</span>)&lt;/<span style=color:#f92672>script</span>&gt;&lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>q</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span></span></span></code></pre></div><p>يأخذ التطبيق ببساطة المدخلات من المستخدم ويضعها حرفيًا ضمن لغة تمييز النص التشعبي التي يولدها ومن وجهة نظر تطبيق الويب ومتصفح الويب كله مجرد نص غير متمايز.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;&lt;<span style=color:#f92672>body</span>&gt;&lt;<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>  Name: &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;disp_name&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Alice&#34;</span>&gt;&lt;<span style=color:#f92672>script</span>&gt;<span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;Owned by
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Alice&#34;</span>)&lt;/<span style=color:#f92672>script</span>&gt;&lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>q</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>لاحظ &ldquo;> باللون الأحمر. تخبر هذه العلامة المتصفح باكتمال سمة قيمة إدخال لغة تمييز النص التشعبي ووسم الإدخال بعد ذلك. يأتي النص باللون الأزرق بعده على شكل علامة نصية تُشغل جافا سكريبت التي تظهر مربع تنبيه. أخيرًا يُستخدم &lt;i q=&rdquo; لأغراض التنظيف حيث يمنع صفحة الويب من عرض بقايا وسم الإدخال الأصلي، ويمكننا استخدام تمييز وتنسيق ألوان مختلفة لإظهار كيفية تفسير المتصفح لصفحة الويب التي تم إنشاؤها:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;&lt;<span style=color:#f92672>body</span>&gt;&lt;<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>  Name: &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;disp_name&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Alice&#34;</span>&gt;&lt;<span style=color:#f92672>script</span>&gt;<span style=color:#a6e22e>alert</span>(<span style=color:#e6db74>&#34;Owned by
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Alice&#34;</span>)&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>i</span> <span style=color:#a6e22e>q</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div><p>كما هو الحال لا يتسبب مثال البرمجة النصية عبر المواقع هذا بأي شيء ضار والشخص الوحيد المتأثر هو أليس (Alice) نفسها، ولكن إذا تمكنت مهاجمتنا أليس من جعل شخص آخر يرى اسمها المعروض وكانت جافا سكريبت الخاصة بها تتسبب بشيء ضار فسيكون بإمكانها أداء هجوم حقيقي.</p><h4 id=جرب-بنفسك>جرب بنفسك! <a aria-label=#جرب-بنفسك href=#جرب-بنفسك class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>سجّل الدخول إلى دي في دبليو إيه الخاص بك وتأكد من تعيين مستوى الأمان ليكون منخفضًا (انظر قسم &ldquo;الإعداد&rdquo; في مقدمة مسار التعلّم هذا لمزيد من المعلومات). انتقل إلى قسم &ldquo;البرمجة النصية عبر المواقع (المعكوس)&rdquo; سترى أن حقل إدخال “What’s your name?” معرّض لثغرة البرمجة النصية عبر المواقع> جرّب بعدها إدخال اسم يتسبب في ظهور مربع تنبيه جافا سكريبت عند النقر على زر &ldquo;إرسال&rdquo;.</p><p><img src=https://infusedev.safetag.org/media/uploads/web_fundamentals_reflected_XSS_screenshot.png alt="A screenshot of DVWA, with the &ldquo;Vulnerability: Reflected Cross Site Scripting (XSS)&rdquo; page currently loaded"></p><h3 id=الوقاية-من-البرمجة-النصية-عبر-المواقع>الوقاية من البرمجة النصية عبر المواقع <a aria-label=#الوقاية-من-البرمجة-النصية-عبر-المواقع href=#الوقاية-من-البرمجة-النصية-عبر-المواقع class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>وتسمى أفضل تقنية لمنع البرمجة النصية عبر المواقع يمكن استخدامها هي ترميز الإخراج، ولاحظ أنه في المثال أعلاه تم تمكين الهجوم من خلال استخدام المحرفين " و >، حيث تتحكم هذه المحارف في بنية الصفحة في سياق صفحات الويب. في لغة تمييز النص التشعبي يمكن ترميز جميع هذه المحارف بحيث يعرف متصفح الويب أن يعرض اقتباسًا مزدوجًا أو قوس زاوية بدلًا من تعديل بنية الصفحة، وفي هذه الحالة إذا تم ترميز بيانات أليس قبل دمجها في صفحة الويب فسيتم إنشاء لغة تمييز النص التشعبي التالية:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;&lt;<span style=color:#f92672>body</span>&gt;&lt;<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>  Name: &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;disp_name&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Alice&amp;quot;&amp;gt;&amp;lt;script&amp;gt;alert(&amp;quot;Owned by Alice&amp;quot;)&amp;lt;/script&amp;gt;&amp;lt;i q=&amp;quot;&#34;</span>&gt;&lt;<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>والتي من شأنها أن تعرض ما يلي:
<img src=https://infusedev.safetag.org/media/uploads/web_fundamentals_Alice_script_box.png alt="An empty text box form, with a button that says &ldquo;submit&rdquo; below it"></p><p>يعتمد ترميز المخرجات على السياق الذي سيتم فيه استخدام البيانات، وبالنسبة للغة تمييز النص التشعبي يمكنك ترميز كيانات لغة تمييز النص التشعبي في البيانات. أما بالنسبة للبيانات التي سيتم تضمينها في كتلة جافا سكريبت سيتم استخدام ترميز مختلف. في حال كان من المقرر استخدام بيانات المستخدم في استعلام قاعدة بيانات فسيتم استخدام نوع آخر من الترميز، ويجب أن تحتوي أطر الويب والمكتبات على وظائف لأداء ترميز الخرج لك ومن الأفضل (نأمل) استخدام هذه الوظائف المتقدمة بدلًا من محاولة كتابتها بالاستناد إلى المبادئ الأولى.</p><p>لمزيد من المعلومات حول البرمجة النصية عبر المواقع، راجع <a href=https://owasp.org/www-community/attacks/xss/ target=_blank>دليل مشروع أمان تطبيق الويب المفتوح للبرمجة النصية عبر المواقع (XSS)</a> ولأجل دراسة متعمقة راجع<a href=https://infusedev.safetag.org/en/learning-path/5/>مسار تعلّم تقييم أمان تطبيقات الويب.</a></p><h3 id=حقن-لغة-الاستعلامات-البنيوية-sqli>حقن لغة الاستعلامات البنيوية (SQLi) <a aria-label=#حقن-لغة-الاستعلامات-البنيوية-sqli href=#حقن-لغة-الاستعلامات-البنيوية-sqli class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>حيث تسمح البرمجة النصية عبر المواقع لبيانات المستخدم بالخروج من سياقها وتفسيرها على أنها لغة تمييز النص التشعبي وجافا سكريبت في متصفح الويب الخاص بالضحية، يسمح حقن لغة الاستعلامات البنيوية لبيانات المستخدم بالخروج من سياقها وتفسيرها على أنها لغة الاستعلامات البنيوية في قاعدة بيانات تطبيق الويب. وتستخدم معظم تطبيقات الويب قاعدة بيانات خلفية لتخزين البيانات واستردادها، حيث عادة ما تستخدم لغة الاستعلامات البنيوية لتحقيق الوصول إلى البيانات هذا ويمكن أن يحدث حقن لغة الاستعلامات البنيوية عند استكمال بيانات المستخدم في استعلام.</p><p>نظرًا لأن لغة الاستعلامات البنيوية التي يتحكم فيها المهاجم تعمل في بيئة الخادم، فإن ثغرات حقن لغة الاستعلام البنيوية تكون عمومًا أكثر خطورة من البرمجة النصية عبر المواقع. وبينما تسمح ثغرة البرمجة النصية عبر المواقع للمهاجم باستهداف المستخدمين الآخرين ربما من خلال نوع من الانتحال بالهندسة الاجتماعية ويمكن لحقن لغة الاستعلامات البنيوية أن يمنح المهاجم حق الوصول للقراءة والكتابة إلى جميع بيانات المستخدم على الموقع.</p><p>يمكن للمهاجم أيضًا قراءة وكتابة أي بيانات أخرى مخزنة في قاعدة البيانات التي يمكن لتطبيق الويب تقييمها، وفي كثير من الأحيان يمكن للمهاجم استخدام وصول لغة الاستعلامات البنيوية للحصول على القدرة على تشغيل الأوامر على خادم قاعدة البيانات نفسه والوصول بشكل كامل عن بُعد إلى البنية التحتية الخلفية للموقع.</p><p>كيف يعمل حقن لغة الاستعلامات البنيوية؟</p><p>فكر في تطبيق ويب توجد فيه منصة تذاكر تسرد اسم كل أداة ووصفها وإصدارها في فئة، حيث سيقوم المستخدم أيضًا بإرسال معلمة معرف وقد تكون موجودة في عنوان موقع ويب للصفحة التي تقدم الطلب، كما يبدو الكود البرمجية التي تنشئ لغة الاستعلام البنيوية التي تسترد هذه البيانات كما يلي:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>sql</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;select productid, name, description, version from products where categoryid=&#39;</span><span style=color:#f92672>+</span>request_params[<span style=color:#e6db74>&#39;id&#39;</span>]</span></span></code></pre></div><p>عندما يرسل المستخدم معلمة id مثل 1 أو 32 سيكون كل شيء على ما يرام وسنحصل على استعلام مثل:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span> <span style=color:#66d9ef>select</span> toolid, name, description, <span style=color:#66d9ef>version</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>from</span> tools
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>where</span> categoryid<span style=color:#f92672>=</span><span style=color:#ae81ff>32</span></span></span></code></pre></div></p><p>لكن تبدأ المشكلة عندما يرسل مستخدم فضولي استعلام id 2-1 للأرقام 2-1 ويلحظ أنه يحصل على نفس ذات نتائج استعلام id للرقم1:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span> <span style=color:#66d9ef>select</span> toolid, name, description, <span style=color:#66d9ef>version</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>from</span> tools
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>where</span> categoryid<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span></span></span></code></pre></div></p><p>يُوضح هذا للمهاجم أن التطبيق عرضة لحقن لغة الاستعلامات البنيوية، فهو يفسر مدخلاتهم على أنها تعليمة برمجية (تنفيذ التعبير 2-1) بدلًا من بيانات (البحث عن فئة يكون معرفها حرفيًا &ldquo;2-1&rdquo;).</p><p>بعد القليل من البحث يرسلون استعلام id يضم -1 union all select 1, username, password, 1.0 from admin_users وينتج عن ذلك استعلام لغة استعلامات بنيوية تضم:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span> <span style=color:#66d9ef>select</span> toolid, name, description, <span style=color:#66d9ef>version</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>from</span> tools
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>where</span> toolid<span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>union</span> <span style=color:#66d9ef>all</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>select</span> <span style=color:#ae81ff>1</span>, username, password, <span style=color:#ae81ff>1</span>.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>from</span> admin_users</span></span></code></pre></div></p><p>ما يفعله هذا الاستعلام هو البحث عن جميع الأدوات التي تحتوي على معرّف فئة -1 (والذي ربما لا يكون أيًا منها) ثم أضف إلى تلك القائمة أسماء المستخدمين وكلمات المرور للمستخدمين المسؤولين عن منصة التذاكر، ثم يقوم التطبيق بتنسيق هذا بشكل جدول لغة تمييز النص التشعبي ملائم وقابل للقراءة ويعيده إلى المستخدم الذي يطلب البيانات. لن يسمح هذا للمهاجم فقط بتسجيل الدخول إلى نظام التذاكر ولكن إذا أعاد أي من هؤلاء المستخدمين استخدام كلمات المرور الخاصة بهم فقد يتمكن المهاجم من الوصول إلى أنظمة أخرى في نفس المؤسسة.</p><h4 id=جرب-بنفسك-1>جرب بنفسك! <a aria-label=#جرب-بنفسك-1 href=#جرب-بنفسك-1 class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>سجّل الدخول إلى دي في دبليو إيه الخاص بك وتأكد من ضبط مستوى الأمان ليكون منخفضًا. انتقل إلى صفحة &ldquo;حقن لغة الاستعلامات البنيوية&rdquo; وجرب الإدخال. هل يمكنك أن تتسبب بجعل الصفحة تعيد قائمة بجميع حسابات المستخدمين؟ هل يمكنك استخدام تقنية “union all” لاسترداد البيانات من الجداول الأخرى مثل الجدول المسمى “information_schema.tables”؟</p><h3 id=الوقاية-من-حقن-لغة-الاستعلامات-البنيوية>الوقاية من حقن لغة الاستعلامات البنيوية <a aria-label=#الوقاية-من-حقن-لغة-الاستعلامات-البنيوية href=#الوقاية-من-حقن-لغة-الاستعلامات-البنيوية class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>على عكس البرمجة النصية عبر المواقع، ترميز الخرج ليس طريقة موثوقة لمنع حقن لغة الاستعلامات البنيوية. لاحظ أنه في الأمثلة أعلاه يستخدم المهاجم المسافة و الـ - لتغيير سياق بياناته من سياق البيانات في استعلام لغة الاستعلامات البنيوية إلى سياق بنية الاستعلام نفسه، ويمكن لمزيج من ترشيح المدخلات المدرك للنوع وترميز المخرجات أن يمنع حقن لغة الاستعلامات البنيوية من الناحية النظرية، ولكن من الناحية العملية لا يمكن الاعتماد على هذا النهج.</p><p>بدلًا من ذلك يمكننا استخدام ميزة لكل محرك قاعدة بيانات تتخطى تمامًا بعض التحليل الأولي للاستعلام، يُطلق على هذا النوع من الاستعلامات اسم الاستعلام المعلمي، واستخدامه يُسمى عادةً بربط المعلمات. بدلًا من إرسال قاعدة البيانات سلسلة نصية تحتوي على كل من بنية الاستعلام وبيانات المستخدم نُرسل سلسلة واحدة تحتوي على بنية الاستعلام مع عناصر نائبة فيها للبيانات. وإلى جانب هذه السلسلة نُرسل البيانات لكل عنصر نائب، وبهذه الطريقة لا يتم تحليل بيانات المستخدم أبدًا في سياق لغة الاستعلامات البنيوية، وبغض النظر عما يرسلونه سيتم التعامل معها حصريًا على أنها بيانات، مم لا يسمح بالحماية من حقن لغة الاستعلامات البنيوية فحسب بل يجعل استعلامات قاعدة البيانات أسرع قليلًا.</p><p>لمزيد من المعلومات حول حقن لغة الاستعلامات البنيوية،
راجع <a href=https://owasp.org/www-community/attacks/SQL_Injection target=_blank>دليل مشروع أمان تطبيق الويب المفتوح</a>،<br>ولأجل نظرة متعمّقة،
راجع <a href=https://infusedev.safetag.org/en/learning-path/5/>مسار تعلّم تقييم أمان تطبيقات الويب</a>مسار تعلّم تقييم أمان تطبيقات الويب.</p><h3 id=حقن-المساراجتياز-الدليلتضمين-الملف-المحلي>حقن المسار/اجتياز الدليل/تضمين الملف المحلي <a aria-label=#حقن-المساراجتياز-الدليلتضمين-الملف-المحلي href=#حقن-المساراجتياز-الدليلتضمين-الملف-المحلي class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>تتضمن هذه الفئة من الثغرات الأمنية قيام المستخدم بإرسال تطبيق ويب يُخرّب تفاعلات التطبيق مع نظام الملفات، وباستخدام هذا النوع من الثغرات الأمنية يمكن للمهاجم التأثير أو التحكم في اسم مسار الملف الذي يقرأ منه تطبيق الويب أو يكتب فيه مما قد يمنح المهاجم حق الوصول الكامل إلى أي ملف يمكن لخادم الويب قراءته أو كتابته. حسب ما يُخزن على خادم الويب قد يمنح هذا قدرات مختلفة للمهاجم، ولكن الأهداف الشائعة هي ملفات التكوين التي غالبًا ما تحتوي على بيانات اعتماد لقواعد البيانات وخدمات الشبكة الخارجية الأخرى ورمز المصدر للتطبيق نفسه.</p><p>فكر في تطبيق يحتفظ ببعض البيانات على نظام الملفات بدلًا من قاعدة بيانات، على سبيل المثال موقع متعدد اللغات يبقي التوطين في الملفات، ومن المحتمل أن يبدو رمز الصفحة الرئيسية كما يلي:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;?
</span></span></span><span style=display:flex><span><span style=color:#75715e>function localize($content, $lang) {
</span></span></span><span style=display:flex><span><span style=color:#75715e>	return fread(&#34;../config/lang/&#34;+$lang+&#34;/&#34;+$content);
</span></span></span><span style=display:flex><span><span style=color:#75715e>}
</span></span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;&lt;<span style=color:#f92672>title</span>&gt;<span style=color:#75715e>&lt;?= localize($_GET(&#34;pg&#34;)+&#34;.title&#34;,$_GET(&#34;hl&#34;))?&gt;</span>&lt;/<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;<span style=color:#75715e>&lt;?= localize($_GET(&#34;pg&#34;), $_GET(&#34;hl&#34;))?&gt;</span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>لاحظ أنه يأخذ المعلمات من سلسلة عنوان موقع ويب ويستخدمها لقراءة الملفات من نظام الملفات بما في ذلك محتواها في الصفحة.</p><p>عند تحميل <a href="http://www.example.com/?hl=en-us&amp;pg=main" target=_blank>http://www.example.com/?hl=en-us&pg=main</a>, the server looks for ../config/lang/en-us/main.title and ../config/lang/en-us/main. ربما يبدو ناتج لغة تمييز النص التشعبي كما يلي:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;&lt;<span style=color:#f92672>title</span>&gt;Cool site: Main&lt;/<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;&lt;<span style=color:#f92672>h1</span>&gt;Hello, world!&lt;/<span style=color:#f92672>h1</span>&gt;&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>الآن ماذا سيحدث إذا قمنا بدلًا من ذلك بزيارة <a href="http://www.example.com/?hl=../../../../../../../../&amp;pg=../etc/passwd" target=_blank>http://www.example.com/?hl=../../../../../../../../&pg=../etc/passwd</a>? سيبحث الموقع عن ../config/lang/../../../../../../../../&amp;pg=../etc/passwd.title and ../config/lang/../../../../../../../../&amp;pg=../etc/passwd. من غير المحتمل العثور على الأول ولكن على افتراض أن الخادم تجاهل الخطأ قد نحصل على صفحة ويب تبدو كما يلي:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;&lt;<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false
</span></span><span style=display:flex><span>root:*:0:0:System Administrator:/var/root:/bin/sh
</span></span><span style=display:flex><span>daemon:*:1:1:System Services:/var/root:/usr/bin/false
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>في أي نظام حديث يُشابه يونكس لا يُعدّ الاستيلاء على /etc/passwd أمرًا كبيرًا ولكن إذا تمكن المهاجم من فرض ملفات أخرى على النظام بالقوة الغاشمة (ربما ملف تكوين أو شيء من هذا القبيل /home/dev/vpn-credentials.txt)، فقد تكون النتائج سيئة للغاية، والأسوأ من ذلك هو موقع يسمح للمستخدمين بتحميل الملفات ولكن يمكن للمستخدم التلاعب بموقع الملف ليصبح تعليمة برمجية (على سبيل المثال .php، .asp، وما إلى ذلك) داخل جذر الويب.
في هذه الحالة، يمكن للمهاجم تحميل <a href=https://en.wikipedia.org/wiki/Web_shell target=_blank>ويب شل</a> وتشغيل الأوامر على خادم الويب.</p><h4 id=جرب-بنفسك-2>جرب بنفسك! <a aria-label=#جرب-بنفسك-2 href=#جرب-بنفسك-2 class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>سجّل الدخول إلى دي في دبليو إيه الخاص بك وتأكد من ضبط مستوى الأمان ليكون منخفضًا. انتقل إلى صفحة &ldquo;File Inclusion (تضمين الملف)&rdquo; وجرب عنوان موقع ويب الذي تزوره عند النقر على ملف. هل يمكنك استرداد ملف /etc/passwd؟</p><h3 id=الوقاية-من-حقن-المسار>الوقاية من حقن المسار <a aria-label=#الوقاية-من-حقن-المسار href=#الوقاية-من-حقن-المسار class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>إلى حد كبير تُعدّ أفضل نصائح لمنع هذا النوع من الهجمات هي &ldquo;ألا تستخدم نظام الملفات في التعليمات البرمجية للتطبيق الخاص بك.&rdquo; وفي حين أن هذه النصيحة فعالة إلا أنها ليست عملية دائمًا، ويمكن أن يكون الحل المختلط هو تخزين أسماء الملفات في قاعدة بيانات وقبول طلبات فهرسة قاعدة البيانات من المستخدم. وفي المثال أعلاه يمكن أن تبدو قاعدة البيانات بالشكل التالي:</p><table><tr><td>lang</td><td>page</td><td>type</td><td>location</td></tr><tr><td><code>en-us</code></td><td><code>main</code></td><td><code>title</code></td><td><code>../config/lang/en-us/main.title</code></td></tr><tr><td><code>en-us</code></td><td><code>main</code></td><td><code>body</code></td><td><code>../config/lang/en-us/main</code></td></tr></table><p>إذا لم يكن ذلك ممكنًا فيجب على الموقع استخدام وقبول مجموعة محدودة جدًا من المحارف (مثل الأحرف والأرقام) لمكونات اسم الملف التي يحددها المستخدم، وسيظل من المحتمل أن يسمح هذا للمستخدمين بقراءة أو كتابة ملفات عشوائية داخل دليل محدد، لذلك يجب على مطوري التطبيقات التأكد من أن الملفات الموجودة في هذا الدليل غير قابلة للتنفيذ بواسطة خادم الويب وأنه لا توجد بيانات حساسة أو معلومات تكوين مهمة فيه.</p><p>لمزيد من المعلومات حول حقن المسار،
راجع <a href=https://owasp.org/www-community/attacks/Path_Traversal target=_blank>دليل مشروع أمان تطبيق الويب المفتوح حول هذا الموضوع </a>ولأجل دراسة متعمقة
راجع<a href=https://infusedev.safetag.org/en/learning-path/5/>مسار تعلّم تقييم أمان تطبيقات الويب</a>.</p><h3 id=حقن-شلحقن-الأوامر>حقن شل/حقن الأوامر <a aria-label=#حقن-شلحقن-الأوامر href=#حقن-شلحقن-الأوامر class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>يشبه حقن شل حقن المسار من حيث أنه يتضمن تفاعلات التطبيق مع نظام التشغيل، وفي هذه الحالة يقوم التطبيق مباشرة بتنفيذ أمر شل أو عدة أوامر ومن الممكن للمهاجم تغيير الأوامر التي يتم تنفيذها. تأثير حقن شل مرتفع للغاية وقد يسمح للمهاجم بتشغيل الأوامر الخاصة به على أجهزة خادم الويب الأساسية ويكاد يكون الاختراق الكامل لتطبيق الويب مضمونًا، ومع مرور الوقت من المحتمل أن يطرأ اختراق للبنية التحتية الأخرى في بيئة الخادم.</p><p>فكر في تطبيق يسمح للمستخدمين بالتحقق من اتصال الشبكة بالأنظمة الأخرى من خادم الويب، وإليك الحد الأدنى من التعليمات البرمجية لصفحة من نوع المعالج المسبق للنصوص الفائقة (PHP) التي تقوم بذلك:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;&lt;<span style=color:#f92672>title</span>&gt;Network connectivity check&lt;/<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>h1</span>&gt;Network connectivity check&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;GET&#34;</span>&gt;
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;host&#34;</span>&gt;
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>	&lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;?
</span></span></span><span style=display:flex><span><span style=color:#75715e>	if ($_GET(&#34;host&#34;)) {
</span></span></span><span style=display:flex><span><span style=color:#75715e>		print(&#34;	&lt;h2&gt;Results&lt;/h2&gt;\r&lt;pre&gt;&#34;.shell_exec(&#34;ping -c 3 &#34;.$_GET(&#34;host&#34;)).&#34;&lt;/pre&gt;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e>	}
</span></span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>If the users enters “8.8.8.8”, the page uses the shell_exec function to run the command <code>ping -c 3 8.8.8.8</code>, and the resulting HTML looks something like this:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;&lt;<span style=color:#f92672>title</span>&gt;Network connectivity check&lt;/<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>h1</span>&gt;Network connectivity check&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;GET&#34;</span>&gt;
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;host&#34;</span>&gt;
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>	&lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>h2</span>&gt;Results&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>pre</span>&gt;PING 8.8.8.8 (8.8.8.8): 56 data bytes
</span></span><span style=display:flex><span>64 bytes from 8.8.8.8: icmp_seq=0 ttl=119 time=7.266 ms
</span></span><span style=display:flex><span>64 bytes from 8.8.8.8: icmp_seq=1 ttl=119 time=8.681 ms
</span></span><span style=display:flex><span>64 bytes from 8.8.8.8: icmp_seq=2 ttl=119 time=12.481 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 8.8.8.8 ping statistics ---
</span></span><span style=display:flex><span>3 packets transmitted, 3 packets received, 0.0% packet loss
</span></span><span style=display:flex><span>round-trip min/avg/max/stddev = 7.266/9.476/12.481/2.202 ms&lt;/<span style=color:#f92672>pre</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>Super handy! However, what will happen if the user enters “<code>8.8.8.8; ls -1 /</code>” instead? The shell command run will be <code>ping -c 3 8.8.8.8; ls -1 /</code>, and the resulting web page will look something like:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>head</span>&gt;&lt;<span style=color:#f92672>title</span>&gt;Network connectivity check&lt;/<span style=color:#f92672>title</span>&gt;&lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>h1</span>&gt;Network connectivity check&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;GET&#34;</span>&gt;
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;host&#34;</span>&gt;
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>	&lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>h2</span>&gt;Results&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>pre</span>&gt;PING 8.8.8.8 (8.8.8.8): 56 data bytes
</span></span><span style=display:flex><span>64 bytes from 8.8.8.8: icmp_seq=0 ttl=119 time=5.611 ms
</span></span><span style=display:flex><span>64 bytes from 8.8.8.8: icmp_seq=1 ttl=119 time=11.918 ms
</span></span><span style=display:flex><span>64 bytes from 8.8.8.8: icmp_seq=2 ttl=119 time=9.519 ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>--- 8.8.8.8 ping statistics ---
</span></span><span style=display:flex><span>3 packets transmitted, 3 packets received, 0.0% packet loss
</span></span><span style=display:flex><span>round-trip min/avg/max/stddev = 5.611/9.016/11.918/2.599 ms
</span></span><span style=display:flex><span>Applications
</span></span><span style=display:flex><span>Library
</span></span><span style=display:flex><span>System
</span></span><span style=display:flex><span>Users
</span></span><span style=display:flex><span>Volumes
</span></span><span style=display:flex><span>bin
</span></span><span style=display:flex><span>cores
</span></span><span style=display:flex><span>dev
</span></span><span style=display:flex><span>etc
</span></span><span style=display:flex><span>home
</span></span><span style=display:flex><span>opt
</span></span><span style=display:flex><span>private
</span></span><span style=display:flex><span>sbin
</span></span><span style=display:flex><span>tmp
</span></span><span style=display:flex><span>usr
</span></span><span style=display:flex><span>var&lt;/<span style=color:#f92672>pre</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;</span></span></code></pre></div></p><p>ماذا حدث؟
يرى الشل أمر اختبار اتصال (ping) 8.8.8.8 ثم فاصلة منقوطة، وفي معظم أنواع شل الشبيهة بنظام يونكس يفصل أمر الفاصلة المنقوطة الأوامر الفردية التي تم تشغيلها معًا على سطر واحد. ولذلك قامت شل بتشغيل أمر اختبار الاتصال ثم قامت بتشغيل الأمر التالي لسرد محتويات الدليل الجذر، حيث تجمع مخرجات كلا الأمرين ثم أعادت تلك النتائج إلى خادم الويب.</p><p>من الواضح أنه يمكن استخدام شيء من هذا القبيل لاسترداد أي ملف تقريبًا من خادم الويب (على سبيل المثال، باستخدام أمر"cat")، وقد يتسبب المهاجم في قيام خادم الويب بتنزيل الملفات (بما في ذلك الملفات التنفيذية) من خوادم أخرى ثم تشغيل هذه الأوامر. ويمكن أن تكون هذه الملفات التنفيذية التي تم تنزيلها عبارة عن ثغرات تسمح للمهاجم بتصعيد الصلاحيات من مستخدم خادم الويب إلى مستخدم إداري (مثل النظام أو الجذر) مما يمنح المهاجم السيطرة الكاملة على خادم الويب.</p><h4 id=جرب-بنفسك-3>جرب بنفسك! <a aria-label=#جرب-بنفسك-3 href=#جرب-بنفسك-3 class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>سجّل الدخول إلى دي في دبليو إيه الخاص بك وتأكد من ضبط مستوى الأمان ليكون منخفضًا. ثم انتقل إلى صفحة &ldquo;حقن الأوامر (Command Injection)"، وجرب الإدخال هل يمكنك سرد محتويات الدليل الجذر لخادم الويب؟</p><h3 id=الوقاية-من-حقن-شل>الوقاية من حقن شل <a aria-label=#الوقاية-من-حقن-شل href=#الوقاية-من-حقن-شل class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>كما هو الحال مع حقن المسار فإن أفضل طريقة لمنع حقن الشل هي &ldquo;لا تفعل ذلك&rdquo;، وعلى عكس حقن المسار لا ينبغي أن تكون النصيحة عدم تشغيل أوامر شل من خادم الويب أمرًا يُعتمد بالكامل. ومن الصعب تنفيذ البدائل الأخرى (مثل التحقق من صحة بيانات الإدخال) بشكل صحيح وقد يكون ذلك مستحيلًا إذا كان التطبيق يحتاج إلى السماح بأي نوع من المدخلات غير البسيطة.</p><p>لمزيد من المعلومات حول حقن شل
راجع<a href=https://owasp.org/www-community/attacks/Command_Injection target=_blank>دليل مشروع أمان تطبيق الويب المفتوح عليه</a>
و <a href=https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html target=_blank>دليل مشروع أمان تطبيق الويب المفتوح حول منعه </a>.
ولأجل استكشاف متعمّق
<a href=https://infusedev.safetag.org/en/learning-path/5/>راجع مسار تعلّم تقييم أمان تطبيقات الويب</a>.</p><h2 id=اختبار-مهارة>اختبار مهارة <a aria-label=#اختبار-مهارة href=#اختبار-مهارة class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><h3 id=التمرين-1-ملخص>التمرين 1: ملخص <a aria-label=#التمرين-1-ملخص href=#التمرين-1-ملخص class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>(هذا ملخص للتمرين الموضح أعلاه في الموضوع الفرعي)
انتقل إلى نسخة دي في دبليو إيه الخاصة بك، واضبط مستوى الصعوبة ليكون &ldquo;منخفض&rdquo; وأكمل الأقسام التالية:</p><ul><li>البرمجة النصية عبر المواقع (معكوسة)</li><li>حقن لغة الاستعلامات البنيوية</li><li>تضمين الملف</li><li>حقن الأوامر</li></ul><p>بالنسبة لكل قسم من الأقسام التالية تتمثل مهمتك في العثور على الثغرة الأمنية واستغلالها كما هو موضح في صفحة دي في دبليو إيه المعنية، ونظرًا لأنه قد لا يكون لديك الكثير من الخبرة في جافا سكريبت أو لغة الاستعلامات البنيوية أو سطور الأوامر فلا بأس من استخدام أدلة التوجيه خطوة بخطوة (هناك العديد من الأدلة عبر الإنترنت التي تنظر إلى دي في دبليو إيه) أو الأدلة لمساعدتك في التمارين. وتأكد فقط أنه بدلًا من مجرد نسخ ولصق الأوامر من أدلة التوجيه خطوة بخطوة أن تقوم في الواقع بشرح ما تفعله كل صفحة دي في دبليو إيه وماهية الثغرات.</p><h3 id=التمرين-2-اختبار-خيارات-متعددة>التمرين 2: اختبار خيارات متعددة <a aria-label=#التمرين-2-اختبار-خيارات-متعددة href=#التمرين-2-اختبار-خيارات-متعددة class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>يُعدّ التحقق من صحة البيانات جانبًا مهمًا من جوانب أمان تطبيقات الويب يضمن أن بيانات الإدخال آمنة ومهيأة بشكل صحيح وخالية من النوايا الخبيثة، ويمكن أن يؤدي الفشل في تنفيذ التحقق الكافي من صحة البيانات إلى ترك تطبيقات الويب عرضة لمختلف عمليات الاستغلال. وتستكشف الأسئلة التالية أهمية التحقق من صحة البيانات في تطبيقات وتقنيات الويب الوقاية من ثغرات التحقق من صحة البيانات.</p><p>وإذا كان ذلك ممكنًا ناقش إجاباتك على هذه الأسئلة مع زميل أو مرشد يساعد في التحقق من فهمك للموضوع بشكل صحيح.</p><p><strong>السؤال 1</strong></p><p>ما هي النتيجة الشائعة للفشل في أداء التحقق المناسب من صحة البيانات في تطبيق الويب؟
أ) زيادة أداء الخادم
ب) تجربة مستخدم محسنة
ج) هجمات حقن لغة الاستعلامات البنيوية
د) تحسين سلامة البيانات</p><details class="group mb-6 w-full rounded-lg p-6 transition open:bg-white open:shadow-lg open:ring-1 open:ring-black/5"><summary class="flex cursor-pointer list-none items-center justify-between font-medium"><span class=text-gray-900>الإجابة وشرح</span>
<span class="transition group-open:hidden"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M12.5 8.31055V16.3105m-4-4h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span><span class="hidden transition group-open:block"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M8.5 12.3105h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span></summary><div class="break-words pe-6 pt-4"><p>ج) هجمات حقن لغة الاستعلامات البنيوية
<strong>الإجابة الصحيحة عن السؤال 1</strong>: ج) هجمات حقن لغة الاستعلامات البنيوية</p><p>الشرح:
أ) غير صحيح. عادة لا يؤدي الفشل في تنفيذ التحقق المناسب من صحة البيانات إلى تحسين أداء الخادم.
ب) غير صحيح. في حين أن التحقق المناسب من صحة البيانات يساهم في تحسين تجربة المستخدم من خلال منع الأخطاء لا يعزز غيابها من تجربة المستخدم.
ج) صحيح. دون التحقق من صحة البيانات بشكل صحيح، تكون تطبيقات الويب عرضة لهجمات حقن لغة الاستعلامات البنيوية حيث يمكن للمهاجمين التعامل مع استعلامات قاعدة البيانات عن طريق حقن تعليمات ضارة بلغة الاستعلامات البنيوية.
د) غير صحيح. يُساعد التحقق من صحة البيانات في الحفاظ على سلامة البيانات ولكن لا يحسن غيابها من سلامة البيانات.</p></div></details><p><strong>السؤال 2</strong></p><p>أي مما يلي يُعدّ آلية فعّالة لمنع هجمات البرمجة النصية عبر المواقع في تطبيقات الويب؟
أ) استخدام النص العادي لتخزين البيانات الحساسة
ب) إلغاء مدخلات المستخدم قبل عرضها
ج) تخزين كلمات مرور المستخدم في النص العادي
د) تعطيل تشفير بروتوكول نقل النص التشعبي الآمن</p><details class="group mb-6 w-full rounded-lg p-6 transition open:bg-white open:shadow-lg open:ring-1 open:ring-black/5"><summary class="flex cursor-pointer list-none items-center justify-between font-medium"><span class=text-gray-900>الإجابة وشرح</span>
<span class="transition group-open:hidden"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M12.5 8.31055V16.3105m-4-4h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span><span class="hidden transition group-open:block"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M8.5 12.3105h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span></summary><div class="break-words pe-6 pt-4"><p><strong>الإجابة الصحيحة عن السؤال 2</strong>: ب) إلغاء مدخلات المستخدم قبل عرضها</p><p>الشرح:
أ) غير صحيح. لا يمنع استخدام النص العادي لتخزين البيانات الحساسة هجمات البرمجة النصية عبر المواقع وإنما في الواقع يزيد من خطر تعرض البيانات.
ب) صحيح. يساعد إلغاء إدخال المستخدم قبل عرضه على التخفيف من هجمات البرمجة النصية عبر المواقع من خلال جعل أي برامج نصية ضارة محتملة غير ضارة وبالتالي منعها من التنفيذ في متصفحات المستخدمين.
ج) غير صحيح. يعد تخزين كلمات مرور المستخدم في نص عادي خطرًا أمنيًا ولا علاقة له بمنع هجمات البرمجة النصية عبر المواقع.
د) غير صحيح. يؤدي تعطيل تشفير بروتوكول نقل النص التشعبي الآمن إلى تعريض البيانات الحساسة للاعتراض ولا يمنع هجمات البرمجة النصية عبر المواقع.</p></div></details><p><strong>السؤال 3</strong>
ما هي التقنية الفعالة في منع هجمات حقن لغة الاستعلامات البنيوية في تطبيقات الويب؟
أ) استخدام استعلامات لغة الاستعلامات البنيوية الديناميكية
ب) استخدام تعقيم الإدخالات والاستعلامات المعيارية
ج) تخزين البيانات الحساسة في نص عادي
د) تعطيل رسائل الخطأ<details class="group mb-6 w-full rounded-lg p-6 transition open:bg-white open:shadow-lg open:ring-1 open:ring-black/5"><summary class="flex cursor-pointer list-none items-center justify-between font-medium"><span class=text-gray-900>الإجابة وشرح</span>
<span class="transition group-open:hidden"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M12.5 8.31055V16.3105m-4-4h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span><span class="hidden transition group-open:block"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M8.5 12.3105h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span></summary><div class="break-words pe-6 pt-4"><p><strong>الإجابة الصحيحة عن السؤال 3</strong>: ب) توظيف تعقيم الإدخالات ومعلمات الاستعلام</p><p>الشرح:
أ) غير صحيح. يؤدي استخدام استعلامات لغة الاستعلامات البنيوية الديناميكية دون التحقق من صحة المدخلات وتعقيمها بشكل صحيح إلى زيادة خطر هجمات حقن لغة الاستعلامات البنيوية.
ب) صحيح. يساعد استخدام تعقيم المدخلات والاستعلامات ذات المعلمات على منع هجمات حقن لغة الاستعلامات البنيوية من خلال ضمان التعامل مع مدخلات المستخدم على أنها بيانات بدلًا من تعليمات برمجية قابلة للتنفيذ وبالتالي تُحيّد محاولات حقن لغة الاستعلامات البنيوية الضارة.
ج) غير صحيح. يزيد تخزين البيانات الحساسة في نص عادي من خطر تعرض البيانات ولكنه لا يمنع هجمات حقن لغة الاستعلامات البنيوية بشكل مباشر.
د) غير صحيح. قد يؤدي تعطيل رسائل الخطأ إلى إخفاء الثغرات الأمنية المحتملة عن المهاجمين ولكنه لا يعالج السبب الجذري لثغرات حقن لغة الاستعلامات البنيوية.</p></div></details></p><p><strong>السؤال 4</strong>
أي من العبارات التالية تشرح بأفضل صورة كيف يساعد التحقق من صحة البيانات بشكل صحيح في منع هجمات حقن الأوامر في أمان تطبيقات الويب؟
أ) يُقيد التحقق من صحة البيانات الإدخال ضمن محارف وأنماط محددة مسبقًا مما يقلل من احتمال حقن الأوامر الضارة في التطبيق.
ب) تُساعد تقنيات التحقق المناسبة مثل تعقيم الإدخالات والاستعلامات ذات المعلمات على تحييد الأوامر الضارة المضمنة في مدخلات المستخدم وبالتالي التخفيف من ثغرات حقن الأوامر.
ج) يؤدي تنفيذ طرق التحقق من الصحة مثل فحوصات طول الإدخال ووضع قائمة بيضاء بالأحرف المقبولة إلى تقليل الأجزاء المعرضة للهجوم ومنع تنفيذ الأوامر غير المصرح بها داخل تطبيق الويب.
د) كل ما سبق</p><details class="group mb-6 w-full rounded-lg p-6 transition open:bg-white open:shadow-lg open:ring-1 open:ring-black/5"><summary class="flex cursor-pointer list-none items-center justify-between font-medium"><span class=text-gray-900>Answer</span>
<span class="transition group-open:hidden"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M12.5 8.31055V16.3105m-4-4h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span><span class="hidden transition group-open:block"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M8.5 12.3105h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span></summary><div class="break-words pe-6 pt-4"><strong>الإجابة الصحيحة عن السؤال 4</strong>: د) كل ما سبق</div></details><h2 id=موارد-التعلم>موارد التعلّم <a aria-label=#موارد-التعلم href=#موارد-التعلم class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">OWASP guides to vulnerabilities</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Great overviews of different vulnerabilities, including examples.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://owasp.org/www-community/attacks/SQL_Injection target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">OS command injection cheat sheet</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Quick overview of different OS commands which could be abused for injection.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Web shells</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Overview of what a web shell is and how it could be used in attacks.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span>, <span class="mb-0 inline-block text-sm">Kurdish</span>, <span class="mb-0 inline-block text-sm">Chinese</span>, <span class="mb-0 inline-block text-sm">Korean</span>, <span class="mb-0 inline-block text-sm">French</span>, <span class="mb-0 inline-block text-sm">Lombard</span>, <span class="mb-0 inline-block text-sm">Hindi</span>, <span class="mb-0 inline-block text-sm">Malayalam</span></div><a href=https://en.wikipedia.org/wiki/Web_shell target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div></div><div class="absolute -left-64 mt-8 hidden h-full xl:block xl:max-w-64 2xl:-left-96 2xl:max-w-full"><div class=h-full><div class="sticky top-0 px-4 py-2"><h2 class="mb-4 mt-3 text-xl font-bold">جدول المحتويات</h2><div class="toc-container toc-scrollbar h-svh max-w-72 space-y-2 overflow-y-auto"><nav id=TableOfContents><ul><li><a href=#حالة-استخدام>حالة استخدام</a></li><li><a href=#الأهداف>الأهداف</a></li><li><a href=#العرض>العرض</a><ul><li><a href=#البرمجة-النصية-عبر-المواقع-cross-site-scripting-أو-xss>البرمجة النصية عبر المواقع (Cross site scripting أو XSS)</a><ul><li><a href=#جرب-بنفسك>جرب بنفسك!</a></li></ul></li><li><a href=#الوقاية-من-البرمجة-النصية-عبر-المواقع>الوقاية من البرمجة النصية عبر المواقع</a></li><li><a href=#حقن-لغة-الاستعلامات-البنيوية-sqli>حقن لغة الاستعلامات البنيوية (SQLi)</a><ul><li><a href=#جرب-بنفسك-1>جرب بنفسك!</a></li></ul></li><li><a href=#الوقاية-من-حقن-لغة-الاستعلامات-البنيوية>الوقاية من حقن لغة الاستعلامات البنيوية</a></li><li><a href=#حقن-المساراجتياز-الدليلتضمين-الملف-المحلي>حقن المسار/اجتياز الدليل/تضمين الملف المحلي</a><ul><li><a href=#جرب-بنفسك-2>جرب بنفسك!</a></li></ul></li><li><a href=#الوقاية-من-حقن-المسار>الوقاية من حقن المسار</a></li><li><a href=#حقن-شلحقن-الأوامر>حقن شل/حقن الأوامر</a><ul><li><a href=#جرب-بنفسك-3>جرب بنفسك!</a></li></ul></li><li><a href=#الوقاية-من-حقن-شل>الوقاية من حقن شل</a></li></ul></li><li><a href=#اختبار-مهارة>اختبار مهارة</a><ul><li><a href=#التمرين-1-ملخص>التمرين 1: ملخص</a></li><li><a href=#التمرين-2-اختبار-خيارات-متعددة>التمرين 2: اختبار خيارات متعددة</a></li></ul></li><li><a href=#موارد-التعلم>موارد التعلّم</a></li></ul></nav></div></div></div></div></article><script>document.addEventListener("DOMContentLoaded",function(){const o=document.querySelectorAll("#TableOfContents a"),e=Array.from(o),n=e.map(e=>{const t=e.getAttribute("href").slice(1);return document.getElementById(t)});let t=!1;function s(){if(t)return;const o=window.scrollY+window.innerHeight/2;let s=-1;for(let e=0;e<n.length;e++){const t=n[e];if(t&&t.getBoundingClientRect().top+window.scrollY<=o)s=e;else break}if(e.forEach(e=>e.classList.remove("active-element")),s!==-1){e[s].classList.add("active-element");const t=document.querySelector(".toc-container");if(t){const n=e[s],o=n.getBoundingClientRect(),i=t.getBoundingClientRect(),a=o.top-i.top-t.clientHeight/2+n.clientHeight/2;t.scrollTop=a}}}function i(e,t){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}e.forEach(n=>{n.addEventListener("click",function(s){const i=n.getAttribute("href").slice(1),o=document.getElementById(i);o&&(s.preventDefault(),t=!0,o.scrollIntoView({behavior:"auto",block:"start"}),e.forEach(e=>e.classList.remove("active-element")),n.classList.add("active-element"),setTimeout(()=>t=!1,200))})}),window.addEventListener("scroll",i(()=>{s()},100)),s()})</script><section id=mark-complete class="hidden w-full flex-col items-start justify-between"><div class="mx-auto w-full rounded-xl border border-green-400 bg-white shadow-lg"><div class="overflow-hidden rounded-t-xl"><div class="bg-green-100 px-10 py-3"><p class="m-0 text-lg font-semibold text-green-700">تهانينا على انتهاء
وحدة 2!</p></div></div><div class="px-10 py-4"><p class="text-md mb-4 mt-0 text-gray-700">وسم المربع لتأكيد اكتمالك والمتابعة إلى الوحدة التالية.</p><div class="relative mb-4 flex w-full items-center gap-x-2 space-x-1 rounded-xl border-2 border-gray-200 bg-gray-50 px-4 py-3"><div class="flex h-6 items-center"><input id="Data ValidationCheckbox" aria-describedby=checkbox-description name=checkbox type=checkbox class="h-4 w-4 rounded border-gray-300 text-green-700 focus:ring-green-700"></div><div class="w-full text-sm"><label for="Data ValidationCheckbox" class="block cursor-pointer font-medium text-gray-900">وسم الوحدة كمكتملة</label><p id=checkbox-description class="sr-only text-gray-500">يوسم الوحدة الحالية كمكتملة ويحفظ التقدم للمستخدم.</p></div></div></div></div></section><nav class="flex w-full items-center justify-between px-4 pt-6 sm:px-6" aria-label=Pagination><a href=https://infusedev.safetag.org/ar/learning-path/4/introduction/ class="relative flex items-center justify-start rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 no-underline ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline-offset-0"><span class="flex items-center"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="me-2 size-4" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 010 12h-3"/></svg>
الوحدة السابقة</span>
</a><a href=https://infusedev.safetag.org/ar/learning-path/4/module-3/ class="relative flex items-center justify-end rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 no-underline ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline-offset-0"><span class="flex items-center">الوحدة التالية<svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="ms-2 size-4" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="m15 15 6-6m0 0-6-6m6 6H9a6 6 0 000 12h3"/></svg></span></a></nav><span class=hidden id=moduleCount data-count=7></span>
<script>window.addEventListener("beforeprint",()=>{document.querySelectorAll("details").forEach(e=>{e.open=!0})}),document.getElementById("printButton").addEventListener("click",function(){window.print()})</script><div id=congratulationsModal x-data x-cloak><div @keydown.window.escape="$store.modal.open = false" x-show=$store.modal.open @click.away="$store.modal.open = false" x-transition:enter="ease-out duration-300" x-transition:enter-start=opacity-0 x-transition:enter-end=opacity-100 x-transition:leave="ease-in duration-200" x-transition:leave-start=opacity-100 x-transition:leave-end=opacity-0 class="fixed inset-0 z-10 flex items-center justify-center overflow-y-auto" aria-labelledby=modal-title role=dialog aria-modal=true><div class="fixed inset-0 bg-gray-200 bg-opacity-75 transition-opacity" aria-hidden=true></div><div class="fixed inset-0 z-10 w-screen overflow-y-auto"><div class="flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"><div class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6"><div class="absolute right-0 top-0 hidden pe-4 pt-4 sm:block"><button @click="$store.modal.open = false" type=button class="rounded-md bg-white text-gray-500 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-700 focus:ring-offset-2">
<span class=sr-only>إغلاق</span><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div><div class="mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-green-100 text-7xl">🎉</div><div class="mt-3 text-center sm:mt-5"><h3 class="mb-1 text-2xl font-semibold text-gray-900" id=modal-title>تهانينا!</h3><p class="text-sm text-gray-600">لقد أكملت جميع الوحدات في مسار التعلم هذا.</p></div></div><div class="mt-5 sm:mt-6"><a href=https://infusedev.safetag.org/ar/badges class="inline-flex w-full justify-center rounded-md bg-green-700 px-3 py-2 text-sm font-semibold text-white no-underline shadow-sm hover:bg-green-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-800">احصل على الشارة!</a></div></div></div></div></div></div><span id=moduleId class=hidden>/4/module-2</span>
<script>document.addEventListener("DOMContentLoaded",function(){Alpine.store("modal",{open:!1});const n=document.getElementById("moduleId").innerHTML,s=document.getElementById("Data ValidationCheckbox"),t=localStorage.getItem("loggedInUser"),o=localStorage.getItem(t),e=o?JSON.parse(o):{},i=e[n]===!0;s.checked=i,s.addEventListener("change",function(){e[n]=this.checked,localStorage.setItem(t,JSON.stringify(e)),a()});function a(){const s=window.location.pathname.split("/"),o="/"+s[s.length-3];let n=0,i=parseInt(document.getElementById("moduleCount").getAttribute("data-count"));for(let[t,s]of Object.entries(e))t.startsWith(o)&&s===!0&&n++;const a=Math.round(n/i*100),r=`progress_${o}`;e[r]=a,localStorage.setItem(t,JSON.stringify(e)),n===i&&(Alpine.store("modal").open=!0)}})</script><script>document.addEventListener("alpine:init",()=>{Alpine.store("modal",{open:!1})})</script></section></div></main><footer class="mx-auto w-full max-w-7xl bg-white p-6 lg:flex lg:items-center lg:justify-between lg:px-8"><div class="flex flex-col gap-x-12 lg:flex-row lg:items-center"><a href=https://infusedev.safetag.org/ar/ class="-m-1.5 mb-4 p-1.5 lg:mb-0"><span class=sr-only>Infuse</span>
<img class="h-8 w-auto" src=https://infusedev.safetag.org/media/images/infuse-logo.svg alt="Infuse logo"></a><div class="mb-4 flex lg:mb-0 lg:gap-x-12"><div class="flex flex-col gap-y-2 lg:flex-row lg:gap-x-6"><a href=https://infusedev.safetag.org/ar/about/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>حول Infuse</a>
<a href=https://infusedev.safetag.org/ar/how/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>كيف يعمل</a>
<a href=https://infusedev.safetag.org/ar/contribute/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>المساهمة</a>
<a href=https://infusedev.safetag.org/ar/community/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>Community</a>
<a href=https://infusedev.safetag.org/ar/badge-descriptions/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false></a></div></div></div><p class="text-sm text-gray-500">&copy; 2024 Infuse. بموجب رخصة المشاع الإبداعي. <a class="font-semibold hover:underline" href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a></p></footer><script src=https://infusedev.safetag.org/bundle.min.5b3980201140b36d2d3323300f7f20d4e4a520d4c5feca83f7e8aae2d5e3a627.js integrity="sha256-WzmAIBFAs20tMyMwD38g1OSlINTF/sqD9+iq4tXjpic="></script><script type=module defer src=https://infusedev.safetag.org/instant.min.js></script><script src=https://infusedev.safetag.org/clean-insights.min.js defer></script><script>document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("trackingConsent");if(e==="granted"){const e=CleanInsightsAutoTracker("https://metrics.cleaninsights.org/cleaninsights.php",34);e.grantCampaign("visits"),e.grantFeature(CleanInsightsFeature.ua),e.grantFeature(CleanInsightsFeature.lang);return}if(e==="denied"){document.getElementById("tracking-banner").style.display="none";return}document.getElementById("tracking-banner").style.display="flex"})</script><div id=tracking-banner class="pointer-events-none fixed inset-x-0 bottom-0 z-50 hidden px-6 pb-6"><div class="pointer-events-auto mx-auto max-w-xl rounded-xl bg-white p-6 shadow-lg ring-1 ring-gray-900/10"><p class="prose text-sm leading-6 text-gray-900">يستخدم هذا الموقع <a href=https://cleaninsights.org/ target=_blank>Clean Insights</a> لتحليلات الويب التي تحافظ على الخصوصية. باستخدامك للموقع، فإنك توافق على السماح بجمع المعلومات الأساسية مثل البلد، واللغة، والتنقل، ووكيل المستخدم.</p><div class="mt-4 flex items-center gap-x-5"><button id=accept-consent class="rounded-md bg-gray-900 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">
قبول
</button>
<button id=reject-consent class="text-sm font-semibold leading-6 text-gray-900">رفض</button></div></div></div><script>document.addEventListener("DOMContentLoaded",()=>{const e=CleanInsightsAutoTracker("https://metrics.cleaninsights.org/cleaninsights.php",34),t=document.getElementById("tracking-banner"),n=document.getElementById("accept-consent"),s=document.getElementById("reject-consent"),o=()=>{t.style.display="none",e.grantCampaign("visits"),e.grantFeature(CleanInsightsFeature.ua),e.grantFeature(CleanInsightsFeature.lang),localStorage.setItem("trackingConsent","granted")},i=()=>{t.style.display="none",localStorage.setItem("trackingConsent","denied")};n.addEventListener("click",o),s.addEventListener("click",i)})</script><script type=module>
    await import('/pagefind/pagefind-highlight.js');
    new PagefindHighlight({ highlightParam: "highlight" });
</script></body>