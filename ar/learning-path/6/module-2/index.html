<!doctype html><html class="h-full bg-gray-50" lang=ar dir=rtl itemscope itemtype=http://schema.org/WebPage><head><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta name=author content><meta name=description content="Infuse is a community-developed framework helping digital protectors advance their knowledge and skill sets in areas of specialized technical expertise (STE)"><meta name=keywords content="NGO,cybersecurity,digital security,malware,phishing,web security,OWASP"><meta name=robots content="noodp"><meta name=theme-color content="#16B364"><link rel=canonical href=https://infuse.quest/ar/learning-path/6/module-2/><link rel=alternate hreflang=en href=https://infuse.quest/en/learning-path/6/module-2/ title=English><link rel=alternate hreflang=fr href=https://infuse.quest/fr/learning-path/6/module-2/ title=French><link rel=alternate hreflang=es href=https://infuse.quest/es/learning-path/6/module-2/ title=Spanish><title>Website Logging for Security :: Infuse
</title><link rel=stylesheet href=https://infuse.quest/style.76ca95bf38608a552f22cb0a855a013c12e89bfe1eb77644a584dbe10855e3ef.css><link rel=apple-touch-icon href=https://infuse.quest/favicons/apple-touch-icon.png><link rel=mask-icon href=https://infuse.quest/favicons/safari-pinned-tab.svg color=#194E80><link rel=icon href=https://infuse.quest/favicons/favicon.svg><meta itemprop=name content="Website Logging for Security"><meta itemprop=description content="Website logs can be crucial in identifying potential attacks and attackers. We look at how to effectively use them"><meta itemprop=dateModified content="2024-10-01T20:45:43+02:00"><meta itemprop=wordCount content="4563"><meta itemprop=image content="https://infuse.quest/media/images/thumbnail.png"><meta property="og:url" content="https://infuse.quest/ar/learning-path/6/module-2/"><meta property="og:site_name" content="Infuse"><meta property="og:title" content="Website Logging for Security"><meta property="og:description" content="Website logs can be crucial in identifying potential attacks and attackers. We look at how to effectively use them"><meta property="og:locale" content="ar"><meta property="og:type" content="article"><meta property="article:section" content="learning-path"><meta property="article:modified_time" content="2024-10-01T20:45:43+02:00"><meta property="og:image" content="https://infuse.quest/media/images/thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://infuse.quest/media/images/thumbnail.png"><meta name=twitter:title content="Website Logging for Security"><meta name=twitter:description content="Website logs can be crucial in identifying potential attacks and attackers. We look at how to effectively use them"></head><body class="flex flex-col"><a class="sr-only focus:not-sr-only" href=#content>التخطي إلى المحتوى</a><header><nav class="mx-auto flex max-w-7xl items-center justify-between bg-white p-6 lg:px-8" aria-label=Global><div class="flex items-center gap-x-12"><a href=https://infuse.quest/ar/ class="-m-1.5 p-1.5"><span class=sr-only>Infuse</span>
<img class="h-8 w-auto" src=https://infuse.quest/media/images/infuse-logo.svg alt="Infuse logo"></a><div class="hidden lg:flex lg:gap-x-12"><div class="hidden lg:flex lg:gap-x-6"><a href=https://infuse.quest/ar/about/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>About Infuse</a>
<a href=https://infuse.quest/ar/how/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>كيف يعمل</a>
<a href=https://infuse.quest/ar/contribute/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>المساهمة</a>
<a href=https://infuse.quest/ar/community/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>Community</a>
<a href=https://infuse.quest/ar/badge-descriptions/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false></a></div></div></div><div class="flex flex-1 items-center justify-end px-2 lg:ms-6"><div class=lg:max-w-56><a aria-label=بحث href=https://infuse.quest/ar/search class="block w-full rounded-full border-2 border-transparent p-2 text-gray-900 hover:border-green-700 focus:ring-2 focus:ring-inset focus:ring-green-700"><svg class="h-5 w-5 text-gray-500 hover:text-gray-700" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path stroke-width="1" stroke="currentcolor" fill-rule="evenodd" d="M9 3.5a5.5 5.5.0 100 11 5.5 5.5.0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75.0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"/></svg></a></div></div><div id=languageSwitcher aria-label="Language switcher" class="ms-1 flex justify-end lg:flex-grow-0"><div class=relative x-data="{ dropdown: false }"><button type=button class="-m-1.5 flex items-center p-1.5" id=language-switcher-button aria-expanded=false aria-haspopup=true x-on:click="dropdown = true">
<span class=sr-only>فتح قائمة اللغات</span>
<span class="flex items-center"><svg xmsns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="ms-2 h-5 w-5 text-gray-500" fill="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004.0 008.716-6.747M12 21a9.004 9.004.0 01-8.716-6.747M12 21c2.485.0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485.0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997.0 017.843 4.582M12 3A8.997 8.997.0 004.157 7.582m15.686.0A11.953 11.953.0 0112 10.5c-2.998.0-5.74-1.1-7.843-2.918m15.686.0A8.959 8.959.0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919.0 0112 16.5c-3.162.0-6.133-.815-8.716-2.247m0 0A9.015 9.015.0 013 12c0-1.605.42-3.113 1.157-4.418"/></svg>
<span class="ms-2 hidden text-sm font-semibold leading-6 text-gray-900 lg:block" aria-hidden=true>Arabic (coming soon)</span></svg></span></button><div x-show="dropdown === true" @click.outside="dropdown = false" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="absolute right-0 z-10 mt-2.5 w-24 origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-gray-900/5 focus:outline-none" role=menu aria-orientation=vertical aria-labelledby=user-menu-button tabindex=-1><a title=English href=https://infuse.quest/en/learning-path/6/module-2/ class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1>English</a>
<a title=French href=https://infuse.quest/fr/learning-path/6/module-2/ class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1>French</a>
<a title=Spanish href=https://infuse.quest/es/learning-path/6/module-2/ class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1>Spanish</a></div></div></div><div id=userProfile class="ms-8 hidden"><div class=relative x-data="{ dropdown: false }"><button type=button class="-m-1.5 flex items-center p-1.5" id=user-menu-button aria-expanded=false aria-haspopup=true x-on:click="dropdown = true">
<span class=sr-only>فتح قائمة المستخدم</span>
<img id=avatarImage class="h-7 w-7 rounded-full object-cover" src=https://infuse.quest/media/images/user-pfp.svg alt="User profile photo">
<span class="hidden lg:flex lg:items-center"><span id=userLabel class="ms-2 text-sm font-semibold leading-6 text-gray-900" aria-hidden=true>تسجيل الدخول</span><svg class="ms-2 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></button><div x-show="dropdown === true" @click.outside="dropdown = false" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="absolute right-0 z-10 mt-2.5 w-max origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-gray-900/5 focus:outline-none" role=menu aria-orientation=vertical aria-labelledby=user-menu-button tabindex=-1><a href=https://infuse.quest/ar/profile class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1 id=user-menu-item-0>ملفك الشخصي</a>
<a href=https://infuse.quest/ar/badges class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1 id=user-menu-item-0>شارات</a>
<a id=logoutButton href=# class="block px-3 py-1 text-sm leading-6 text-gray-900 hover:bg-gray-100 active:bg-gray-100" role=menuitem tabindex=-1 id=user-menu-item-1>تسجيل الخروج</a></div></div></div><div id=signupButtonCTA class="ms-8 hidden"><a href=https://infuse.quest/ar/signup class="rounded-md bg-green-700 px-5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-green-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-700">الاشتراك</a></div><div id=loginButtonCTA class="ms-2 hidden"><a id=signupButtonCTA href=https://infuse.quest/ar/login class="hidden rounded-md bg-white px-5 py-2.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 lg:block">تسجيل الدخول</a></div></nav></header><main id=content class="content mb-auto"><section id=breadcrumb class="mx-auto max-w-7xl px-8 pt-8 lg:px-8 lg:pt-16"><nav class="mb-5 flex justify-start" aria-label=Breadcrumb><ol role=list class="flex items-center" itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=https://infuse.quest/ar/ class="text-gray-500 hover:text-gray-700"><span itemprop=name><svg class="me-4 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="none" aria-hidden="true"><path d="M6.66667 14.1668H13.3333M9.18141 2.30345 3.52949 6.69939C3.15168 6.99324 2.96278 7.14017 2.82669 7.32417 2.70614 7.48716 2.61633 7.67078 2.56169 7.866 2.5 8.08639 2.5 8.3257 2.5 8.80433V14.8334c0 .9335.0 1.4002.18166 1.7567C2.84144 16.9037 3.09641 17.1587 3.41002 17.3185c.35652.1816.82323.1816 1.75665.1816H14.8333c.9335.0 1.4002.0 1.7567-.1816C16.9036 17.1587 17.1586 16.9037 17.3183 16.5901 17.5 16.2336 17.5 15.7669 17.5 14.8334V8.80433C17.5 8.3257 17.5 8.08639 17.4383 7.866 17.3837 7.67078 17.2939 7.48716 17.1733 7.32417 17.0372 7.14017 16.8483 6.99324 16.4705 6.69939L10.8186 2.30345c-.2928-.22771-.4392-.34156-.6008-.38533C10.0752 1.87951 9.92484 1.87951 9.78221 1.91812 9.62057 1.96189 9.47418 2.07574 9.18141 2.30345z" stroke="#667085" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/></svg>
<span class=sr-only>الرئيسية</span>
</span></a><meta itemprop=position content='1'></li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><div class="flex items-center"><svg class="h-5 w-5 flex-shrink-0 text-gray-500 lg:flex" fill="currentcolor" viewBox="0 0 20 20" aria-hidden="true"><path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z"/></svg>
<a class="me-2 ms-3 text-sm font-medium text-gray-500 underline hover:text-gray-700 hover:no-underline" aria-current=page itemprop=item href=https://infuse.quest/ar/learning-path/><span itemprop=name>Learning Paths</span>
</a><meta itemprop=position content='2'></div></li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><div class="flex items-center"><svg class="h-5 w-5 flex-shrink-0 text-gray-500 lg:flex" fill="currentcolor" viewBox="0 0 20 20" aria-hidden="true"><path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z"/></svg>
<a class="me-2 ms-3 text-sm font-medium text-gray-500 underline hover:text-gray-700 hover:no-underline" aria-current=page itemprop=item href=https://infuse.quest/ar/learning-path/6/><span itemprop=name>Web Application Hardening, Forensics, and Incident Response</span>
</a><meta itemprop=position content='3'></div></li><li class="hidden lg:flex" itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><div class="flex items-center"><svg class="h-5 w-5 flex-shrink-0 text-gray-500 underline" fill="currentcolor" viewBox="0 0 20 20" aria-hidden="true"><path d="M5.555 17.776l8-16 .894.448-8 16-.894-.448z"/></svg>
<a class="text-sm font-medium text-gray-500 underline hover:text-gray-700 hover:no-underline sm:ms-2" aria-current=page itemprop=item href=https://infuse.quest/ar/learning-path/6/module-2/><span itemprop=name>Website Logging for Security</span>
</a><meta itemprop=position content='4'></div></li></ol></nav></section><div class="relative flex flex-col justify-center py-6 sm:px-6 lg:px-8 lg:py-12"><section class="prose prose-stone mx-auto w-full max-w-3xl flex-col px-8 prose-hr:w-full lg:flex lg:items-center lg:justify-between lg:px-8"><article class="flex w-full flex-col items-start justify-between border-b border-gray-300"><p class="mb-1 text-sm text-gray-500">وحدة 2</p><h1 class="mb-0 text-3xl font-semibold text-gray-900">Website Logging for Security</h1><div class="w-full items-center justify-between lg:flex"><p class="me-2 inline-flex text-sm font-semibold text-green-900">آخر تحديث في: 1 أكتوبر 2024</p><a id=githubEdit href=https://github.com/OpenInternet/Infuse/blob/main/content/learning-path/6/module-2.ar.md target=_blank rel="noopener noreferrer" class="mb-5 me-6 inline-flex items-center text-sm font-semibold text-green-800 underline hover:text-green-900 hover:no-underline sm:mb-0 lg:mb-0 lg:me-0"><svg class="me-2 h-5 w-5" role="img" viewBox="0 0 24 24"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" fill="currentcolor"/></svg> تعديل هذه الصفحة على GitHub
</a><button id=printButton class="mb-5 inline-flex items-center text-sm font-semibold text-green-800 underline hover:text-green-900 hover:no-underline sm:mb-0 lg:mb-0">
<svg class="me-2 h-5 w-5" role="img" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke="currentcolor"><title>Print</title><path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415.0 0110.56.0m-10.56.0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125.0 01-1.12 1.227H7.231c-.662.0-1.18-.568-1.12-1.227L6.34 18m11.318.0h1.091A2.25 2.25.0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055.0 00-1.913-.247M6.34 18H5.25A2.25 2.25.0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041.0 011.913-.247m10.5.0a48.536 48.536.0 00-10.5.0m10.5.0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621.0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"/></svg> الطباعة بصيغة PDF</button></div></article><article class="relative flex w-full flex-col items-start justify-between"><div class="w-full visited:prose-a:text-purple-800"><h2 id=use-case>Use Case <a aria-label=#use-case href=#use-case class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>Any website that’s exposed to the internet is under constant attack. At the very least, it’s being deluged by undirected attacks by hordes of robots operated by criminal actors. More concerning are targeted attacks; even unskilled attackers, given perseverance and luck, can find vulnerabilities in a website.</p><p>Ideally, the website owner should be able to be aware of the threats they are facing. Site owners especially will want to know if an attacker is close to finding, or has recently found, a vulnerability in their site. Finally, if a vulnerability is exploited, site owners will want to know where the vulnerability is, and for how long it’s been exploited. Website logs can support all of these desires.</p><p>On the other hand, excessive logging can present a risk to the users of web sites. If a site logs sensitive information, and those logs are acquired by an adversary (e.g., seizure by law enforcement or compromise by hackers), then sensitive information could easily end up in the wrong hands.</p><p>This subtopic will cover approaches to website logging to maximize utility to website owners and minimize risk to site users.</p><h2 id=objectives>Objectives <a aria-label=#objectives href=#objectives class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>After completing this subtopic, the practitioner should be able to do the following:</p><ul><li>Understand built-in logging for major web servers</li><li>Understand what application-specific logs to add to detect attacks</li><li>Know how to minimize sensitive information in logs</li></ul><hr><h2 id=main-section>Main Section <a aria-label=#main-section href=#main-section class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>Even with the best possible skills, dedication, processes, and intentions, it’s nearly impossible to develop a website that’s completely resistant to any kind of attack. Given enough time and bad luck, every site will have a security incident. When that happens, it’s important to have logging in place that supports the detection and investigation of security events. At the same time, it’s important that a website&rsquo;s logs don’t pose additional risks themselves. This subtopic will teach you how to approach logging to maximize a site’s security. It will discuss:</p><ul><li>Built-in logs for popular platforms</li><li>Adding logs to catch important security events</li><li>Minimizing risks associated with logging</li></ul><h3 id=built-in-logging>Built-in Logging <a aria-label=#built-in-logging href=#built-in-logging class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>Various web platforms have their own logging systems. They can be relied upon to record data on every request and response, but are generally not sufficient for all incident response needs. Let’s go over what’s available in some common frameworks’ logs.</p><h4 id=apache>Apache <a aria-label=#apache href=#apache class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>Apache is the most popular full-featured web server on the internet, serving more active sites than any other. By default, it logs events to file on the web server’s filesystem. There are two files: <code>access_log</code> and <code>error_log</code>. The access log contains structured information about each request, while the error log contains more semi-structured data about things that have gone wrong.</p><p>The access log has one line per entry, with a configurable format. The default format is the following fields, each separated by a space:</p><ul><li>The requester’s IP address</li><li>The logged-in user on the requesting device. This is almost never sent, and so is almost always just a dash.</li><li>The user logged in if the web site uses HTTP Basic authentication. This will also almost always be a dash.</li><li>The date and time of the request, surrounded by square brackets. Note that this field will usually have spaces in it.</li><li>The HTTP request line sent from the client, surrounded by quotes (e.g. <code>"GET / HTTP/1.1"</code>). These fields will always have spaces.</li><li>The HTTP response code from the server, e.g. 200, 404, 500, etc.</li><li>The size of the response returned from the server</li></ul><p>Here’s an example:</p><pre tabindex=0><code>127.0.0.1 - - [13/Dec/2023:13:55:36 -0700] &#34;GET / HTTP/1.1&#34; 200 2326
</code></pre><p>Note that each Apache server can be configured to log more of less data. For more information, see <a href=https://httpd.apache.org/docs/2.4/logs.html#accesslog target=_blank>the Apache documentation</a>. For more about the apache access log and how to use it, see <a href=https://www.keycdn.com/support/apache-access-log target=_blank>this article.</a></p><p>The error log consists of a mix of messages from Apache that are in a semi-structured format and error messages from websites running on the server, without any enforced structure. The default structure of error log entries from Apache itself is one line per entry, with the following fields, again separated by spaces:</p><ul><li>The date and time of the request, surrounded by square brackets. Note that this field will usually have spaces in it.</li><li>The error level (e.g. notice, error) surrounded by square brackets.</li><li>If the error is associated with a request, the word “client” and the IP address of the requester, all within square brackets.</li><li>The actual error message itself, which will almost always contain a number of spaces</li></ul><p><a href=https://www.dataset.com/blog/apache-error-log-detail/ target=_blank>This article</a> provides more information about using the Apache error log.</p><h4 id=iis>IIS <a aria-label=#iis href=#iis class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>IIS is the default Windows web server, and is also a very popular web server. Like Apache, IIS also, by default, logs requests to the web server’s filesystem. There are several log formats available, but the default is the W3C format, which logs the following, separated by spaces:</p><ul><li>Request time</li><li>Requester’s IP address</li><li>HTTP method (e.g. <code>GET</code>, <code>POST</code>, <code>HEAD</code>, etc.)</li><li>URI (e.g. <code>/</code>, <code>/index.htm</code>, <code>/posts/34/reply</code>, etc.)</li><li>Server response code (e.g. <code>200</code>, <code>404</code>, <code>500</code>, etc.)</li><li>HTTP protocol version (e.g. <code>HTTP/1.1</code>)</li></ul><p>Note that the default logs do not log the query string, so for example a request to <a href="http://example.com/profile?profileID=34" target=_blank>http://example.com/profile?profileID=34</a> will only log <code>/profile</code>. For more information on the IIS access logs, see the <a href=https://learn.microsoft.com/en-us/windows/win32/http/server-side-logging-in-http-version-2-0 target=_blank>Microsoft documentation</a>.</p><p>Error logs under IIS are slightly more complicated. Depending on the error, they may go to the HTTP.SYS HTTPERR log file, or in the Windows event log.</p><p>The HTTPERR file contains protocol-level errors and is in a structured format, with the following fields separated by spaces:</p><ul><li>Request date</li><li>Request time</li><li>Requester’s IP address</li><li>Requester’s port (not the server port)</li><li>Server IP address</li><li>Server port</li><li>HTTP protocol ( e.g. <code>HTTP/1.1</code>)</li><li>HTTP method (e.g. <code>GET</code>, <code>POST</code>, <code>HEAD</code>, etc.)</li><li>The URL and query string</li><li>Server response code (e.g. <code>200</code>, <code>404</code>, <code>500</code>, etc.)</li><li>A literal dash</li><li>An error type string (no spaces)</li></ul><p>For more information on the error log, see the <a href=https://learn.microsoft.com/en-us/troubleshoot/developer/webapps/aspnet/site-behavior-performance/error-logging-http-apis target=_blank>Microsoft documentation</a>.</p><p>The Windows event log contains errors generated from the application server (e.g. ASP.NET) or application. These are available in the Windows Event Viewer and are semi-structured:</p><ul><li>Error level (e.g. <code>Information</code>, <code>Warning</code>, <code>Error</code>)</li><li>Date and time</li><li>The software that logged the error (log entries can come from any software on the system, not just the web server)</li><li>A unique ID of the event/error</li><li>Category</li><li>Unstructured information specific to the error</li></ul><p>For more information on finding error logs on Windows, see <a href=https://stackify.com/beyond-iis-logs-find-failed-iis-asp-net-requests/ target=_blank>this article</a>.</p><h4 id=nginx>nginx <a aria-label=#nginx href=#nginx class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>Depending on how you count, nginx may be the most popular web server on the internet, however it is fairly limited, usually acting as a reverse proxy to a back-end web server or serving static files.</p><p>The default access logs are similar to the default Apache logs, but with the following fields at the end of each line:</p><ul><li>Value of the referer header sent with the request</li><li>User agent (browser version) sent with the request</li></ul><p>For more information about nginx logs, see <a href=https://docs.nginx.com/nginx/admin-guide/monitoring/logging/ target=_blank>the official documentation</a>.</p><p>nginx error logs are semi-structured, with the following fields, separated by spaces:</p><ul><li>The request date</li><li>The request time</li><li>The error level inside of square brackets</li><li>Process ID information about the nginx instance that logged the error</li><li>An (optional) connection ID</li><li>The error message in free-form text</li></ul><p>For more information, see <a href=https://trunc.org/learning/nginx-log-analysis target=_blank>this article</a>.</p><h4 id=upstream-cdn-logs>Upstream CDN logs <a aria-label=#upstream-cdn-logs href=#upstream-cdn-logs class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>If a site is behind a CDN, it’s often useful to see the logs of the requests to the CDN, as opposed to the requests from the CDN to the origin site. Each CDN provider provides logs differently and has different pricing structures for logging.</p><h4 id=setting-up-server-logging>Setting up server logging <a aria-label=#setting-up-server-logging href=#setting-up-server-logging class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>When setting up server logging, there are a few steps that should be taken to maximize the security value of the logs.</p><ul><li>Make sure the logs contain at least the IP address of the requestor, full URI requested (including the query string), time taken to serve the request, response size, referer, and user-agent. This information can be extremely helpful when investigating an incident.</li><li>Try to get the logs off of the web server as quickly as possible. If the server itself is compromised, attackers will likely try to hide their tracks by deleting or modifying the server logs. Some ways of accomplishing this include:<ul><li>Have a process that pulls log files from the server periodically. Pushing logs from the web server is okay, though it’s important that the push process cannot be used to delete the backed-up logs.</li><li>“Stream” logs from the web server to a remote ever, for example, with syslog-ng. This provides great protection against loss of logs. It’s usually a good idea to keep logs on the web server as well, in case of network interruption.</li></ul></li></ul><h4 id=limitations-of-server-logging>Limitations of server logging <a aria-label=#limitations-of-server-logging href=#limitations-of-server-logging class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>Even when fully configured, built-in server logs miss a lot of important information. Some examples:</p><ul><li>POST parameter information isn’t included. If an attacker is performing application-level attacks against a page that accepts POST parameters, there will be no way to see those attacks in the logs.</li><li>Although error logs may contain information about filesystem and database errors that occur as attackers exploit vulnerabilities, they generally are not sufficient to understand much about the attack. E.g., elevated error logs may indicate an attack in progress but may also indicate a non-security bug, and it can be very difficult to distinguish between the two.</li><li>No identity information is included. While all logs include the IP address, multiple users can have the same IP.</li></ul><p>Much of this information isn’t included for good reason. Much of it can have bad implications for user privacy. Others (like useful error logging) require insight into the application itself, so can’t be done by the web server.</p><h4 id=approaching-logging-for-security>Approaching Logging for security <a aria-label=#approaching-logging-for-security href=#approaching-logging-for-security class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>The main purpose of application-level logging in a web application is to overcome the limitations of server logging. There are numerous articles describing best practices for logging, here are a few:</p><ul><li><a href=https://www.dnsstuff.com/security-log-best-practices target=_blank>An overview of security logging</a></li><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html target=_blank>An article from OWASP on logging for web sites</a></li><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/Logging_Vocabulary_Cheat_Sheet.html target=_blank>An article from OWASP on having a consistent format for logs</a></li></ul><p>These resources should get you set up with the knowledge you need to integrate security logging into an existing (or new) web application.</p><h4 id=logging-and-sensitive-information>Logging and sensitive information <a aria-label=#logging-and-sensitive-information href=#logging-and-sensitive-information class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h4><p>When overcoming the limitations of built-in server logging, we want to make sure that we don’t put site users at risk. It is frequently the case that logs are less well protected than production databases. First off, logs are not as obvious a target as a production database, so people tend to not focus on them as much when putting security measures in place. Secondly, it’s often the case that more users at an organization are given access to logs than are granted to access to a production database. Third, logs tend to be sent to many different systems, whereas production databases tend to stay centralized. Because of this, it’s worth considering redacting sensitive information in logs.</p><p><a href=https://www.skyflow.com/post/how-to-keep-sensitive-data-out-of-your-logs-nine-best-practices target=_blank>This article</a> prevents some general best practices for handling sensitive data during logging. Here are some approaches to consider for specific sorts of data:</p><h5 id=post-parameters>POST parameters <a aria-label=#post-parameters href=#post-parameters class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h5><p>It is a recommended practice to not include sensitive information in GET parameters, hence GET parameters being logged, but not POST parameters. However, it can be extremely useful to have access to information about POST parameters when responding to an attack. A few things to put in place:</p><ul><li>Certain pages (e.g. the login page) and/or parameters (credit card number, password fields) should be exempted from logging</li><li>For POST parameters that will be logged, consider redacting them to hide potentially sensitive information, while still being able to identify malicious traffic. The following Python code may give some inspiration:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>keep <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;select&#39;</span>, <span style=color:#e6db74>&#39;where&#39;</span>, <span style=color:#e6db74>&#39;from&#39;</span>, <span style=color:#e6db74>&#39;and&#39;</span>, <span style=color:#e6db74>&#39;script&#39;</span>, <span style=color:#e6db74>&#39;on&#39;</span>, <span style=color:#e6db74>&#39;src&#39;</span>, <span style=color:#e6db74>&#39;../&#39;</span>, <span style=color:#e6db74>&#39;&lt;&#39;</span>, <span style=color:#e6db74>&#39;&gt;&#39;</span>]
</span></span><span style=display:flex><span>output <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> i <span style=color:#f92672>&lt;</span> len(target):
</span></span><span style=display:flex><span>  matched <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> keep:
</span></span><span style=display:flex><span>  	<span style=color:#66d9ef>if</span> target[i:i<span style=color:#f92672>+</span>len(j)]<span style=color:#f92672>.</span>lower() <span style=color:#f92672>==</span> j<span style=color:#f92672>.</span>lower():
</span></span><span style=display:flex><span>  		output <span style=color:#f92672>=</span> output <span style=color:#f92672>+</span> target[i:i<span style=color:#f92672>+</span>len(j)]
</span></span><span style=display:flex><span>  		i<span style=color:#f92672>=</span>i<span style=color:#f92672>+</span>len(j)
</span></span><span style=display:flex><span>  		matched <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> matched:
</span></span><span style=display:flex><span>  	<span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>==</span> target[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]:
</span></span><span style=display:flex><span>  		output <span style=color:#f92672>=</span> output <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; &#39;</span>
</span></span><span style=display:flex><span>  	<span style=color:#66d9ef>elif</span> re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#39;\w&#39;</span>, target[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]):
</span></span><span style=display:flex><span> 			output <span style=color:#f92672>=</span> output <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;A&#34;</span>
</span></span><span style=display:flex><span> 		<span style=color:#66d9ef>elif</span> re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#39;\d&#39;</span>, target[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]):
</span></span><span style=display:flex><span>  		output <span style=color:#f92672>=</span> output <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;1&#34;</span>
</span></span><span style=display:flex><span> 		<span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>  		output <span style=color:#f92672>=</span> output <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;*&#34;</span>
</span></span><span style=display:flex><span>  	i <span style=color:#f92672>=</span> i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  </span></span></code></pre></div><h5 id=security-related-errors>Security-related errors <a aria-label=#security-related-errors href=#security-related-errors class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h5><p>If a request causes an error that looks like an attempt to hack or bypass controls, the website should aggressively log the request information. Examples include:</p><ul><li>Database queries that trigger an error</li><li>Requests for a data element that the user doesn’t have access to</li><li>Errors or empty data when attempting to read a file</li></ul><p>If any of these happen, it’s a good idea to log the request, as well as internal information (e.g., database query, filename, etc). In the good case, there’s a simple bug in the site. In that case, there’s plenty of debugging information. In the bad case, the site is being compromised. In that case, it’s easier to find where the compromise occurred, so that forensics is more effective.</p><h5 id=identity-information>Identity information <a aria-label=#identity-information href=#identity-information class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h5><p>Logging the identity of a logged-in user can be dangerous, but there are steps that can be taken to mitigate the danger. It’s questionable to log session cookies, but a hash of a session ID can be used to track a user’s activity across the site. Also, if the web server has a queryable directory of active user sessions, then either an internal ID can be used in logs, or the existing session IDs can be hashed to identify the log entries of a logged-in user. This will allow site owners to identify an active attacker, while making the identities in the logs useless to a threat actor on their own.</p><h2 id=practice>Practice <a aria-label=#practice href=#practice class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>Read through the following example commands which use common Unix tools like <code>awk</code>, <code>sort</code>, <code>uniq</code>, and <code>grep</code> to perform the analysis on Apache and Nginx logs.</p><h3 id=a-brief-introduction-to-unix-text-analysis-tools>A brief introduction to Unix text analysis tools <a aria-label=#a-brief-introduction-to-unix-text-analysis-tools href=#a-brief-introduction-to-unix-text-analysis-tools class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>Below are example commands using common Unix tools like <code>awk</code>, <code>sort</code>, <code>uniq</code>, and <code>grep</code> to perform the analysis on Apache and Nginx logs.</p><p><code>awk</code> is a powerful command-line tool for manipulating text files in Unix-like operating systems. It has a simple syntax. The basic structure of an <code>awk </code>command is as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;pattern { action }&#39;</span> <span style=color:#a6e22e>file</span></span></span></code></pre></div><p>For example let’s consider the following text file (we will call it example.txt):</p><pre tabindex=0><code>apple red 5
banana yellow 10
pear green 15
Orange orange 20
</code></pre><p><code>awk</code> scans the input file line by line, and performs a specified action for each line if the pattern matches. <code>awk </code>automatically splits each line of input into fields based on whitespace (by default). Fields can be referenced using $1, $2, etc., where $1 refers to the first field, $2 to the second, and so on.</p><p>For example to print first column with <code>awk</code> command we need to use</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;{ print $1 }&#39;</span> <span style=color:#a6e22e>example</span>.<span style=color:#a6e22e>txt</span></span></span></code></pre></div><p>We can use Conditional Filtering. For example we want to print lines where third column is greater than 10</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;$3 &gt; 10 {print $1, $3}&#39;</span> <span style=color:#a6e22e>example</span>.<span style=color:#a6e22e>txt</span></span></span></code></pre></div><p>To use a custom delimiter with <code>awk</code>, use the -F option followed by the delimiter character. For example if we have a comma delimited file we can use -F&rsquo;,&rsquo; (enclose the delimiter character in single quotes ) to specify a comma (,) as the delimiter.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>F</span><span style=color:#e6db74>&#39;,&#39;</span> <span style=color:#e6db74>&#39;{print $1, $3}&#39;</span> <span style=color:#a6e22e>comma</span><span style=color:#f92672>-</span><span style=color:#a6e22e>delimited</span>.<span style=color:#a6e22e>txt</span></span></span></code></pre></div><p>We can do calculations using <code>awk</code>. This command calculates the sum of values in the third field across all lines and prints the total at the end. &ldquo;END&rdquo; is a special pattern used to execute statements after the last record is processed</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;{total += $3} END {print &#34;Total:&#34;, total}&#39;</span> <span style=color:#a6e22e>example</span>.<span style=color:#a6e22e>txt</span></span></span></code></pre></div><p>There are some built in variables in <code>awk</code>. For example NR is a built-in variable in awk that represents the current record number. NR increments by one for each line read from the input file(s).</p><p>If you want to print line numbers in addition to line content, you could use the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;{print NR, $0}&#39;</span> <span style=color:#a6e22e>example</span>.<span style=color:#a6e22e>txt</span></span></span></code></pre></div><h3 id=practice-exercise-1-apache-access-log-analysis>Practice exercise 1: Apache Access Log Analysis <a aria-label=#practice-exercise-1-apache-access-log-analysis href=#practice-exercise-1-apache-access-log-analysis class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>Spend some time playing around with the following awk commands. You can use a log from your own web server or use practice ones, such as <a href=https://github.com/OpenInternet/Infuse/blob/main/learner-assets/nginx%20and%20apache%20logs.zip target=_blank>this collection</a>.</p><p>Identify the total number of requests recorded in the access log.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat apache_access.log | wc -l</span></span></code></pre></div><p>Determine the most frequently requested URLs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>awk <span style=color:#e6db74>&#39;{print $7}&#39;</span> apache_access.log | sort | uniq -c | sort -nr | head -5</span></span></code></pre></div><p>This awk command will print the seventh column from each line of the log then pipe the output of the previous awk command into the sort command. sort is used to sort the lines of text alphabetically or numerically. By default, it sorts in ascending order. After sorting the output with sort, the uniq -c command is used to count the occurrences of each unique line in the sorted output. The sort -nr command is used to sort the output numerically (-n) in reverse order (-r). This means that the lines are sorted based on their numerical values, with the highest values appearing first. The head -5 command is used to display the first 5 lines of the input.</p><p>Find out the top 5 IP addresses making requests to the server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>awk <span style=color:#e6db74>&#39;{print $1}&#39;</span> apache_access.log | sort | uniq -c | sort -nr | head -5</span></span></code></pre></div><p>Analyze the distribution of request methods.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>awk <span style=color:#e6db74>&#39;{print $6}&#39;</span> apache_access.log | sort | uniq -c</span></span></code></pre></div><h3 id=practice-exercise-2-nginx-access-log-analysis>Practice exercise 2: Nginx Access Log Analysis <a aria-label=#practice-exercise-2-nginx-access-log-analysis href=#practice-exercise-2-nginx-access-log-analysis class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>Count the total number of requests in an Nginx access log.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat nginx_access.log | wc -l</span></span></code></pre></div><p>Identify the most requested URLs and their corresponding status codes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>awk <span style=color:#e6db74>&#39;{print $7, $9}&#39;</span> nginx_access.log | sort | uniq -c | sort -nr | head -5</span></span></code></pre></div><p>Calculate the average size of requests (in bytes).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-awk data-lang=awk><span style=display:flex><span><span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;{sum+=$10} END {print &#34;Average request size:&#34;, sum/NR, &#34;bytes&#34;}&#39;</span> <span style=color:#a6e22e>nginx_access</span>.<span style=color:#66d9ef>log</span></span></span></code></pre></div><p>This AWK command calculates the average request size by summing up the values in the 10th column (presumably representing request sizes) for all lines in the nginx_access.log file. Then, it divides the total sum by the number of lines (NR), representing the average request size in bytes. Finally, it prints out the result along with a descriptive message.</p><p>Make sure that the 10th column actually represents the request size in bytes in your nginx_access.log file, as the accuracy of the calculation depends on the correctness of the column indexing. \</p><p>Determine the top 5 user agents accessing the server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>awk -F<span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#e6db74>&#39;{print $6}&#39;</span> nginx_access.log | sort | uniq -c | sort -nr | head -5</span></span></code></pre></div><p>This command uses <code>awk</code> to set the field separator (-F) to double quotes ("), then extracts the 6th field from each line of the<code> nginx_access.log</code> file. This assumes that the log entries are formatted in such a way that the URL or request path is enclosed within double quotes. The extracted URLs or request paths are then piped to sort them alphabetically. <code>uniq -c</code> is used to count the occurrences of each unique URL or request path. The output is piped again to <code>sort -nr</code> to sort the results numerically in descending order based on the count.</p><p>Finally, head -5 is used to display the top 5 URLs or request paths with the highest occurrence counts.</p><p>Analyze the distribution of requests by hour of the day.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>awk <span style=color:#e6db74>&#39;{print $4}&#39;</span> nginx_access.log | cut -c 14-15 | sort | uniq -c</span></span></code></pre></div><p><code>awk</code> is used to extract the 4th field ($4) from each line of the <code>access.log</code> file, which typically contains the timestamp.</p><p>The <code>cut</code> command is then applied to extract characters 14 to 15 from each timestamp, which correspond to the hour portion.</p><p>The extracted hour values are piped to sort to arrange them in ascending order. <code>uniq -c</code> is used to count the occurrences of each unique hour value.</p><p>The output will display the count of log entries for each hour in the log file.</p><h3 id=practice-exercise-3-error-log-analysis-both-apache-and-nginx>Practice exercise 3: Error Log Analysis (Both Apache and Nginx) <a aria-label=#practice-exercise-3-error-log-analysis-both-apache-and-nginx href=#practice-exercise-3-error-log-analysis-both-apache-and-nginx class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>Apache and nginx: Count the total number of error entries in the log.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat apache_error.log | grep <span style=color:#e6db74>&#39;error&#39;</span> | wc -l
</span></span><span style=display:flex><span>cat nginx_error.log | grep <span style=color:#e6db74>&#39;error&#39;</span> | wc -l</span></span></code></pre></div><p>Apache: Identify the most common types of errors. awk &lsquo;{print $NF}&rsquo; reads each line of input data, splits it into fields (separated by whitespace by default), and then prints the value of the last field from each line.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat apache_error.log | grep <span style=color:#e6db74>&#39;error&#39;</span> | awk <span style=color:#e6db74>&#39;{print $NF}&#39;</span> | sort | uniq -c | sort -nr | head -5</span></span></code></pre></div><p>The number at the beginning of each line shows how many times a particular error occurred in the log. In this case, “<code>2047</code>” means that the error with the last field “<code>757</code>” occurred 2047 times.</p><p>The last field represents different things in each line. It could be a file path, a specific action, or some other identifier related to the error. For instance, “<code>757</code>” or “<code>154</code>” could be error codes or unique identifiers, while “<code>/home/mysite/public_html/new/wp-content/plugins/woocommerce/includes/data-stores/abstract-wc-order-data-store-cpt.php:100</code>” could be a file path and line number where the error occurred.</p><p>nginx: Determine the top 5 IP addresses, domains, or file paths generating errors.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat nginx_error.log | grep <span style=color:#e6db74>&#39;error&#39;</span> | awk <span style=color:#e6db74>&#39;{print $NF}&#39;</span> | sort | uniq -c | sort -nr | head -5</span></span></code></pre></div><p>Apache: Analyze the distribution of errors by date or time.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat apache_error.log | grep <span style=color:#e6db74>&#39;error&#39;</span> | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span> | sort | uniq -c</span></span></code></pre></div><p>Apache: Investigate any recurring error patterns and propose potential solutions. {$1=""; $2=""; $3="";}: This part of the awk command sets the first three fields (date, time, and timezone information) to empty strings.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat apache_error.log | grep <span style=color:#e6db74>&#39;error&#39;</span> | awk <span style=color:#e6db74>&#39;{$1=&#34;&#34;; $2=&#34;&#34;; $3=&#34;&#34;; print}&#39;</span> | sort | uniq -c | sort -nr | head -10</span></span></code></pre></div><h3 id=an-introduction-to-regular-expressions-and-using-them-to-analyze-a-log>An introduction to regular expressions and using them to analyze a log <a aria-label=#an-introduction-to-regular-expressions-and-using-them-to-analyze-a-log href=#an-introduction-to-regular-expressions-and-using-them-to-analyze-a-log class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>For this exercise, we use we use log files from <a href=https://github.com/OpenInternet/Infuse/blob/main/learner-assets/nginx%20and%20apache%20logs.zip target=_blank>this collection</a> (same collection as the other files in this practice section)</p><p><strong>[a-z] range</strong> - Matches a character in the range &ldquo;a&rdquo; to &ldquo;z&rdquo;. Case sensitive.</p><p>I.e. [g-s] matches a character between g and s inclusive</p><p>abcdef<strong>ghijklmnopqrs</strong>tuvwxyz</p><p><strong>[A-Z] range</strong> - Matches a character in the range &ldquo;A&rdquo; to &ldquo;Z&rdquo; . Case sensitive.</p><p><strong>[0-9] range</strong> - Matches a character in the range &ldquo;0&rdquo; to &ldquo;9&rdquo;. Case sensitive.</p><p>We can also use <strong>quantifiers</strong> to match the specified quantity of the previous token. {1,3} will match 1 to 3. {3} will match exactly 3. {3,} will match 3 or more.</p><p>[a-d]{3} matches any sequence of exactly three characters within the given range, each of which can be any lowercase letter from &lsquo;a&rsquo; to &rsquo;d&rsquo;. So, it would match strings like &lsquo;abc&rsquo;, &lsquo;bda&rsquo;, &lsquo;cad&rsquo;, etc.</p><p>Some characters have special meanings within regexes these characters are:</p><table><thead><tr><th>Symbol</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>\</td><td>Backslash</td><td>Used to escape a special character</td></tr><tr><td>^</td><td>Caret</td><td>Beginning of a string</td></tr><tr><td>$</td><td>Dollar sign</td><td>End of a string</td></tr><tr><td>.</td><td>Period or dot</td><td>Matches any single character</td></tr><tr><td>|</td><td>Vertical bar or pipe symbol</td><td>Matches previous OR next character/group</td></tr><tr><td>?</td><td>Question mark</td><td>Match zero or one of the previous</td></tr><tr><td>*</td><td>Asterisk or star</td><td>Match zero, one or more of the previous</td></tr><tr><td>+</td><td>Plus sign</td><td>Match one or more of the previous</td></tr><tr><td>( )</td><td>Opening and closing parenthesis</td><td>Group characters</td></tr><tr><td>[ ]</td><td>Opening and closing square bracket</td><td>Matches a range of characters</td></tr><tr><td>{ }</td><td>Opening and closing curly brace</td><td>Matches a specified number of occurrences of the previous</td></tr></tbody></table><p>In our task we will use backslash to escape “\” special character.</p><p>You can read more about regex here: <a href=https://en.wikipedia.org/wiki/Regular_expression target=_blank>https://en.wikipedia.org/wiki/Regular_expression</a></p><p>If you check the provided nginx access log you can see these kind of lines:</p><pre tabindex=0><code>181.214.166.113 - - [15/Feb/2024:15:05:19 -0500] &#34;[L\x9E\x804\xD9-\xFB&amp;\xA3\x1F\x9C\x19\x95\x12\x8F\x0C\x89\x05\x81&#34; 400 181 &#34;-&#34; &#34;-&#34;
45.95.169.184 - - [15/Feb/2024:15:49:27 -0500] &#34;\x10 \x00\x00BBBB\xBA\x8C\xC1\xABDAAA&#34; 400 181 &#34;-&#34; &#34;-&#34;
</code></pre><p>As you can see, both lines contain \x followed by exactly two characters which map to hexadecimal notation (so they use the numbers 0-9 and the letters A to F), such as \x9C, \x10, \xBA, etc. To filter all lines we need to use the &lsquo;<code>\\x[a-fA-F0-9]{3}</code>&rsquo; pattern where<code> \\x[a-fA-F0-9]</code> is our token, <code>{3}</code> is a quantifier.</p><p>We will use the <code>grep</code> command to search for the specified pattern in text. For example:</p><p><code>grep 'abcd'</code> will filter all lines containing the string “abcd”.</p><p>The “<code>-E</code>” option in the <code>grep</code> command enables the use of extended regular expressions for pattern matching <code>grep -E 'abcd\\[0-9]{2}'</code> for filtering text like <code>abcd\34, abcd\47</code> etc.</p><h3 id=practice-exercise-4-using-regular-expressions-regexes>Practice exercise 4: using regular expressions (regexes) <a aria-label=#practice-exercise-4-using-regular-expressions-regexes href=#practice-exercise-4-using-regular-expressions-regexes class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h3><p>For those exercises, we use nginx log files from <a href=https://github.com/OpenInternet/Infuse/blob/main/learner-assets/nginx%20and%20apache%20logs.zip target=_blank>this collection</a> (same collection as the other files in this practice section)</p><ol><li>Use grep and the <code>'\\x[a-fA-F0-9]{3}'</code> <a href=https://en.wikipedia.org/wiki/Regular_expression target=_blank>regex</a> to filter requests from nginx access.log containing a suspicious payload. The regex<code> '\\x[a-fA-F0-9]{3}'</code> matches a sequence starting with &lsquo;<code>\x</code>&rsquo; followed by exactly three hexadecimal characters (0-9, a-f, or A-F). How many lines are there?</li><li>Using the same filter determine which IP address is making the most requests</li><li>Examine<code> error.log</code> by running <code>more error.log</code>. You can quit this command with ctrl+c or press the “q” key to return command prompt. Excluding &ldquo;PHP Notice&rdquo; errors. What kind of critical errors can you find in the log?</li><li>Exclude PHP errors from the error.log and find the lines where requests are denied due to security rules. Which sensitive file has been requested?</li></ol><details class="group mb-6 w-full rounded-lg p-6 transition open:bg-white open:shadow-lg open:ring-1 open:ring-black/5"><summary class="flex cursor-pointer list-none items-center justify-between font-medium"><span class=text-gray-900>Practice exercise 4: answers</span>
<span class="transition group-open:hidden"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M12.5 8.31055V16.3105m-4-4h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span><span class="hidden transition group-open:block"><svg width="25" height="25" viewBox="0 0 25 25" fill="none"><path d="M8.5 12.3105h8m6 0c0 5.5229-4.4772 10-10 10-5.52285.0-10-4.4771-10-10 0-5.5228 4.47715-9.99995 10-9.99995 5.5228.0 10 4.47715 10 9.99995z" stroke="#98a2b3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span></summary><div class="break-words pe-6 pt-4"><p>Exercise 1:<br>Correct answer: 131 lines</p><p>Command(s) to execute: <code>grep -E '\\x[a-fA-F0-9]{3}' nginx_access.log|wc|awk '{print $1}'</code></p><p>Exercise 2:</p><p>Correct answer: 222.186.13.131 19 lines</p><p>Command(s) to execute: <code>grep -E '\\x[a-fA-F0-9]{3}' nginx_access.log|sort|awk '{print $1}'| sort | uniq -c | sort -nr</code></p><p>Exercise 3:</p><p>Correct answer: SSL handshaking errors</p><p>Command(s) to execute:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>more nginx_error.log
</span></span><span style=display:flex><span>cat nginx_error.log|grep -v <span style=color:#e6db74>&#34;PHP&#34;</span>|grep crit</span></span></code></pre></div><p>Exercise 4:</p><p>Correct answer: <code>.git/config</code></p><p>Command(s) to execute: <code>cat nginx_error.log|grep -v "PHP"|grep forbidden</code></p></div></details><h2 id=skill-check>Skill Check <a aria-label=#skill-check href=#skill-check class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><p>This skill check will be much easier if you’ve first completed the practice exercise above.</p><p>You are given an nginx access log from a website under attack to investigate, which you can <svg viewBox="0 0 512 512" class="inline-block ms-1 h-4 w-4"><path fill="currentcolor" aria-hidden="true" d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3.0s-12.5 32.8.0 45.3l128 128c12.5 12.5 32.8 12.5 45.3.0l128-128c12.5-12.5 12.5-32.8.0-45.3s-32.8-12.5-45.3.0L288 274.7V32zM64 352c-35.3.0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3.0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5.0L165.5 352H64zm368 56a24 24 0 110 48 24 24 0 110-48z"/></svg> <a href=https://github.com/OpenInternet/Infuse/blob/main/learner-assets/web-app-hardening-skill-check.log target=_blank>download here</a>.</p><p>Locate a suspicious path that is being targeted, extract IP addresses that are sending suspicious requests and find out which countries those IPs are in (you can use geoIP databases, described in more detail in the malicious infrastructure learning path, for this). You can use standard CLI tools like <code>awk</code>, <code>grep</code>, <code>sort</code>, <code>uniq</code>. To find out AS numbers and countries, we recommend using relevant online lookup services.</p><p><em>Hint:</em> ipinfo.io provides a convenient way of looking up IP details, you can use curl to fetch those.</p><h2 id=learning-resources>Learning Resources <a aria-label=#learning-resources href=#learning-resources class="anchor-link no-underline"><svg aria-hidden="true" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5.0 011.242 7.244l-4.5 4.5a4.5 4.5.0 01-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5.0 00-6.364-6.364l-4.5 4.5a4.5 4.5.0 001.242 7.244"/></svg></a></h2><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Log Files - Apache</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">An overview of how to read log files in the Apache web server.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://httpd.apache.org/docs/2.4/logs.html#accesslog target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Understanding the Apache Access and Error Log</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Two pieces on how to read the Apache web server’s logs.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Server-side logging</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">An analysis of logs within the Microsoft IIS server.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://learn.microsoft.com/en-us/windows/win32/http/server-side-logging-in-http-version-2-0 target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">IIS Error Logs and Other Ways to Find ASP.Net Failed Requests</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Another look at IIS logs and how we can search for application errors therein.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://stackify.com/beyond-iis-logs-find-failed-iis-asp-net-requests/ target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Configuring logging on nginx</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Documentation by the NGINX web server on how to configure and work with logs.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://docs.nginx.com/nginx/admin-guide/monitoring/logging/ target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">A guide to NGINX logs</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">An overview of different NGINX logs and their formats.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://trunc.org/learning/nginx-log-analysis target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Security Log: Best Practices for Logging and Management</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">An analysis of when logs are useful, how we can analyze them, and what policies we can create around them.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://www.dnsstuff.com/security-log-best-practices target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">OWASP logging cheat sheet and vocabulary</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">A guide from OWASP on what purpose logs should serve, how we should analyze them, and a standard vocabulary for them.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div></div></div><div class="transition-200 relative mb-6 flex w-full items-center space-x-3 rounded-3xl border-2 border-gray-300 bg-white p-4 shadow-3xl transition-shadow focus-within:shadow-none focus-within:ring-2 focus-within:ring-green-500 focus-within:ring-offset-2 hover:border-gray-400 hover:shadow-none"><div class=p-6><p class="mb-2 mt-0 text-2xl font-bold">Keep Sensitive Data Out of Your Logs: 9 Best Practices</p><span class="mb-2 me-2 inline-block rounded-full border-2 border-indigo-300 bg-indigo-50 px-2 py-0 text-sm font-semibold text-indigo-700">Free</span><p class="mb-3 mt-0">Thorough logging can also end up including sensitive data, which could put users at risk. This guide looks at how we can adapt our logging practices to exclude sensitive data from logs.</p><div class=mb-2><span class="text-sm font-semibold">اللغة</span>: <span class="mb-0 inline-block text-sm">English</span></div><a href=https://www.skyflow.com/post/how-to-keep-sensitive-data-out-of-your-logs-nine-best-practices target=_blank rel="noopener noreferrer" class="mt-2 inline-block rounded-lg bg-green-700 px-4 py-2 font-bold text-white no-underline visited:!text-white hover:bg-green-800">زيارة الموقع</a></div></div></div><div class="absolute -left-64 mt-8 hidden h-full xl:block xl:max-w-64 2xl:-left-96 2xl:max-w-full"><div class=h-full><div class="sticky top-0 px-4 py-2"><h2 class="mb-4 mt-3 text-xl font-bold">جدول المحتويات</h2><div class="toc-container toc-scrollbar h-svh max-w-72 space-y-2 overflow-y-auto"><nav id=TableOfContents><ul><li><a href=#use-case>Use Case</a></li><li><a href=#objectives>Objectives</a></li><li><a href=#main-section>Main Section</a><ul><li><a href=#built-in-logging>Built-in Logging</a><ul><li><a href=#apache>Apache</a></li><li><a href=#iis>IIS</a></li><li><a href=#nginx>nginx</a></li><li><a href=#upstream-cdn-logs>Upstream CDN logs</a></li><li><a href=#setting-up-server-logging>Setting up server logging</a></li><li><a href=#limitations-of-server-logging>Limitations of server logging</a></li><li><a href=#approaching-logging-for-security>Approaching Logging for security</a></li><li><a href=#logging-and-sensitive-information>Logging and sensitive information</a></li></ul></li></ul></li><li><a href=#practice>Practice</a><ul><li><a href=#a-brief-introduction-to-unix-text-analysis-tools>A brief introduction to Unix text analysis tools</a></li><li><a href=#practice-exercise-1-apache-access-log-analysis>Practice exercise 1: Apache Access Log Analysis</a></li><li><a href=#practice-exercise-2-nginx-access-log-analysis>Practice exercise 2: Nginx Access Log Analysis</a></li><li><a href=#practice-exercise-3-error-log-analysis-both-apache-and-nginx>Practice exercise 3: Error Log Analysis (Both Apache and Nginx)</a></li><li><a href=#an-introduction-to-regular-expressions-and-using-them-to-analyze-a-log>An introduction to regular expressions and using them to analyze a log</a></li><li><a href=#practice-exercise-4-using-regular-expressions-regexes>Practice exercise 4: using regular expressions (regexes)</a></li></ul></li><li><a href=#skill-check>Skill Check</a></li><li><a href=#learning-resources>Learning Resources</a></li></ul></nav></div></div></div></div></article><script>document.addEventListener("DOMContentLoaded",function(){const o=document.querySelectorAll("#TableOfContents a"),e=Array.from(o),n=e.map(e=>{const t=e.getAttribute("href").slice(1);return document.getElementById(t)});let t=!1;function s(){if(t)return;const o=window.scrollY+window.innerHeight/2;let s=-1;for(let e=0;e<n.length;e++){const t=n[e];if(t&&t.getBoundingClientRect().top+window.scrollY<=o)s=e;else break}if(e.forEach(e=>e.classList.remove("active-element")),s!==-1){e[s].classList.add("active-element");const t=document.querySelector(".toc-container");if(t){const n=e[s],o=n.getBoundingClientRect(),i=t.getBoundingClientRect(),a=o.top-i.top-t.clientHeight/2+n.clientHeight/2;t.scrollTop=a}}}function i(e,t){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}e.forEach(n=>{n.addEventListener("click",function(s){const i=n.getAttribute("href").slice(1),o=document.getElementById(i);o&&(s.preventDefault(),t=!0,o.scrollIntoView({behavior:"auto",block:"start"}),e.forEach(e=>e.classList.remove("active-element")),n.classList.add("active-element"),setTimeout(()=>t=!1,200))})}),window.addEventListener("scroll",i(()=>{s()},100)),s()})</script><section id=mark-complete class="hidden w-full flex-col items-start justify-between"><div class="mx-auto w-full rounded-xl border border-green-400 bg-white shadow-lg"><div class="overflow-hidden rounded-t-xl"><div class="bg-green-100 px-10 py-3"><p class="m-0 text-lg font-semibold text-green-700">تهانينا على انتهاء
وحدة 2!</p></div></div><div class="px-10 py-4"><p class="text-md mb-4 mt-0 text-gray-700">وسم المربع لتأكيد اكتمالك والمتابعة إلى الوحدة التالية.</p><div class="relative mb-4 flex w-full items-center gap-x-2 space-x-1 rounded-xl border-2 border-gray-200 bg-gray-50 px-4 py-3"><div class="flex h-6 items-center"><input id="Website Logging for SecurityCheckbox" aria-describedby=checkbox-description name=checkbox type=checkbox class="h-4 w-4 rounded border-gray-300 text-green-700 focus:ring-green-700"></div><div class="w-full text-sm"><label for="Website Logging for SecurityCheckbox" class="block cursor-pointer font-medium text-gray-900">وسم الوحدة كمكتملة</label><p id=checkbox-description class="sr-only text-gray-500">يوسم الوحدة الحالية كمكتملة ويحفظ التقدم للمستخدم.</p></div></div></div></div></section><nav class="flex w-full items-center justify-between px-4 pt-6 sm:px-6" aria-label=Pagination><a href=https://infuse.quest/ar/learning-path/6/module-1/ class="relative flex items-center justify-start rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 no-underline ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline-offset-0"><span class="flex items-center"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="me-2 size-4" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 010 12h-3"/></svg>
الوحدة السابقة</span>
</a><a href=https://infuse.quest/ar/learning-path/6/module-3/ class="relative flex items-center justify-end rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 no-underline ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline-offset-0"><span class="flex items-center">الوحدة التالية<svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="ms-2 size-4" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="m15 15 6-6m0 0-6-6m6 6H9a6 6 0 000 12h3"/></svg></span></a></nav><span class=hidden id=moduleCount data-count=5></span>
<script>window.addEventListener("beforeprint",()=>{document.querySelectorAll("details").forEach(e=>{e.open=!0})}),document.getElementById("printButton").addEventListener("click",function(){window.print()})</script><div id=congratulationsModal x-data x-cloak><div @keydown.window.escape="$store.modal.open = false" x-show=$store.modal.open @click.away="$store.modal.open = false" x-transition:enter="ease-out duration-300" x-transition:enter-start=opacity-0 x-transition:enter-end=opacity-100 x-transition:leave="ease-in duration-200" x-transition:leave-start=opacity-100 x-transition:leave-end=opacity-0 class="fixed inset-0 z-10 flex items-center justify-center overflow-y-auto" aria-labelledby=modal-title role=dialog aria-modal=true><div class="fixed inset-0 bg-gray-200 bg-opacity-75 transition-opacity" aria-hidden=true></div><div class="fixed inset-0 z-10 w-screen overflow-y-auto"><div class="flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"><div class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6"><div class="absolute right-0 top-0 hidden pe-4 pt-4 sm:block"><button @click="$store.modal.open = false" type=button class="rounded-md bg-white text-gray-500 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-green-700 focus:ring-offset-2">
<span class=sr-only>إغلاق</span><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div><div class="mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-green-100 text-7xl">🎉</div><div class="mt-3 text-center sm:mt-5"><h3 class="mb-1 text-2xl font-semibold text-gray-900" id=modal-title>تهانينا!</h3><p class="text-sm text-gray-600">لقد أكملت جميع الوحدات في مسار التعلم هذا.</p></div></div><div class="mt-5 sm:mt-6"><a href=https://infuse.quest/ar/badges class="inline-flex w-full justify-center rounded-md bg-green-700 px-3 py-2 text-sm font-semibold text-white no-underline shadow-sm hover:bg-green-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-800">احصل على الشارة!</a></div></div></div></div></div></div><span id=moduleId class=hidden>/6/module-2</span>
<script>document.addEventListener("DOMContentLoaded",function(){Alpine.store("modal",{open:!1});const n=document.getElementById("moduleId").innerHTML,s=document.getElementById("Website Logging for SecurityCheckbox"),t=localStorage.getItem("loggedInUser"),o=localStorage.getItem(t),e=o?JSON.parse(o):{},i=e[n]===!0;s.checked=i,s.addEventListener("change",function(){e[n]=this.checked,localStorage.setItem(t,JSON.stringify(e)),a()});function a(){const s=window.location.pathname.split("/"),o="/"+s[s.length-3];let n=0,i=parseInt(document.getElementById("moduleCount").getAttribute("data-count"));for(let[t,s]of Object.entries(e))t.startsWith(o)&&s===!0&&n++;const a=Math.round(n/i*100),r=`progress_${o}`;e[r]=a,localStorage.setItem(t,JSON.stringify(e)),n===i&&(Alpine.store("modal").open=!0)}})</script><script>document.addEventListener("alpine:init",()=>{Alpine.store("modal",{open:!1})})</script></section></div></main><footer class="mx-auto w-full max-w-7xl bg-white p-6 md:flex md:items-center md:justify-between lg:px-8"><div class="flex flex-col gap-x-12 md:flex-row md:items-center"><a href=https://infuse.quest/ar/ class="-m-1.5 mb-4 p-1.5 md:mb-0"><span class=sr-only>Infuse</span>
<img class="h-8 w-auto" src=https://infuse.quest/media/images/infuse-logo.svg alt="Infuse logo"></a><div class="mb-4 flex md:mb-0 lg:gap-x-12"><div class="flex flex-col gap-y-2 md:flex-row md:gap-x-6"><a href=https://infuse.quest/ar/about/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>About Infuse</a>
<a href=https://infuse.quest/ar/how/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>كيف يعمل</a>
<a href=https://infuse.quest/ar/contribute/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>المساهمة</a>
<a href=https://infuse.quest/ar/community/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false>Community</a>
<a href=https://infuse.quest/ar/badge-descriptions/ class="inline-flex items-center text-sm font-semibold text-gray-700 hover:text-gray-900 hover:underline" aria-current=false></a></div></div></div><p class="text-sm text-gray-500">&copy; 2024 Infuse. بموجب رخصة المشاع الإبداعي. <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a></p></footer><script src=https://infuse.quest/bundle.min.5b3980201140b36d2d3323300f7f20d4e4a520d4c5feca83f7e8aae2d5e3a627.js integrity="sha256-WzmAIBFAs20tMyMwD38g1OSlINTF/sqD9+iq4tXjpic="></script><script type=module defer src=https://infuse.quest/instant.min.js></script><script src=https://infuse.quest/clean-insights.min.js defer></script><script>document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("trackingConsent");if(e==="granted"){const e=CleanInsightsAutoTracker("https://metrics.cleaninsights.org/cleaninsights.php",34);e.grantCampaign("visits"),e.grantFeature(CleanInsightsFeature.ua),e.grantFeature(CleanInsightsFeature.lang);return}if(e==="denied"){document.getElementById("tracking-banner").style.display="none";return}document.getElementById("tracking-banner").style.display="flex"})</script><div id=tracking-banner class="pointer-events-none fixed inset-x-0 bottom-0 z-50 hidden px-6 pb-6"><div class="pointer-events-auto mx-auto max-w-xl rounded-xl bg-white p-6 shadow-lg ring-1 ring-gray-900/10"><p class="prose text-sm leading-6 text-gray-900">يستخدم هذا الموقع <a href=https://cleaninsights.org/ target=_blank>Clean Insights</a> لتحليلات الويب التي تحافظ على الخصوصية. باستخدامك للموقع، فإنك توافق على السماح بجمع المعلومات الأساسية مثل البلد، واللغة، والتنقل، ووكيل المستخدم.</p><div class="mt-4 flex items-center gap-x-5"><button id=accept-consent class="rounded-md bg-gray-900 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">
قبول
</button>
<button id=reject-consent class="text-sm font-semibold leading-6 text-gray-900">رفض</button></div></div></div><script>document.addEventListener("DOMContentLoaded",()=>{const e=CleanInsightsAutoTracker("https://metrics.cleaninsights.org/cleaninsights.php",34),t=document.getElementById("tracking-banner"),n=document.getElementById("accept-consent"),s=document.getElementById("reject-consent"),o=()=>{t.style.display="none",e.grantCampaign("visits"),e.grantFeature(CleanInsightsFeature.ua),e.grantFeature(CleanInsightsFeature.lang),localStorage.setItem("trackingConsent","granted")},i=()=>{t.style.display="none",localStorage.setItem("trackingConsent","denied")};n.addEventListener("click",o),s.addEventListener("click",i)})</script><script type=module>
    await import('/pagefind/pagefind-highlight.js');
    new PagefindHighlight({ highlightParam: "highlight" });
</script></body>